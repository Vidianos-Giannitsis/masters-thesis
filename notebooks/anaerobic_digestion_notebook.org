#+TITLE: Αποτελέσματα Αναερόβιας Χώνευσης σε BMPs

Σκοπός του αρχείου αυτού είναι η ανάλυση όλων των αποτελεσμάτων των διάφορων πειραμάτων αναερόβιας χώνευσης στην διάταξη για την εύρεση του biomethane potential. Αρχικά ορίζεται ένα infrastructure για τις αναλύσεις αυτές και μετά αναλύονται διάφορα πειράματα παραγωγής μεθανίου. Αυτά διακρίνονται από 3 βασικούς παράγοντες. Το υπόστρωμα που χρησιμοποιούν (οξικό, υδρόλυμα FW ή ανεπεξέργαστο FW), την λάσπη που χρησιμοποιούν (παρακάτω θα χρησιμοποιηθούν οι συμβολισμοί s1 και s2 για τις διαφορετικές λάσπες) και ποιό run του πειράματος είναι (γίνονται 2 runs για κάποια πειράματα για καλύτερη επαναληψιμότητα τα οποία θα συμβολίζονται ως r1 και r2). Το αρχείο [[./hplc_analysis_notebook.org]] περιέχει τα αποτελέσματα των πειραμάτων υδρόλυσης και αναλύουν την ποιότητα του κάθε υδρολύματος και γιατί θα χρησιμοποιήσουμε αυτά που επιλέξαμε.

* Table of Contents                                           :TOC:noexport:
- [[#dependencies][Dependencies]]
- [[#acetate-experiment-data-reading][Acetate Experiment data reading]]
- [[#fw-hydrolysate-experiment-1-data-reading][FW Hydrolysate Experiment 1 Data Reading]]
- [[#data-processing][Data Processing]]
  - [[#curve-fitting][Curve Fitting]]
  - [[#plotting][Plotting]]
- [[#acetate-experiment-processing][Acetate Experiment Processing]]
  - [[#acetate-test-fw][Acetate Test FW]]
  - [[#acetate-test-0][Acetate Test 0]]
  - [[#acetate-test-1][Acetate Test 1]]
  - [[#acetate-test-2][Acetate Test 2]]
  - [[#acetate-test-4][Acetate Test 4]]
  - [[#παραγωγή-μεθανίου-χωρίς-feed-από-το-δείγμα-ac][Παραγωγή μεθανίου χωρίς feed από το δείγμα Ac]]
  - [[#update-all-helper][Update all helper]]
  - [[#γενικά-σχόλια-για-αυτόν-τον-κύκλο-πειραμάτων][Γενικά σχόλια για αυτόν τον κύκλο πειραμάτων]]
- [[#fw-hydrolysate-1-processing][FW Hydrolysate 1 Processing]]
  - [[#sample-0][Sample 0]]
  - [[#sample-1][Sample 1]]
  - [[#sample-2][Sample 2]]
  - [[#sample-4][Sample 4]]
  - [[#untreated-fw][Untreated FW]]
  - [[#update-all][Update all]]

* Dependencies
Στο αρχείο αυτό θα οριστούν κάποια functions για να διευκολυνθεί η ανάλυση των BMPs, τα οποία θα είναι generic και μετά θα υπάρχουν κάποια specific code blocks για την εφαρμογή σε κάθε πείραμα. Πριν ξεκινήσουμε, κάνουμε activate το DrWatson project για reproducibility. Επίσης κάνουμε load το Dates.jl που θα χρειαστεί παρακάτω, καθώς και τα CSV.jl και DataFrames.jl που είναι πάντα χρήσιμα σε tabular data. Ακόμη, παρακάτω θα χρειαστούν τα LsqFit.jl για την προσαρμογή του μοντέλου Gompertz, StatsBase για υπολογισμό μέσων και Plots.jl για plotting. Το code block αυτό δεν κάνει tangle πουθενά καθώς είναι κομμάτι του generic code που θα χρησιμοποιηθεί σε πολλά σημεία.

*deps*
#+NAME: deps
#+BEGIN_SRC julia

  using DrWatson
  @quickactivate "Masters_Thesis"

  using Dates
  using StatsBase
  using CSV, DataFrames
  using LsqFit
  using Plots

#+END_SRC

* Data Reading
** Acetate Experiment S1
Τα δεδομένα της αναερόβιας χώνευσης είναι φωτογραφίες των προχωίδων της διάταξης. Εξετάζοντας πόσο έχει μεταβληθεί η στάθμη τους, μπορούμε να υπολογίσουμε τον παραγόμενο όγκο μεθανίου. Αλλά πρώτα, πρέπει να ξέρουμε σε τι χρόνους έγιναν sampled τα δείγματα. Όλες οι φωτογραφίες έχουν ένα timestamp το οποίο μας βοηθάει να τα διακρίνουμε. Μπορούμε να αναλύσουμε αυτά ώστε να πάρουμε τις στιγμές που βγήκαν οι φωτογραφίες. Αρχικά, παίρνουμε όλα τα filenames με ~ls~. Θα χρησιμοποιήσουμε τα flags -m και -Q για να πάρουμε comma separated output και το κάθε string να έχει double quotes.

*ls_output_acetate_s1*
#+NAME: ls_output_acetate_s1
#+BEGIN_SRC sh :results output
ls -mQ ../bmp_pictures/Acet_kinetics_screenshots/
#+END_SRC

#+RESULTS: ls_output
#+begin_example
"bandicam 2024-03-27 18-45-55-857.jpg", "bandicam 2024-03-27 18-46-57-161.jpg",
"bandicam 2024-03-27 18-48-57-160.jpg", "bandicam 2024-03-27 18-50-57-170.jpg",
"bandicam 2024-03-27 18-52-57-164.jpg", "bandicam 2024-03-27 18-54-57-162.jpg",
"bandicam 2024-03-27 18-56-57-167.jpg", "bandicam 2024-03-27 18-58-57-165.jpg",
"bandicam 2024-03-27 19-00-57-170.jpg", "bandicam 2024-03-27 19-02-57-179.jpg",
"bandicam 2024-03-27 19-04-57-173.jpg", "bandicam 2024-03-27 19-06-57-182.jpg",
"bandicam 2024-03-27 19-08-57-185.jpg", "bandicam 2024-03-27 19-10-57-184.jpg",
"bandicam 2024-03-27 19-12-57-189.jpg", "bandicam 2024-03-27 19-14-57-187.jpg",
"bandicam 2024-03-27 19-15-06-279.jpg", "bandicam 2024-03-27 19-19-06-273.jpg",
"bandicam 2024-03-27 19-21-06-276.jpg", "bandicam 2024-03-27 19-23-06-285.jpg",
"bandicam 2024-03-27 19-25-06-290.jpg", "bandicam 2024-03-27 19-27-06-301.jpg",
"bandicam 2024-03-27 19-29-06-303.jpg", "bandicam 2024-03-27 19-31-06-301.jpg",
"bandicam 2024-03-27 19-33-06-297.jpg", "bandicam 2024-03-27 19-35-06-305.jpg",
"bandicam 2024-03-27 19-37-06-299.jpg", "bandicam 2024-03-27 19-39-06-297.jpg",
"bandicam 2024-03-27 19-41-06-307.jpg", "bandicam 2024-03-27 19-43-06-299.jpg",
"bandicam 2024-03-27 19-45-06-298.jpg", "bandicam 2024-03-27 19-47-06-304.jpg",
"bandicam 2024-03-27 19-48-50-591.jpg", "bandicam 2024-03-29 12-23-36-175.jpg",
"bandicam 2024-03-29 12-23-50-142.jpg", "bandicam 2024-03-29 12-24-50-161.jpg",
"bandicam 2024-03-29 12-25-50-156.jpg", "bandicam 2024-03-29 12-26-50-168.jpg",
"bandicam 2024-03-29 12-27-26-514.jpg", "bandicam 2024-03-29 12-28-26-502.jpg",
"bandicam 2024-03-29 12-29-26-497.jpg", "bandicam 2024-03-29 12-29-39-894.jpg",
"bandicam 2024-03-29 12-30-39-902.jpg", "bandicam 2024-03-29 12-31-39-897.jpg",
"bandicam 2024-03-29 12-32-05-844.jpg", "bandicam 2024-03-29 12-33-05-843.jpg",
"bandicam 2024-03-29 12-34-05-832.jpg", "bandicam 2024-03-29 12-35-05-836.jpg",
"bandicam 2024-03-29 12-36-05-835.jpg", "bandicam 2024-03-29 12-37-05-858.jpg",
"bandicam 2024-03-29 12-38-06-101.jpg", "bandicam 2024-03-29 12-38-47-045.jpg",
"bandicam 2024-03-29 12-39-47-039.jpg", "bandicam 2024-03-29 12-40-47-050.jpg",
"bandicam 2024-03-29 12-41-47-047.jpg", "bandicam 2024-03-29 12-42-47-057.jpg",
"bandicam 2024-03-29 12-43-42-169.jpg", "bandicam 2024-03-29 12-44-41-398.jpg"
#+end_example

Αρχικά, κάνουμε load τα dependencies στο script στο οποίο θα γίνει η ανάλυση του πειράματος αυτού.

#+NAME: deps_acetate_s1
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_acetate_s1_analysis.jl

  <<deps>>

#+END_SRC

Έπειτα, ξεκινάμε την ανάλυση αποθηκεύοντας τα file names σε ένα vector της Julia κάνοντας copy τα shell results. Αυτό το vector θα γίνεται loaded σε όλα τα code blocks, για να είναι το κάθε ένα reproducible από μόνο του. Έτσι, στο τελικό script θα υπάρχουν πολλές επαναλήψεις.

*date_saving_acetate_s1*
#+NAME: date_saving_acetate_s1
#+BEGIN_SRC julia

  file_vec = ["bandicam 2024-03-27 18-45-55-857.jpg", "bandicam 2024-03-27 18-46-57-161.jpg",
  "bandicam 2024-03-27 18-48-57-160.jpg", "bandicam 2024-03-27 18-50-57-170.jpg",
  "bandicam 2024-03-27 18-52-57-164.jpg", "bandicam 2024-03-27 18-54-57-162.jpg",
  "bandicam 2024-03-27 18-56-57-167.jpg", "bandicam 2024-03-27 18-58-57-165.jpg",
  "bandicam 2024-03-27 19-00-57-170.jpg", "bandicam 2024-03-27 19-02-57-179.jpg",
  "bandicam 2024-03-27 19-04-57-173.jpg", "bandicam 2024-03-27 19-06-57-182.jpg",
  "bandicam 2024-03-27 19-08-57-185.jpg", "bandicam 2024-03-27 19-10-57-184.jpg",
  "bandicam 2024-03-27 19-12-57-189.jpg", "bandicam 2024-03-27 19-14-57-187.jpg",
  "bandicam 2024-03-27 19-15-06-279.jpg", "bandicam 2024-03-27 19-19-06-273.jpg",
  "bandicam 2024-03-27 19-21-06-276.jpg", "bandicam 2024-03-27 19-23-06-285.jpg",
  "bandicam 2024-03-27 19-25-06-290.jpg", "bandicam 2024-03-27 19-27-06-301.jpg",
  "bandicam 2024-03-27 19-29-06-303.jpg", "bandicam 2024-03-27 19-31-06-301.jpg",
  "bandicam 2024-03-27 19-33-06-297.jpg", "bandicam 2024-03-27 19-35-06-305.jpg",
  "bandicam 2024-03-27 19-37-06-299.jpg", "bandicam 2024-03-27 19-39-06-297.jpg",
  "bandicam 2024-03-27 19-41-06-307.jpg", "bandicam 2024-03-27 19-43-06-299.jpg",
  "bandicam 2024-03-27 19-45-06-298.jpg", "bandicam 2024-03-27 19-47-06-304.jpg",
  "bandicam 2024-03-27 19-48-50-591.jpg", "bandicam 2024-03-29 12-23-36-175.jpg",
  "bandicam 2024-03-29 12-23-50-142.jpg", "bandicam 2024-03-29 12-24-50-161.jpg",
  "bandicam 2024-03-29 12-25-50-156.jpg", "bandicam 2024-03-29 12-26-50-168.jpg",
  "bandicam 2024-03-29 12-27-26-514.jpg", "bandicam 2024-03-29 12-28-26-502.jpg",
  "bandicam 2024-03-29 12-29-26-497.jpg", "bandicam 2024-03-29 12-29-39-894.jpg",
  "bandicam 2024-03-29 12-30-39-902.jpg", "bandicam 2024-03-29 12-31-39-897.jpg",
  "bandicam 2024-03-29 12-32-05-844.jpg", "bandicam 2024-03-29 12-33-05-843.jpg",
  "bandicam 2024-03-29 12-34-05-832.jpg", "bandicam 2024-03-29 12-35-05-836.jpg",
  "bandicam 2024-03-29 12-36-05-835.jpg", "bandicam 2024-03-29 12-37-05-858.jpg",
  "bandicam 2024-03-29 12-38-06-101.jpg", "bandicam 2024-03-29 12-38-47-045.jpg",
  "bandicam 2024-03-29 12-39-47-039.jpg", "bandicam 2024-03-29 12-40-47-050.jpg",
  "bandicam 2024-03-29 12-41-47-047.jpg", "bandicam 2024-03-29 12-42-47-057.jpg",
  "bandicam 2024-03-29 12-43-42-169.jpg", "bandicam 2024-03-29 12-44-41-398.jpg"
  ]

#+END_SRC

#+RESULTS: date_saving_acetate_s1
#+begin_example
58-element Vector{String}:
 "bandicam 2024-03-27 18-45-55-857.jpg"
 "bandicam 2024-03-27 18-46-57-161.jpg"
 "bandicam 2024-03-27 18-48-57-160.jpg"
 "bandicam 2024-03-27 18-50-57-170.jpg"
 "bandicam 2024-03-27 18-52-57-164.jpg"
 "bandicam 2024-03-27 18-54-57-162.jpg"
 "bandicam 2024-03-27 18-56-57-167.jpg"
 "bandicam 2024-03-27 18-58-57-165.jpg"
 "bandicam 2024-03-27 19-00-57-170.jpg"
 "bandicam 2024-03-27 19-02-57-179.jpg"
 ⋮
 "bandicam 2024-03-29 12-37-05-858.jpg"
 "bandicam 2024-03-29 12-38-06-101.jpg"
 "bandicam 2024-03-29 12-38-47-045.jpg"
 "bandicam 2024-03-29 12-39-47-039.jpg"
 "bandicam 2024-03-29 12-40-47-050.jpg"
 "bandicam 2024-03-29 12-41-47-047.jpg"
 "bandicam 2024-03-29 12-42-47-057.jpg"
 "bandicam 2024-03-29 12-43-42-169.jpg"
 "bandicam 2024-03-29 12-44-41-398.jpg"
#+end_example

** Acetate Experiment S2
Λόγω κάποιων προβλημάτων στο προηγούμενο πείραμα και για επιβεβαίωση των αποτελεσμάτων, θα χρησιμοποιηθεί και μία δεύτερη λάσπη για πειράματα. Στο section αυτό θα γίνουν loaded τα απαραίτητα πράγματα για το πείραμα αυτό.

*ls_output_acetate_s1*
#+NAME: ls_output_acetate_s2
#+BEGIN_SRC sh :results output
ls -mQ ../bmp_pictures/Acet_kinetic_S2/
#+END_SRC

#+RESULTS: ls_output_acetate_s2
#+begin_example
"bandicam 2024-04-10 13-59-53-326.jpg", "bandicam 2024-04-10 14-00-47-113.jpg",
"bandicam 2024-04-10 14-01-47-127.jpg", "bandicam 2024-04-10 14-02-24-772.jpg",
"bandicam 2024-04-10 14-03-24-772.jpg", "bandicam 2024-04-10 14-04-13-064.jpg",
"bandicam 2024-04-10 14-05-10-445.jpg", "bandicam 2024-04-10 14-06-10-467.jpg",
"bandicam 2024-04-10 14-07-10-457.jpg", "bandicam 2024-04-10 14-07-29-046.jpg",
"bandicam 2024-04-10 14-08-29-037.jpg", "bandicam 2024-04-10 14-08-57-059.jpg",
"bandicam 2024-04-10 14-09-57-054.jpg", "bandicam 2024-04-10 14-10-57-052.jpg",
"bandicam 2024-04-10 14-11-57-074.jpg", "bandicam 2024-04-10 14-12-57-085.jpg",
"bandicam 2024-04-10 14-13-57-097.jpg", "bandicam 2024-04-10 14-14-57-102.jpg",
"bandicam 2024-04-10 14-15-57-100.jpg", "bandicam 2024-04-10 14-16-57-090.jpg",
"bandicam 2024-04-10 14-17-57-101.jpg"
#+end_example

Αρχικά, κάνουμε load τα dependencies στο script στο οποίο θα γίνει η ανάλυση του πειράματος αυτού.

#+NAME: deps_acetate_s2
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_acetate_s2_analysis.jl

  <<deps>>

#+END_SRC

Έπειτα, ξεκινάμε την ανάλυση αποθηκεύοντας τα file names σε ένα vector της Julia κάνοντας copy τα shell results. Αυτό το vector θα γίνεται loaded σε όλα τα code blocks, για να είναι το κάθε ένα reproducible από μόνο του. Έτσι, στο τελικό script θα υπάρχουν πολλές επαναλήψεις.

*date_saving_acetate_s2*
#+NAME: date_saving_acetate_s2
#+BEGIN_SRC julia

  file_vec = ["bandicam 2024-04-10 13-59-53-326.jpg", "bandicam 2024-04-10 14-00-47-113.jpg",
  "bandicam 2024-04-10 14-01-47-127.jpg", "bandicam 2024-04-10 14-02-24-772.jpg",
  "bandicam 2024-04-10 14-03-24-772.jpg", "bandicam 2024-04-10 14-04-13-064.jpg",
  "bandicam 2024-04-10 14-05-10-445.jpg", "bandicam 2024-04-10 14-06-10-467.jpg",
  "bandicam 2024-04-10 14-07-10-457.jpg", "bandicam 2024-04-10 14-07-29-046.jpg",
  "bandicam 2024-04-10 14-08-29-037.jpg", "bandicam 2024-04-10 14-08-57-059.jpg",
  "bandicam 2024-04-10 14-09-57-054.jpg", "bandicam 2024-04-10 14-10-57-052.jpg",
  "bandicam 2024-04-10 14-11-57-074.jpg", "bandicam 2024-04-10 14-12-57-085.jpg",
  "bandicam 2024-04-10 14-13-57-097.jpg", "bandicam 2024-04-10 14-14-57-102.jpg",
  "bandicam 2024-04-10 14-15-57-100.jpg", "bandicam 2024-04-10 14-16-57-090.jpg",
  "bandicam 2024-04-10 14-17-57-101.jpg"
  ]

#+END_SRC

#+RESULTS: date_saving_acetate_s2
#+begin_example
21-element Vector{String}:
 "bandicam 2024-04-10 13-59-53-326.jpg"
 "bandicam 2024-04-10 14-00-47-113.jpg"
 "bandicam 2024-04-10 14-01-47-127.jpg"
 "bandicam 2024-04-10 14-02-24-772.jpg"
 "bandicam 2024-04-10 14-03-24-772.jpg"
 "bandicam 2024-04-10 14-04-13-064.jpg"
 "bandicam 2024-04-10 14-05-10-445.jpg"
 "bandicam 2024-04-10 14-06-10-467.jpg"
 "bandicam 2024-04-10 14-07-10-457.jpg"
 "bandicam 2024-04-10 14-07-29-046.jpg"
 ⋮
 "bandicam 2024-04-10 14-09-57-054.jpg"
 "bandicam 2024-04-10 14-10-57-052.jpg"
 "bandicam 2024-04-10 14-11-57-074.jpg"
 "bandicam 2024-04-10 14-12-57-085.jpg"
 "bandicam 2024-04-10 14-13-57-097.jpg"
 "bandicam 2024-04-10 14-14-57-102.jpg"
 "bandicam 2024-04-10 14-15-57-100.jpg"
 "bandicam 2024-04-10 14-16-57-090.jpg"
 "bandicam 2024-04-10 14-17-57-101.jpg"
#+end_example

** FW Hydrolysate Experiment S1_R1
Με την ίδια λογική με παραπάνω, κάνουμε load ότι θα χρειαστεί για αυτό το πείραμα.

*ls_output_fw_s1_r1*
#+NAME: ls_output_fw_s1_r1
#+BEGIN_SRC sh :results output
ls -mQ ../bmp_pictures/Hydrolyzed_FW_S1_R1/
#+END_SRC

#+RESULTS: ls_output_fw_s1_r1
#+begin_example
"bandicam 2024-04-01 11-05-53-069.jpg", "bandicam 2024-04-01 11-09-37-035.jpg",
"bandicam 2024-04-01 11-11-37-051.jpg", "bandicam 2024-04-01 11-12-37-060.jpg",
"bandicam 2024-04-01 11-13-26-776.jpg", "bandicam 2024-04-01 11-14-26-770.jpg",
"bandicam 2024-04-01 11-15-26-780.jpg", "bandicam 2024-04-01 11-21-53-098.jpg",
"bandicam 2024-04-01 11-52-12-665.jpg", "bandicam 2024-04-01 12-22-12-663.jpg",
"bandicam 2024-04-01 13-52-12-676.jpg", "bandicam 2024-04-01 15-52-12-680.jpg",
"bandicam 2024-04-01 16-52-12-699.jpg", "bandicam 2024-04-01 18-52-12-586.jpg",
"bandicam 2024-04-01 20-52-12-578.jpg", "bandicam 2024-04-01 22-52-12-785.jpg",
"bandicam 2024-04-02 00-52-13-685.jpg", "bandicam 2024-04-02 02-52-13-485.jpg",
"bandicam 2024-04-02 04-52-13-458.jpg", "bandicam 2024-04-02 06-52-14-845.jpg",
"bandicam 2024-04-02 08-52-12-148.jpg", "bandicam 2024-04-02 10-54-01-344.jpg",
"bandicam 2024-04-02 12-54-01-788.jpg", "bandicam 2024-04-02 13-24-01-783.jpg",
"bandicam 2024-04-02 13-54-01-797.jpg", "bandicam 2024-04-02 14-24-01-798.jpg",
"bandicam 2024-04-02 14-54-01-793.jpg", "bandicam 2024-04-02 15-24-01-786.jpg",
"bandicam 2024-04-02 15-54-01-785.jpg", "bandicam 2024-04-02 16-24-01-800.jpg",
"bandicam 2024-04-02 16-54-01-801.jpg", "bandicam 2024-04-02 17-24-01-784.jpg",
"bandicam 2024-04-02 17-54-02-191.jpg", "bandicam 2024-04-02 19-54-02-222.jpg",
"bandicam 2024-04-02 21-54-02-318.jpg", "bandicam 2024-04-02 23-54-02-573.jpg",
"bandicam 2024-04-03 01-54-02-576.jpg", "bandicam 2024-04-03 03-54-02-564.jpg",
"bandicam 2024-04-03 05-54-02-863.jpg", "bandicam 2024-04-03 07-54-02-978.jpg",
"bandicam 2024-04-03 09-54-02-983.jpg", "bandicam 2024-04-03 12-54-03-516.jpg",
"bandicam 2024-04-03 13-54-03-505.jpg", "bandicam 2024-04-03 14-24-03-564.jpg",
"bandicam 2024-04-03 14-54-49-083.jpg", "bandicam 2024-04-03 15-26-51-834.jpg",
"bandicam 2024-04-03 16-29-08-087.jpg", "bandicam 2024-04-03 17-29-08-355.jpg",
"bandicam 2024-04-03 18-29-08-352.jpg", "bandicam 2024-04-03 20-29-08-355.jpg"
#+end_example

#+NAME: deps_fw_s1_r1
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_fw_hydrolysate_s1_r1_analysis.jl

  <<deps>>

#+END_SRC

#+NAME: date_saving_fw_s1_r1
#+BEGIN_SRC julia

  file_vec = ["bandicam 2024-04-01 11-05-53-069.jpg", "bandicam 2024-04-01 11-09-37-035.jpg",
  "bandicam 2024-04-01 11-11-37-051.jpg", "bandicam 2024-04-01 11-12-37-060.jpg",
  "bandicam 2024-04-01 11-13-26-776.jpg", "bandicam 2024-04-01 11-14-26-770.jpg",
  "bandicam 2024-04-01 11-15-26-780.jpg", "bandicam 2024-04-01 11-21-53-098.jpg",
  "bandicam 2024-04-01 11-52-12-665.jpg", "bandicam 2024-04-01 12-22-12-663.jpg",
  "bandicam 2024-04-01 13-52-12-676.jpg", "bandicam 2024-04-01 15-52-12-680.jpg",
  "bandicam 2024-04-01 16-52-12-699.jpg", "bandicam 2024-04-01 18-52-12-586.jpg",
  "bandicam 2024-04-01 20-52-12-578.jpg", "bandicam 2024-04-01 22-52-12-785.jpg",
  "bandicam 2024-04-02 00-52-13-685.jpg", "bandicam 2024-04-02 02-52-13-485.jpg",
  "bandicam 2024-04-02 04-52-13-458.jpg", "bandicam 2024-04-02 06-52-14-845.jpg",
  "bandicam 2024-04-02 08-52-12-148.jpg", "bandicam 2024-04-02 10-54-01-344.jpg",
  "bandicam 2024-04-02 12-54-01-788.jpg", "bandicam 2024-04-02 13-24-01-783.jpg",
  "bandicam 2024-04-02 13-54-01-797.jpg", "bandicam 2024-04-02 14-24-01-798.jpg",
  "bandicam 2024-04-02 14-54-01-793.jpg", "bandicam 2024-04-02 15-24-01-786.jpg",
  "bandicam 2024-04-02 15-54-01-785.jpg", "bandicam 2024-04-02 16-24-01-800.jpg",
  "bandicam 2024-04-02 16-54-01-801.jpg", "bandicam 2024-04-02 17-24-01-784.jpg",
  "bandicam 2024-04-02 17-54-02-191.jpg", "bandicam 2024-04-02 19-54-02-222.jpg",
  "bandicam 2024-04-02 21-54-02-318.jpg", "bandicam 2024-04-02 23-54-02-573.jpg",
  "bandicam 2024-04-03 01-54-02-576.jpg", "bandicam 2024-04-03 03-54-02-564.jpg",
  "bandicam 2024-04-03 05-54-02-863.jpg", "bandicam 2024-04-03 07-54-02-978.jpg",
  "bandicam 2024-04-03 09-54-02-983.jpg", "bandicam 2024-04-03 12-54-03-516.jpg",
  "bandicam 2024-04-03 13-54-03-505.jpg", "bandicam 2024-04-03 14-24-03-564.jpg",
  "bandicam 2024-04-03 14-54-49-083.jpg", "bandicam 2024-04-03 15-26-51-834.jpg",
  "bandicam 2024-04-03 16-29-08-087.jpg", "bandicam 2024-04-03 17-29-08-355.jpg",
  "bandicam 2024-04-03 18-29-08-352.jpg", "bandicam 2024-04-03 20-29-08-355.jpg"
  ]
#+END_SRC

#+RESULTS: date_saving_fw_s1_r1
#+begin_example
50-element Vector{String}:
 "bandicam 2024-04-01 11-05-53-069.jpg"
 "bandicam 2024-04-01 11-09-37-035.jpg"
 "bandicam 2024-04-01 11-11-37-051.jpg"
 "bandicam 2024-04-01 11-12-37-060.jpg"
 "bandicam 2024-04-01 11-13-26-776.jpg"
 "bandicam 2024-04-01 11-14-26-770.jpg"
 "bandicam 2024-04-01 11-15-26-780.jpg"
 "bandicam 2024-04-01 11-21-53-098.jpg"
 "bandicam 2024-04-01 11-52-12-665.jpg"
 "bandicam 2024-04-01 12-22-12-663.jpg"
 ⋮
 "bandicam 2024-04-03 12-54-03-516.jpg"
 "bandicam 2024-04-03 13-54-03-505.jpg"
 "bandicam 2024-04-03 14-24-03-564.jpg"
 "bandicam 2024-04-03 14-54-49-083.jpg"
 "bandicam 2024-04-03 15-26-51-834.jpg"
 "bandicam 2024-04-03 16-29-08-087.jpg"
 "bandicam 2024-04-03 17-29-08-355.jpg"
 "bandicam 2024-04-03 18-29-08-352.jpg"
 "bandicam 2024-04-03 20-29-08-355.jpg"
#+end_example

#+RESULTS: date_saving_fw_1
#+begin_example
34-element Vector{String}:
 "bandicam 2024-04-01 11-05-53-069.jpg"
 "bandicam 2024-04-01 11-09-37-035.jpg"
 "bandicam 2024-04-01 11-11-37-051.jpg"
 "bandicam 2024-04-01 11-12-37-060.jpg"
 "bandicam 2024-04-01 11-13-26-776.jpg"
 "bandicam 2024-04-01 11-14-26-770.jpg"
 "bandicam 2024-04-01 11-15-26-780.jpg"
 "bandicam 2024-04-01 11-21-53-098.jpg"
 "bandicam 2024-04-01 11-52-12-665.jpg"
 "bandicam 2024-04-01 12-22-12-663.jpg"
 ⋮
 "bandicam 2024-04-02 23-54-02-573.jpg"
 "bandicam 2024-04-03 01-54-02-576.jpg"
 "bandicam 2024-04-03 03-54-02-564.jpg"
 "bandicam 2024-04-03 05-54-02-863.jpg"
 "bandicam 2024-04-03 07-54-02-978.jpg"
 "bandicam 2024-04-03 09-54-02-983.jpg"
 "bandicam 2024-04-03 12-54-03-516.jpg"
 "bandicam 2024-04-03 13-54-03-505.jpg"
 "bandicam 2024-04-03 14-24-03-564.jpg"
#+end_example

** FW Hydrolysate Experiment S1_R2
ls_output_fw_s1_r1*
#+NAME: ls_output_fw_s1_r2
#+BEGIN_SRC sh :results output
ls -mQ ../bmp_pictures/Hydrolyzed_FW_S1_R2/
#+END_SRC

#+RESULTS: ls_output_fw_s1_r2
#+begin_example
"bandicam 2024-04-03 14-37-15-369.jpg", "bandicam 2024-04-03 14-45-40-862.jpg",
"bandicam 2024-04-03 14-51-49-082.jpg", "bandicam 2024-04-03 14-56-51-812.jpg",
"bandicam 2024-04-03 15-29-08-067.jpg", "bandicam 2024-04-03 16-29-08-087.jpg",
"bandicam 2024-04-03 17-29-08-355.jpg", "bandicam 2024-04-03 18-29-08-352.jpg",
"bandicam 2024-04-03 20-29-08-355.jpg", "bandicam 2024-04-03 22-29-08-353.jpg",
"bandicam 2024-04-04 00-29-08-754.jpg", "bandicam 2024-04-04 02-29-08-758.jpg",
"bandicam 2024-04-04 04-29-08-760.jpg", "bandicam 2024-04-04 06-29-08-755.jpg",
"bandicam 2024-04-04 08-29-09-002.jpg", "bandicam 2024-04-04 10-29-09-357.jpg",
"bandicam 2024-04-04 12-29-09-384.jpg", "bandicam 2024-04-04 14-29-09-390.jpg",
"bandicam 2024-04-04 16-29-09-384.jpg", "bandicam 2024-04-04 18-29-10-491.jpg",
"bandicam 2024-04-04 20-29-10-660.jpg", "bandicam 2024-04-04 22-29-10-735.jpg",
"bandicam 2024-04-05 00-29-10-440.jpg", "bandicam 2024-04-05 02-29-10-498.jpg",
"bandicam 2024-04-05 04-29-10-676.jpg", "bandicam 2024-04-05 06-29-10-716.jpg",
"bandicam 2024-04-05 08-29-10-712.jpg", "bandicam 2024-04-05 09-29-10-696.jpg",
"bandicam 2024-04-05 10-37-27-280.jpg", "bandicam 2024-04-05 10-38-27-278.jpg",
"bandicam 2024-04-05 10-39-27-276.jpg", "bandicam 2024-04-05 10-40-25-889.jpg",
"bandicam 2024-04-05 11-40-36-404.jpg", "bandicam 2024-04-05 12-40-36-754.jpg",
"bandicam 2024-04-05 14-40-36-749.jpg", "bandicam 2024-04-05 16-40-36-776.jpg",
"bandicam 2024-04-05 18-40-37-133.jpg", "bandicam 2024-04-05 20-40-37-184.jpg",
"bandicam 2024-04-05 22-40-37-342.jpg", "bandicam 2024-04-06 00-40-37-559.jpg",
"bandicam 2024-04-06 02-40-37-573.jpg", "bandicam 2024-04-06 04-40-37-567.jpg",
"bandicam 2024-04-06 06-40-37-889.jpg", "bandicam 2024-04-06 08-40-38-009.jpg",
"bandicam 2024-04-06 10-40-38-008.jpg", "bandicam 2024-04-06 12-40-38-486.jpg",
"bandicam 2024-04-06 14-40-38-501.jpg", "bandicam 2024-04-06 16-40-38-661.jpg",
"bandicam 2024-04-06 18-40-38-699.jpg", "bandicam 2024-04-06 20-40-38-706.jpg",
"bandicam 2024-04-06 22-40-38-709.jpg", "bandicam 2024-04-07 00-40-39-320.jpg",
"bandicam 2024-04-07 02-40-39-358.jpg", "bandicam 2024-04-07 04-40-39-364.jpg",
"bandicam 2024-04-07 06-40-39-358.jpg", "bandicam 2024-04-07 08-40-39-476.jpg",
"bandicam 2024-04-07 10-40-40-039.jpg", "bandicam 2024-04-07 12-40-40-161.jpg",
"bandicam 2024-04-07 14-40-40-252.jpg", "bandicam 2024-04-07 16-40-40-328.jpg",
"bandicam 2024-04-07 18-40-40-704.jpg", "bandicam 2024-04-07 20-40-40-780.jpg",
"bandicam 2024-04-07 22-40-40-847.jpg", "bandicam 2024-04-08 00-40-41-872.jpg",
"bandicam 2024-04-08 02-40-41-942.jpg", "bandicam 2024-04-08 04-40-41-412.jpg",
"bandicam 2024-04-08 06-40-41-369.jpg", "bandicam 2024-04-08 08-40-41-364.jpg",
"bandicam 2024-04-08 10-40-41-360.jpg"
#+end_example

#+NAME: deps_fw_s1_r2
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_fw_hydrolysate_s1_r2_analysis.jl

  <<deps>>

#+END_SRC

#+NAME: date_saving_fw_s1_r2
#+BEGIN_SRC julia

  file_vec = ["bandicam 2024-04-03 14-37-15-369.jpg", "bandicam 2024-04-03 14-45-40-862.jpg",
  "bandicam 2024-04-03 14-51-49-082.jpg", "bandicam 2024-04-03 14-56-51-812.jpg",
  "bandicam 2024-04-03 15-29-08-067.jpg", "bandicam 2024-04-03 16-29-08-087.jpg",
  "bandicam 2024-04-03 17-29-08-355.jpg", "bandicam 2024-04-03 18-29-08-352.jpg",
  "bandicam 2024-04-03 20-29-08-355.jpg", "bandicam 2024-04-03 22-29-08-353.jpg",
  "bandicam 2024-04-04 00-29-08-754.jpg", "bandicam 2024-04-04 02-29-08-758.jpg",
  "bandicam 2024-04-04 04-29-08-760.jpg", "bandicam 2024-04-04 06-29-08-755.jpg",
  "bandicam 2024-04-04 08-29-09-002.jpg", "bandicam 2024-04-04 10-29-09-357.jpg",
  "bandicam 2024-04-04 12-29-09-384.jpg", "bandicam 2024-04-04 14-29-09-390.jpg",
  "bandicam 2024-04-04 16-29-09-384.jpg", "bandicam 2024-04-04 18-29-10-491.jpg",
  "bandicam 2024-04-04 20-29-10-660.jpg", "bandicam 2024-04-04 22-29-10-735.jpg",
  "bandicam 2024-04-05 00-29-10-440.jpg", "bandicam 2024-04-05 02-29-10-498.jpg",
  "bandicam 2024-04-05 04-29-10-676.jpg", "bandicam 2024-04-05 06-29-10-716.jpg",
  "bandicam 2024-04-05 08-29-10-712.jpg", "bandicam 2024-04-05 09-29-10-696.jpg",
  "bandicam 2024-04-05 10-37-27-280.jpg", "bandicam 2024-04-05 10-38-27-278.jpg",
  "bandicam 2024-04-05 10-39-27-276.jpg", "bandicam 2024-04-05 10-40-25-889.jpg",
  "bandicam 2024-04-05 11-40-36-404.jpg", "bandicam 2024-04-05 12-40-36-754.jpg",
  "bandicam 2024-04-05 14-40-36-749.jpg", "bandicam 2024-04-05 16-40-36-776.jpg",
  "bandicam 2024-04-05 18-40-37-133.jpg", "bandicam 2024-04-05 20-40-37-184.jpg",
  "bandicam 2024-04-05 22-40-37-342.jpg", "bandicam 2024-04-06 00-40-37-559.jpg",
  "bandicam 2024-04-06 02-40-37-573.jpg", "bandicam 2024-04-06 04-40-37-567.jpg",
  "bandicam 2024-04-06 06-40-37-889.jpg", "bandicam 2024-04-06 08-40-38-009.jpg",
  "bandicam 2024-04-06 10-40-38-008.jpg", "bandicam 2024-04-06 12-40-38-486.jpg",
  "bandicam 2024-04-06 14-40-38-501.jpg", "bandicam 2024-04-06 16-40-38-661.jpg",
  "bandicam 2024-04-06 18-40-38-699.jpg", "bandicam 2024-04-06 20-40-38-706.jpg",
  "bandicam 2024-04-06 22-40-38-709.jpg", "bandicam 2024-04-07 00-40-39-320.jpg",
  "bandicam 2024-04-07 02-40-39-358.jpg", "bandicam 2024-04-07 04-40-39-364.jpg",
  "bandicam 2024-04-07 06-40-39-358.jpg", "bandicam 2024-04-07 08-40-39-476.jpg",
  "bandicam 2024-04-07 10-40-40-039.jpg", "bandicam 2024-04-07 12-40-40-161.jpg",
  "bandicam 2024-04-07 14-40-40-252.jpg", "bandicam 2024-04-07 16-40-40-328.jpg",
  "bandicam 2024-04-07 18-40-40-704.jpg", "bandicam 2024-04-07 20-40-40-780.jpg",
  "bandicam 2024-04-07 22-40-40-847.jpg", "bandicam 2024-04-08 00-40-41-872.jpg",
  "bandicam 2024-04-08 02-40-41-942.jpg", "bandicam 2024-04-08 04-40-41-412.jpg",
  "bandicam 2024-04-08 06-40-41-369.jpg", "bandicam 2024-04-08 08-40-41-364.jpg",
  "bandicam 2024-04-08 10-40-41-360.jpg"
  ]
#+END_SRC

#+RESULTS: date_saving_fw_s1_r2
#+begin_example
69-element Vector{String}:
 "bandicam 2024-04-03 14-37-15-369.jpg"
 "bandicam 2024-04-03 14-45-40-862.jpg"
 "bandicam 2024-04-03 14-51-49-082.jpg"
 "bandicam 2024-04-03 14-56-51-812.jpg"
 "bandicam 2024-04-03 15-29-08-067.jpg"
 "bandicam 2024-04-03 16-29-08-087.jpg"
 "bandicam 2024-04-03 17-29-08-355.jpg"
 "bandicam 2024-04-03 18-29-08-352.jpg"
 "bandicam 2024-04-03 20-29-08-355.jpg"
 "bandicam 2024-04-03 22-29-08-353.jpg"
 ⋮
 "bandicam 2024-04-07 18-40-40-704.jpg"
 "bandicam 2024-04-07 20-40-40-780.jpg"
 "bandicam 2024-04-07 22-40-40-847.jpg"
 "bandicam 2024-04-08 00-40-41-872.jpg"
 "bandicam 2024-04-08 02-40-41-942.jpg"
 "bandicam 2024-04-08 04-40-41-412.jpg"
 "bandicam 2024-04-08 06-40-41-369.jpg"
 "bandicam 2024-04-08 08-40-41-364.jpg"
 "bandicam 2024-04-08 10-40-41-360.jpg"
#+end_example

* Data Processing
Έπειτα, μπορούμε να κάνουμε extract τις πληροφορίες που θέλουμε, με το Dates.jl package της Julia. Σε αυτό το code block, δεν θα ορίσουμε το file vector και αυτό θα υποτεθεί defined. Έτσι, δεν μπορούμε να τρέξουμε independently το block αυτό, αλλά μόνο chained σε ένα definition των files, για να μπορεί να τρέξει αντίστοιχα σε κάθε πείραμα. Επίσης, εκτός από να κάνουμε extract τα time stamps, φτιάχνουμε και ένα δεύτερο vector με time stamp dd/mm_HH:MM το οποίο είναι πιο βολικό στη χρήση για εμένα.

Στη συνέχεια, ορίζουμε άλλη μία μεταβλητή η οποία δεν υπάρχει, η ~inds~. Αυτή είναι τα νούμερα στο date_vec που αντιστοιχούν σε ένα ορισμένο πείραμα. Παίρνουμε τα time stamps και στην αρχική αλλά και στην formatted μορφή για αυτό το πείραμα και μετά υπολογίζουμε τα time steps και σε δευτερόλεπτα αλλά και σε λεπτά. Η αφαίρεση δύο ~DateTime~ objects δίνει αποτέλεσμα σε ~Millisecond~, οπότε ο χρόνος σε δευτερόλεπτα διαιρεί με 1000 ~Millisecond~ ενώ σε λεπτά με 60000 ~Millisecond~. Έπειτα, ορίζουμε ένα τρίτο undefined variable το exp_meth_vol, το οποίο είναι η παραγωγή μεθανίου μεταξύ των δύο φωτογραφιών, όπως σημειώνεται σε αυτές. Για την κινητική, θέλουμε την αθροιστική παραγωγή μεθανίου, οπότε χρησιμοποιούμε την συνάρτηση ~cumsum~.

Τέλος, αποθηκεύουμε όλα αυτά τα δεδομένα σε ένα table του ~Tables.jl~ interface, ώστε να μπορούμε να το κάνουμε DataFrame με headers για καλύτερο readability ή να το κάνουμε export σε csv. Για το csv export χρειαζόμαστε ένα file name. Αυτό μπορεί για άλλη μία φορά να μην οριστεί εδώ και να χρησιμοποιηθεί ως variable. Βέβαια, ένα σημαντικό σημείο είναι πως τα πειράματα με οξικό πάνε γρήγορα, ενώ με το υδρόλυμα των FW αρκετά πιο αργά. Οπότε, αν το variable ~source~ είναι ίσο με "Hydrolyzed FW", κάνουμε save τον χρόνο σε λεπτά και ώρες, αλλιώς σε λεπτά και δευτερόλεπτα.

*bmp_data_processing*
#+NAME: bmp_data_processing
#+BEGIN_SRC julia

  date_vec = [DateTime(SubString(file_vec[i], 10, 32), "yyyy-mm-dd HH-MM-SS-sss") for i in 1:length(file_vec)]
  formatted_date = [Dates.format(date_vec[i], "dd/mm_HH:MM") for i in 1:length(date_vec)]

  exp_stamps = date_vec[inds]
  exp_formatted = formatted_date[inds]
  exp_sec = round.([(exp_stamps[i] - exp_stamps[1])/Millisecond(1000) for i in 1:length(inds)]; digits = 4)
  exp_min = round.([(exp_stamps[i] - exp_stamps[1])/Millisecond(60000) for i in 1:length(inds)]; digits = 4)
  exp_hour = round.([(exp_stamps[i] - exp_stamps[1])/Millisecond(3600000) for i in 1:length(inds)]; digits = 4)
  exp_cum_meth_vol = round.(cumsum(exp_meth_vol); digits = 3)

  if source == "Acetate"
      exp_data = Tables.table(hcat(exp_formatted, exp_sec, exp_min, exp_meth_vol, exp_cum_meth_vol), header = [:Timestamp, :Seconds, :Minutes, :Methane_Volume, :Cumulative_Methane_Volume])
  else
      exp_data = Tables.table(hcat(exp_formatted, exp_min, exp_hour, exp_meth_vol, exp_cum_meth_vol), header = [:Timestamp, :Minutes, :Hours, :Methane_Volume, :Cumulative_Methane_Volume])
  end

  CSV.write(datadir("exp_pro", exp_name*".csv"), exp_data)
  exp_df = DataFrame(exp_data)

#+END_SRC

** Curve Fitting
Επίσης, θέλουμε να κάνουμε fit τα δεδομένα σε κάποιο κινητικό μοντέλο για την διεργασία, κάτι το οποίο θα βοηθήσει στη μοντελοποιήση της. Το μοντέλο Gompertz είναι ένα μοντέλο που χρησιμοποιείται συχνά για kinetic modelling διεργασιών όπως η παραγωγή μεθανίου μέσω αναερόβιας χώνευσης, οπότε θα χρησιμοποιηθεί αυτό. Η εξίσωση που θα πρέπει να προσαρμοστεί είναι η
\[ P(t) = P_{\max } \exp \left( - \exp \left[ \frac{R_{\max }e (λ-t)}{P_{\max }} + 1 \right] \right) \]
όπου P(t) η παραγωγή μεθανίου την στιγμή t, P_max η μέγιστη ποσότητα μεθανίου που μπορεί να παραχθεί από το υπόστρωμα αυτό, R_max ο ειδικός ρυθμός παραγωγής μεθανίου, λ το lag time και e η σταθερά Euler. Παρακάτω φαίνεται το fit των δεδομένων στην συνάρτηση αυτή. Αξίζει να αναφερθεί η χρήση της μεταβλητής ~input_cod~ που φαίνεται παρακάτω. Η μεταβλητή αυτή εκφράζει το COD της τροφοδοσίας. Διαιρούμε τον όγκο μεθανίου με αυτήν ώστε το διάγραμμα να εκφράζει ειδικό ρυθμό παραγωγής μεθανίου σε \( \frac{\text{mL CH$_4$}}{\text{g sCOD}} \), το οποίο είναι πιο εύκολα συγκρίσιμο με βιβλιογραφία, σε σχέση με τον όγκο μεθανίου. Επίσης, αξίζει να σημειωθεί η χρήση bounded optimization. Οι παραμέτροι του μοντέλου έχουν νόημα μόνο ως θετικοί αριθμοί. Στα πειράματα με χρήση οξικό ως υπόστρωμα, όπου οι μικροοργανισμοί αντιδρούν ταχύτατα στην αλλαγή του περιβάλλοντος, η προσαρμογή του μοντέλου έδινε αρνητικό lag time. Αυτό προφανώς δεν έχει νόημα και στην πράξη, το συμπέρασμα είναι πως το lag time είναι μηδενικό (σχεδόν ακαριαία αντίδραση των μικροοργανισμών στην προσθήκη οξικού στο σύστημα). Επίσης, αξίζει να αναφερθεί η μεταβλητή ~kinetics~. Σε κάποια πειράματα (πχ τις μετρήσεις παραγωγής μεθανίου χωρίς προσθήκη υποστρώματος που έγινε σε ένα δείγμα) δεν θέλουμε να κάνουμε προσαρμογή με το μοντέλο Gompertz. Αυτή η μεταβλητή είναι στην ουσία ένα toggle off του plot με την κινητική, για όσα πειράματα δεν το χρειάζονται.

Παρακάτω υπάρχουν 2 code blocks. Το πρώτο κάνει fit σε timescale λεπτών ενώ το δεύτερο σε ωρών. Ανάλογα με το πείραμα, μπορεί να βγάλουν ίδια αποτελέσματα, αλλά ενδέχεται να είναι και διαφορετικά.

*bmp_curve_fitting_min*
#+NAME: bmp_curve_fitting_min
#+BEGIN_SRC julia

  gompertz_bmp(t, p) = @. p[1]*exp(-exp((((p[2]*exp(1))/p[1])*(p[3] - t)) + 1))
  
  lb = [0.0, 0.0, 0.0]
  ub = [Inf, Inf, Inf]

  fit = curve_fit(gompertz_bmp, exp_min, exp_cum_meth_vol, p0, lower = lb, upper = ub)

  model_params = fit.param
  gompertz_bmp(t) = gompertz_bmp(t, model_params)

  model_res = fit.resid
  SS_res = sum(model_res.^2)
  SS_tot = sum([(exp_cum_meth_vol[i] - mean(exp_cum_meth_vol)).^2 for i in 1:length(exp_cum_meth_vol)])
  r_squared = 1 - SS_res/SS_tot

  kinetics = "bmp"
  timescale = "min"
#+END_SRC


*bmp_curve_fitting_hour*
#+NAME: bmp_curve_fitting_hour
#+BEGIN_SRC julia

  gompertz_bmp(t, p) = @. p[1]*exp(-exp((((p[2]*exp(1))/p[1])*(p[3] - t)) + 1))
  lb = [0.0, 0.0, 0.0]
  ub = [Inf, Inf, Inf]

  fit = curve_fit(gompertz_bmp, exp_hour, exp_cum_meth_vol, p0, lower = lb, upper = ub)

  model_params = fit.param
  gompertz_bmp(t) = gompertz_bmp(t, model_params)

  model_res = fit.resid
  SS_res = sum(model_res.^2)
  SS_tot = sum([(exp_cum_meth_vol[i] - mean(exp_cum_meth_vol)).^2 for i in 1:length(exp_cum_meth_vol)])
  r_squared = 1 - SS_res/SS_tot

  kinetics = "bmp"
  timescale = "hour"
#+END_SRC

*** Sludge Methanogenic Activity (SMA)
Ένα ακόμη κριτήριο που χρησιμοποιείται συχνά για να κάνουμε assess την ποιότητα της χώνευσης είναι το SMA. Ορίζεται ως ο μέγιστος όγκος μεθανίου ανά ημέρα και ανά g VS λάσπης που έχει προστεθεί στον αντιδραστήρα. Οπότε, μπορεί να βρεθεί με ακριβώς ίδια λογική με παραπάνω. Για τα πειράματα με οξικό θα γίνει προσαρμογή σε λεπτά και θα πολλαπλασιάσουμε με 60 για να το πάρουμε σε ώρες, ενώ τα FW τα οποία είναι και σχετικά αργά μπορούν να γίνουν fit κατευθείαν σε ώρες.

*sma_curve_fitting_min*
#+NAME: sma_curve_fitting_min
#+BEGIN_SRC julia

  gompertz_sma(t, p) = @. p[1]*exp(-exp((((p[2]*exp(1))/p[1])*(p[3] - t)) + 1))

  lb = [0.0, 0.0, 0.0]
  ub = [Inf, Inf, Inf]
  specific_meth_vol = exp_cum_meth_vol./input_vs

  fit = curve_fit(gompertz_sma, exp_min, specific_meth_vol, p0, lower = lb, upper = ub)

  model_params = fit.param
  gompertz_sma(t) = gompertz_sma(t, model_params)

  model_res = fit.resid
  SS_res = sum(model_res.^2)
  SS_tot = sum([(specific_meth_vol[i] - mean(specific_meth_vol)).^2 for i in 1:length(specific_meth_vol)])
  r_squared = 1 - SS_res/SS_tot

  kinetics = "sma"
  timescale = "min"
#+END_SRC

#+RESULTS: sma_curve_fitting_min
: "min"

*sma_curve_fitting_hour*
#+NAME: sma_curve_fitting_hour
#+BEGIN_SRC julia

  gompertz_sma(t, p) = @. p[1]*exp(-exp((((p[2]*exp(1))/p[1])*(p[3] - t)) + 1))
  lb = [0.0, 0.0, 0.0]
  ub = [Inf, Inf, Inf]
  specific_meth_vol = exp_cum_meth_vol./input_vs

  fit = curve_fit(gompertz_sma, exp_hour, specific_meth_vol, p0, lower = lb, upper = ub)

  model_params = fit.param
  gompertz_sma(t) = gompertz_sma(t, model_params)

  model_res = fit.resid
  SS_res = sum(model_res.^2)
  SS_tot = sum([(specific_meth_vol[i] - mean(specific_meth_vol)).^2 for i in 1:length(specific_meth_vol)])
  r_squared = 1 - SS_res/SS_tot

  kinetics = "sma"
  timescale = "hour"
#+END_SRC

** Plotting
Τέλος, έχοντας προσαρμώσει το μοντέλο Gompertz σε κάθε σετ δεδομένων, θέλουμε να φτιάξουμε κάποια διαγράμματα με τα δεδομένα, τα οποία να δείχνουν την παραγόμενη ποσότητα μεθανίου στον χρόνο. Τα πειραματικά δεδομένα θα γίνουν plotted σε scatter plots. Χάριν ευκολίας, μπορούν να γίνουν plotted διαγράμματα και της στιγμιαίας αλλά και της συνολικής παραγωγής μεθανίου και σε άξονα χρόνου είτε λεπτά ή δευτερόλεπτα. Ο παραπάνω κώδικας υπολογίζει το fit του cumulative methane production σε λεπτά, καθώς θεωρείται η πιο χρήσιμη έκφραση, οπότε αυτό θα είναι και το διάγραμμα που έχει fit την καμπύλη. Εδώ θα εκμεταλλευτούμε τα variables που υπολογίζονται παραπάνω καθώς και 2 ακόμη, το ~sample~ και το ~source~. Το ~source~ είναι ένα απλό variable το οποίο εκφράζει αν η τροφοδοσία ήταν οξικό ή υδρόλυμα για να τα ξεχωρίζουμε πιο εύκολα. Επίσης, χρησιμοποιείται για να κάνει generate τα σωστά plots (δευτερόλεπτα και λεπτά με fitting σε λεπτά για οξικό, λεπτά και ώρες με fitting ανάλογα το timescale για τα υδρολύματα). Το ~sample~ εκφράζει το νούμερο του δείγματος για να είναι πιο εύκολο το naming scheme.

*bmp_data_plotting*
#+NAME: bmp_data_plotting
#+BEGIN_SRC julia

  if source == "Acetate"
      if kinetics == "bmp"
	  bmp_cumulative_scatter_min = Plots.scatter(exp_min, exp_cum_meth_vol, markersize = 5, legend = :bottomright, label = "Experimental Data", xlabel = "Time (min)", ylabel = "Cumulative Methane Volume (mL)", title = "Cumulative Methane Production from "*source*" \nUsing "*sample*" "*sludge, size = (700, 470))
	  Plots.plot!(exp_min, gompertz_bmp(exp_min), label = "Gompertz Model with R^2 = "*string(round(r_squared, digits = 3)))
	  savefig(bmp_cumulative_scatter_min, plotsdir("BMPs", source, "methane_kinetics_"*exp_name*"_min.png"))

      elseif kinetics == "sma"
	  bmp_specific_methane = Plots.scatter(exp_min, specific_meth_vol, markersize = 5, label = "Experimental Data", xlabel = "Time (min)", ylabel = "Cumulative Methane Production (mL/g VS)", title = "Methane Production Kinetics from "*source*" \nUsing "*sample*" "*sludge, size = (700, 470), legend = :bottomright)
	  Plots.plot!(exp_min, gompertz_sma(exp_min), label = "Gompertz Model with R^2 = "*string(round(r_squared, digits = 3)))
	  savefig(bmp_specific_methane, plotsdir("BMPs", source, "specific_methane_kinetics_"*exp_name*".png"))
      end
  elseif source == "No_Feed"
      bmp_cumulative_scatter_min = Plots.scatter(exp_min, exp_cum_meth_vol, markersize = 5, legend = false, xlabel = "Time (min)", ylabel = "Cumulative Methane Volume (mL)", title = "Cumulative Methane Production from "*source*" \nUsing "*sample*" "*sludge, size = (700, 470))
      savefig(bmp_cumulative_scatter_min, plotsdir("BMPs", source, "cumulative_"*exp_name*"_min.png"))

      bmp_cumulative_scatter_sec = Plots.scatter(exp_sec, exp_cum_meth_vol, markersize = 5, legend = false, xlabel = "Time (sec)", ylabel = "Cumulative Methane Volume (mL)", title = "Cumulative Methane Production from "*source*" \nUsing "*sample*" "*sludge, size = (700, 470))
      savefig(bmp_cumulative_scatter_sec, plotsdir("BMPs", source, "cumulative_"*exp_name*"_sec.png"))
  else
      if timescale == "hour"
	  if kinetics == "bmp"
	      bmp_cumulative_scatter_hour = Plots.scatter(exp_hour, exp_cum_meth_vol, markersize = 5, legend = :bottomright, label = "Experimental Data", xlabel = "Time (hour)", ylabel = "Cumulative Methane Volume (mL)", title = "Cumulative Methane Production from "*source*" \nUsing "*sample*" "*sludge*" "*run_num, size = (700, 470))
	      Plots.plot!(exp_hour, gompertz_bmp(exp_hour), label = "Gompertz Model with R^2 = "*string(round(r_squared, digits = 3)))
	      savefig(bmp_cumulative_scatter_hour, plotsdir("BMPs", source, "methane_kinetics_"*exp_name*"_hour.png"))
	  elseif kinetics == "sma"
	      bmp_specific_methane = Plots.scatter(exp_hour, specific_meth_vol, markersize = 5, label = "Experimental Data", xlabel = "Time (hour)", ylabel = "Cumulative Methane Production (mL/g VS)", title = "Methane Production Kinetics from "*source*" \nUsing "*sample*" "*sludge*" "*run_num, size = (700, 470), legend = :bottomright)
	      Plots.plot!(exp_hour, gompertz_sma(exp_hour), label = "Gompertz Model with R^2 = "*string(round(r_squared, digits = 3)))
	      savefig(bmp_specific_methane, plotsdir("BMPs", source, "specific_methane_kinetics_"*exp_name*"_"*timescale*".png"))
	  end

      elseif timescale == "min"
	  if kinetics == "bmp"
	      bmp_cumulative_scatter_min = Plots.scatter(exp_min, exp_cum_meth_vol, markersize = 5, legend = :bottomright, label = "Experimental Data", xlabel = "Time (min)", ylabel = "Cumulative Methane Volume (mL)", title = "Cumulative Methane Production from "*source*" \nUsing "*sample*" "*sludge*" "*run_num, size = (700, 470))
	      Plots.plot!(exp_min, gompertz_bmp(exp_min), label = "Gompertz Model with R^2 = "*string(round(r_squared, digits = 3)))
	      savefig(bmp_cumulative_scatter_min, plotsdir("BMPs", source, "methane_kinetics_"*exp_name*"_"*timescale*".png"))
	  end
      end
  end

#+END_SRC

* Acetate Experiment Processing
Παρακάτω αναφέρονται οι δοκιμές που έγιναν με 100 μL οξικό σε κάθε δείγμα και θα χρησιμοποιηθούν πιθανόν συγκριτικά σε σχέση με τα FW. Μετά από τα code blocks που τρέχουν τον κώδικα θα υπάρχουν και κάποια από τα corresponding αποτελέσματα. Συγκεκριμένα, ο πίνακας με τα κινητικά δεδομένα, το διάγραμμα παραγωγής μεθανίου το οποίο έχει το curve fitting και το διάγραμμα στιγμίαιας παραγωγής μεθανίου. Υπάρχουν και κάποια άλλα χρήσιμα διαγράμματα, τα οποία είναι αποθηκευμένα, αλλά εδώ παρατίθενται κάποια για καλύτερη ανάγνωση του αρχείου.

** Acetate Test FW
Το section αυτό αναφέρεται στη δοκιμή με 100 μL οξικό στο δείγμα labelled ως FW (στο οποίο θα τροφοδοτηθούν untreated FW). Notably, δεν είχε διαρροή στις 27/03, αλλά για κάποιον λόγο, στην επαναδοκιμή στις 29/03 δεν παρήγαγε μεθάνιο (τουλάχιστον στην προχοίδα). Οπότε, θα χρησιμοποιηθεί αυτό της 27/03.

*acet_test_fw_s1*
#+NAME: acet_test_fw_s1
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Sample FW ###

  <<date_saving_acetate_s1>>

  inds = 1:20
  exp_meth_vol = [0, 12, 5, 3, 1.5, 1.5, 1, 1.5, 1, 0.5, 0.5, 0.5, 0, 0, 0, 0, 0, 0, 0, 0]
  meth_vol_acet_fw = cumsum(exp_meth_vol)[end]
  exp_name = "acet_test_fw_s1"
  source = "Acetate"
  sample = "Sample FW"
  sludge = "Sludge 1"
  input_vs = 1.55
  p0 = [25.0, 6.0, 1.0]

  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_acet_fw = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [18.0, 4.0, 1.0]    
  <<sma_curve_fitting_min>>
  sma_acet_fw = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))  
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: acet_test_FW_s1
: "../data/exp_pro/acet_test_fw_s1.csv"

#+NAME: acet_data_fw_s1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<acet_test_fw_s1()>> '(4))
#+END_SRC

#+CAPTION: Κινητικά δεδομένα
| Timestamp   |  Seconds | Minutes | Methane_Volume | Cumulative_Methane_Volume |
| 27/03_18:45 |      0.0 |     0.0 |            0.0 |                       0.0 |
| 27/03_18:46 |   61.304 |  1.0217 |           12.0 |                      12.0 |
| 27/03_18:48 |  181.303 |  3.0217 |            5.0 |                      17.0 |
| 27/03_18:50 |  301.313 |  5.0219 |            3.0 |                      20.0 |
| 27/03_18:52 |  421.307 |  7.0218 |            1.5 |                      21.5 |
| 27/03_18:54 |  541.305 |  9.0218 |            1.5 |                      23.0 |
| 27/03_18:56 |   661.31 | 11.0218 |            1.0 |                      24.0 |
| 27/03_18:58 |  781.308 | 13.0218 |            1.5 |                      25.5 |
| 27/03_19:00 |  901.313 | 15.0219 |            1.0 |                      26.5 |
| 27/03_19:02 | 1021.322 |  17.022 |            0.5 |                      27.0 |
| 27/03_19:04 | 1141.316 | 19.0219 |            0.5 |                      27.5 |
| 27/03_19:06 | 1261.325 | 21.0221 |            0.5 |                      28.0 |
| 27/03_19:08 | 1381.328 | 23.0221 |            0.0 |                      28.0 |
| 27/03_19:10 | 1501.327 | 25.0221 |            0.0 |                      28.0 |
| 27/03_19:12 | 1621.332 | 27.0222 |            0.0 |                      28.0 |
| 27/03_19:14 |  1741.33 | 29.0222 |            0.0 |                      28.0 |
| 27/03_19:15 | 1750.422 | 29.1737 |            0.0 |                      28.0 |
| 27/03_19:19 | 1990.416 | 33.1736 |            0.0 |                      28.0 |
| 27/03_19:21 | 2110.419 | 35.1736 |            0.0 |                      28.0 |
| 27/03_19:23 | 2230.428 | 37.1738 |            0.0 |                      28.0 |

[[../plots/BMPs/Acetate/methane_kinetics_acet_test_fw_s1_min.png]]

[[../plots/BMPs/Acetate/specific_methane_kinetics_acet_test_fw_s1.png]]

** Acetate Test 0
Το section αυτό αναφέρεται στη δοκιμή με 100 μL οξικό στο δείγμα (0).

*acet_test_0_s1*
#+NAME: acet_test_0_s1
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Sample 0 ###

  <<date_saving_acetate_s1>>

  inds = 34:58
  exp_meth_vol = [0, 4, 12, 7.5, 4.5, 2.5, 2.5, 4, 0.5, 2, 2, 1, 1, 1, 1, 1, 0.5, 0.5, 0, 0, 0, 0, 0, 0, 0]
  meth_vol_acet_0 = cumsum(exp_meth_vol)[end]
  exp_name = "acet_test_0_s1"
  source = "Acetate"
  sample = "Sample 0"
  sludge = "Sludge 1"
  input_vs = 1.55
  p0 = [40.0, 8.0, 1.0]

  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_acet_0 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [25.8, 5.0, 1.0]    
  <<sma_curve_fitting_min>>
  sma_acet_0 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: acet_test_0_s1
: "../data/exp_pro/acet_test_0_s1.csv"

#+NAME: acet_data_0_s1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<acet_test_0_s1()>> '(4))
#+END_SRC

#+CAPTION: Κινητικά δεδομένα
| Timestamp   |  Seconds | Minutes | Methane_Volume | Cumulative_Methane_Volume |
| 29/03_12:23 |      0.0 |     0.0 |            0.0 |                       0.0 |
| 29/03_12:23 |   13.967 |  0.2328 |            4.0 |                       4.0 |
| 29/03_12:24 |   73.986 |  1.2331 |           12.0 |                      16.0 |
| 29/03_12:25 |  133.981 |   2.233 |            7.5 |                      23.5 |
| 29/03_12:26 |  193.993 |  3.2332 |            4.5 |                      28.0 |
| 29/03_12:27 |  230.339 |   3.839 |            2.5 |                      30.5 |
| 29/03_12:28 |  290.327 |  4.8388 |            2.5 |                      33.0 |
| 29/03_12:29 |  350.322 |  5.8387 |            4.0 |                      37.0 |
| 29/03_12:29 |  363.719 |   6.062 |            0.5 |                      37.5 |
| 29/03_12:30 |  423.727 |  7.0621 |            2.0 |                      39.5 |
| 29/03_12:31 |  483.722 |   8.062 |            2.0 |                      41.5 |
| 29/03_12:32 |  509.669 |  8.4945 |            1.0 |                      42.5 |
| 29/03_12:33 |  569.668 |  9.4945 |            1.0 |                      43.5 |
| 29/03_12:34 |  629.657 | 10.4943 |            1.0 |                      44.5 |
| 29/03_12:35 |  689.661 | 11.4944 |            1.0 |                      45.5 |
| 29/03_12:36 |   749.66 | 12.4943 |            1.0 |                      46.5 |
| 29/03_12:37 |  809.683 | 13.4947 |            0.5 |                      47.0 |
| 29/03_12:38 |  869.926 | 14.4988 |            0.5 |                      47.5 |
| 29/03_12:38 |   910.87 | 15.1812 |            0.0 |                      47.5 |
| 29/03_12:39 |  970.864 | 16.1811 |            0.0 |                      47.5 |
| 29/03_12:40 | 1030.875 | 17.1812 |            0.0 |                      47.5 |
| 29/03_12:41 | 1090.872 | 18.1812 |            0.0 |                      47.5 |
| 29/03_12:42 | 1150.882 | 19.1814 |            0.0 |                      47.5 |
| 29/03_12:43 | 1205.994 | 20.0999 |            0.0 |                      47.5 |
| 29/03_12:44 | 1265.223 |  21.087 |            0.0 |                      47.5 |

[[../plots/BMPs/Acetate/methane_kinetics_acet_test_0_s1_min.png]]

[[../plots/BMPs/Acetate/specific_methane_kinetics_acet_test_0_s1.png]]

** Acetate Test 1
Το section αυτό αναφέρεται στη δοκιμή με 100 μL οξικό στο δείγμα (1). Aξίζει να αναφερθεί πως την πρώτη πειραματική ημέρα (27/03), παρήγαγε αέριο χωρίς να τροφοδοτηθεί με κάποιο υπόστρωμα. Η κινητική αυτής της παραγωγής (η οποία δεν ξέρουμε σε τι ευθύνεται) θα αναλυθεί παρακάτω. Βέβαια, μόλις τροφοδοτήθηκε με οξικό και η παραγωγή του τελείωσε, σταμάτησε και εκείνη η παραγωγή. Βέβαια, είχε την χαμηλότερη παραγωγή βιοαερίου μόλις τροφοδοτήθηκε με οξικό, οπότε ενδέχεται αυτή η μέτρηση να ήταν προβληματική.

*acet_test_1_s1*
#+NAME: acet_test_1_s1
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Sample 1 ###

  <<date_saving_acetate_s1>>

  inds = 38:58
  exp_meth_vol = [0, 6.5, 5, 3, 0.5, 1.5, 1.5, 0.5, 1, 0.5, 0.5, 0.3, 0.2, 0.2, 0.1, 0.05, 0.05, 0.05, 0.05, 0, 0]
  meth_vol_acet_1 = cumsum(exp_meth_vol)[end]
  exp_name = "acet_test_1_s1"
  source = "Acetate"
  sample = "Sample 1"
  sludge = "Sludge 1"
  input_vs = 1.55
  p0 = [20.0, 4.0, 1.0]

  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_acet_1 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [13.5, 3.5, 1.0]
  <<sma_curve_fitting_min>>
  sma_acet_1 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: acet_test_1_s1
: "../data/exp_pro/acet_test_1_s1.csv"

#+NAME: acet_data_1_s1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<acet_test_1_s1()>> '(4))
#+END_SRC

#+CAPTION: Κινητικά δεδομένα
| Timestamp   |  Seconds | Minutes | Methane_Volume | Cumulative_Methane_Volume |
|-------------+----------+---------+----------------+---------------------------|
| 29/03_12:26 |      0.0 |     0.0 |            0.0 |                       0.0 |
| 29/03_12:27 |   36.346 |  0.6058 |            6.5 |                       6.5 |
| 29/03_12:28 |   96.334 |  1.6056 |            5.0 |                      11.5 |
| 29/03_12:29 |  156.329 |  2.6055 |            3.0 |                      14.5 |
| 29/03_12:29 |  169.726 |  2.8288 |            0.5 |                      15.0 |
| 29/03_12:30 |  229.734 |  3.8289 |            1.5 |                      16.5 |
| 29/03_12:31 |  289.729 |  4.8288 |            1.5 |                      18.0 |
| 29/03_12:32 |  315.676 |  5.2613 |            0.5 |                      18.5 |
| 29/03_12:33 |  375.675 |  6.2613 |            1.0 |                      19.5 |
| 29/03_12:34 |  435.664 |  7.2611 |            0.5 |                      20.0 |
| 29/03_12:35 |  495.668 |  8.2611 |            0.5 |                      20.5 |
| 29/03_12:36 |  555.667 |  9.2611 |            0.3 |                      20.8 |
| 29/03_12:37 |   615.69 | 10.2615 |            0.2 |                      21.0 |
| 29/03_12:38 |  675.933 | 11.2656 |            0.2 |                      21.2 |
| 29/03_12:38 |  716.877 |  11.948 |            0.1 |                      21.3 |
| 29/03_12:39 |  776.871 | 12.9479 |           0.05 |                     21.35 |
| 29/03_12:40 |  836.882 |  13.948 |           0.05 |                      21.4 |
| 29/03_12:41 |  896.879 |  14.948 |           0.05 |                     21.45 |
| 29/03_12:42 |  956.889 | 15.9482 |           0.05 |                      21.5 |
| 29/03_12:43 | 1012.001 | 16.8667 |            0.0 |                      21.5 |
| 29/03_12:44 |  1071.23 | 17.8538 |            0.0 |                      21.5 |

[[../plots/BMPs/Acetate/methane_kinetics_acet_test_1_s1_min.png]]

[[../plots/BMPs/Acetate/specific_methane_kinetics_acet_test_1_s1.png]]

** Acetate Test 2
Το section αυτό αναφέρεται στη δοκιμή με 100 μL οξικό στο δείγμα (2).

*acet_test_2_s1*
#+NAME: acet_test_2_s1
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Sample 2 ###

  <<date_saving_acetate_s1>>

  inds = 44:58
  exp_meth_vol = [0, 4, 7, 5.5, 4.5, 2.5, 2, 1, 1, 1, 0.5, 0.5, 0.45, 0.05, 0]
  meth_vol_acet_2 = cumsum(exp_meth_vol)[end]
  exp_name = "acet_test_2_s1"
  source = "Acetate"
  sample = "Sample 2"
  sludge = "Sludge 1"
  input_vs = 1.55
  p0 = [30.0, 6.0, 1.0]

  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_acet_2 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_min>>
  sma_acet_2 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: acet_test_2_s1
: "../data/exp_pro/acet_test_2_s1.csv"

#+NAME: acet_data_2_s1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<acet_test_2_s1()>> '(4))
#+END_SRC

#+CAPTION: Κινητικά Δεδομένα
| Timestamp   | Seconds | Minutes | Methane_Volume | Cumulative_Methane_Volume |
|-------------+---------+---------+----------------+---------------------------|
| 29/03_12:31 |     0.0 |     0.0 |            0.0 |                       0.0 |
| 29/03_12:32 |  25.947 |  0.4324 |            4.0 |                       4.0 |
| 29/03_12:33 |  85.946 |  1.4324 |            7.0 |                      11.0 |
| 29/03_12:34 | 145.935 |  2.4322 |            5.5 |                      16.5 |
| 29/03_12:35 | 205.939 |  3.4323 |            4.5 |                      21.0 |
| 29/03_12:36 | 265.938 |  4.4323 |            2.5 |                      23.5 |
| 29/03_12:37 | 325.961 |  5.4327 |            2.0 |                      25.5 |
| 29/03_12:38 | 386.204 |  6.4367 |            1.0 |                      26.5 |
| 29/03_12:38 | 427.148 |  7.1191 |            1.0 |                      27.5 |
| 29/03_12:39 | 487.142 |   8.119 |            1.0 |                      28.5 |
| 29/03_12:40 | 547.153 |  9.1192 |            0.5 |                      29.0 |
| 29/03_12:41 |  607.15 | 10.1192 |            0.5 |                      29.5 |
| 29/03_12:42 |  667.16 | 11.1193 |           0.45 |                     29.95 |
| 29/03_12:43 | 722.272 | 12.0379 |           0.05 |                      30.0 |
| 29/03_12:44 | 781.501 |  13.025 |            0.0 |                      30.0 |

[[../plots/BMPs/Acetate/methane_kinetics_acet_test_2_s1_min.png]]

[[../plots/BMPs/Acetate/specific_methane_kinetics_acet_test_2_s1.png]]

** Acetate Test 4
Το section αυτό αναφέρεται στη δοκιμή με 100 μL οξικό στο δείγμα (4).

*acet_test_4_s1*
#+NAME: acet_test_4_s1
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Sample 4 ###

  <<date_saving_acetate_s1>>

  inds = 41:58
  exp_meth_vol = [0, 4, 10, 9, 4, 5, 5, 4, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0]
  meth_vol_acet_4 = cumsum(exp_meth_vol)[end]
  exp_name = "acet_test_4_s1"
  source = "Acetate"
  sample = "Sample 4"
  sludge = "Sludge 1"
  input_vs = 1.55
  p0 = [40.0, 10.0, 1.0]

  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_acet_4 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_min>>
  sma_acet_4 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: acet_test_4_s1
: "../data/exp_pro/acet_test_4_s1.csv"

#+NAME: acet_data_4_s1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<acet_test_4_s1()>> '(4))
#+END_SRC

#+CAPTION: Κινητικά δεδομένα
| Timestamp   | Seconds | Minutes | Methane_Volume | Cumulative_Methane_Volume |
|-------------+---------+---------+----------------+---------------------------|
| 29/03_12:29 |     0.0 |     0.0 |              0 |                       0.0 |
| 29/03_12:29 |  13.397 |  0.2233 |              4 |                       4.0 |
| 29/03_12:30 |  73.405 |  1.2234 |             10 |                      14.0 |
| 29/03_12:31 |   133.4 |  2.2233 |              9 |                      23.0 |
| 29/03_12:32 | 159.347 |  2.6558 |              4 |                      27.0 |
| 29/03_12:33 | 219.346 |  3.6558 |              5 |                      32.0 |
| 29/03_12:34 | 279.335 |  4.6556 |              5 |                      37.0 |
| 29/03_12:35 | 339.339 |  5.6556 |              4 |                      41.0 |
| 29/03_12:36 | 399.338 |  6.6556 |              3 |                      44.0 |
| 29/03_12:37 | 459.361 |   7.656 |              3 |                      47.0 |
| 29/03_12:38 | 519.604 |  8.6601 |              0 |                      47.0 |
| 29/03_12:38 | 560.548 |  9.3425 |              0 |                      47.0 |
| 29/03_12:39 | 620.542 | 10.3424 |              0 |                      47.0 |
| 29/03_12:40 | 680.553 | 11.3425 |              0 |                      47.0 |
| 29/03_12:41 |  740.55 | 12.3425 |              0 |                      47.0 |
| 29/03_12:42 |  800.56 | 13.3427 |              0 |                      47.0 |
| 29/03_12:43 | 855.672 | 14.2612 |              0 |                      47.0 |
| 29/03_12:44 | 914.901 | 15.2484 |              0 |                      47.0 |

[[../plots/BMPs/Acetate/methane_kinetics_acet_test_4_s1_min.png]]

[[../plots/BMPs/Acetate/specific_methane_kinetics_acet_test_4_s1.png]]

** Παραγωγή μεθανίου χωρίς feed από το δείγμα Ac
Όπως προαναφέρθηκε, το δείγμα Ac παρήγαγε μεθάνιο χωρίς να τροφοδοτηθεί με κάτι για κάποιον ανεξήγητο λόγο. Καθώς έχουμε πειραματικά δεδομένα για αυτή την κατανάλωση (και μάλιστα 2 data sets), θα γίνει και μία ανάλυση για αυτό.

*no_feed_ac_1*
#+NAME: no_feed_ac_1
#+BEGIN_SRC julia :noweb no-export

  ### No Feed Data Analysis ###

  <<date_saving_acetate_s1>>

  inds = 1:17
  exp_meth_vol = [0, 9, 3, 2, 3, 3, 3, 2.5, 2.5, 2.5, 1.5, 3, 1, 1, 1.5, 0.5, 0.1]
  exp_name = "no_feed_ac_1"
  source = "No_Feed"
  sample = "Sample Ac"
  sludge = "Sludge 1"
  kinetics = false

  <<bmp_data_processing>>
  <<bmp_data_plotting>>
#+END_SRC

#+RESULTS: no_feed_ac_1
#+begin_example
17×5 DataFrame
 Row │ Timestamp    Seconds  Minutes  Methane_Volume  Cumulative_Methane_Volum ⋯
     │ Any          Any      Any      Any             Any                      ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 27/03_18:45  0.0      0.0      0.0             0.0                      ⋯
   2 │ 27/03_18:46  61.304   1.02173  9.0             9.0
   3 │ 27/03_18:48  181.303  3.02172  3.0             12.0
   4 │ 27/03_18:50  301.313  5.02188  2.0             14.0
   5 │ 27/03_18:52  421.307  7.02178  3.0             17.0                     ⋯
   6 │ 27/03_18:54  541.305  9.02175  3.0             20.0
   7 │ 27/03_18:56  661.31   11.0218  3.0             23.0
   8 │ 27/03_18:58  781.308  13.0218  2.5             25.5
  ⋮  │      ⋮          ⋮        ⋮           ⋮                     ⋮            ⋱
  11 │ 27/03_19:04  1141.32  19.0219  1.5             32.0                     ⋯
  12 │ 27/03_19:06  1261.33  21.0221  3.0             35.0
  13 │ 27/03_19:08  1381.33  23.0221  1.0             36.0
  14 │ 27/03_19:10  1501.33  25.0221  1.0             37.0
  15 │ 27/03_19:12  1621.33  27.0222  1.5             38.5                     ⋯
  16 │ 27/03_19:14  1741.33  29.0222  0.5             39.0
  17 │ 27/03_19:15  1750.42  29.1737  0.1             39.1
                                                     1 column and 2 rows omitted
#+end_example

*no_feed_ac_2*
#+NAME: no_feed_ac_2
#+BEGIN_SRC julia :noweb no-export

  <<date_saving_acetate_s1>>

  inds = 18:33
  exp_meth_vol = [0, 3, 2, 2, 2, 3, 2, 2, 3, 2, 2.5, 2.5, 2, 2.5, 2.5, 2]
  exp_name = "no_feed_ac_2"
  source = "No_Feed"
  sample = "Sample Ac"
  sludge = "Sludge 1"
  kinetics = false

  <<bmp_data_processing>>
  <<bmp_data_plotting>>
#+END_SRC

#+RESULTS: no_feed_ac_2
#+begin_example
16×5 DataFrame
 Row │ Timestamp    Seconds  Minutes  Methane_Volume  Cumulative_Methane_Volum ⋯
     │ Any          Any      Any      Any             Any                      ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 27/03_19:19  0.0      0.0      0.0             0.0                      ⋯
   2 │ 27/03_19:21  120.003  2.00005  3.0             3.0
   3 │ 27/03_19:23  240.012  4.0002   2.0             5.0
   4 │ 27/03_19:25  360.017  6.00028  2.0             7.0
   5 │ 27/03_19:27  480.028  8.00047  2.0             9.0                      ⋯
   6 │ 27/03_19:29  600.03   10.0005  3.0             12.0
   7 │ 27/03_19:31  720.028  12.0005  2.0             14.0
   8 │ 27/03_19:33  840.024  14.0004  2.0             16.0
   9 │ 27/03_19:35  960.032  16.0005  3.0             19.0                     ⋯
  10 │ 27/03_19:37  1080.03  18.0004  2.0             21.0
  11 │ 27/03_19:39  1200.02  20.0004  2.5             23.5
  12 │ 27/03_19:41  1320.03  22.0006  2.5             26.0
  13 │ 27/03_19:43  1440.03  24.0004  2.0             28.0                     ⋯
  14 │ 27/03_19:45  1560.03  26.0004  2.5             30.5
  15 │ 27/03_19:47  1680.03  28.0005  2.5             33.0
  16 │ 27/03_19:48  1784.32  29.7386  2.0             35.0
                                                                1 column omitted
#+end_example

** Update all helper
Σε αυτό το section θα υπάρχει ένα helper code block που θα κάνει evaluate όλα τα παραπάνω. Έτσι, αν αλλάξει κάτι το οποίο επηρεάζει περισσότερα από ένα code blocks, θα μπορούν να γίνουν updated ταυτόχρονα πιο εύκολα. Επίσης, μία επιπλέον χρησιμότητα του code block αυτού είναι ότι αποθηκεύει ένα CSV που συγκεντρώνει όλα τα δεδομένα των κινητικών παραμέτρων από την προσαρμογή που έγινε παραπάνω, το οποίο είναι χρήσιμο για συγκρίσεις, παρόλο που τα συγκεκριμένα πειράματα δεν είναι τόσο σημαντικό να συγκριθούν.
*update_acetate_tests_s1*
#+NAME: update_acetate_tests_s1
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_acetate_analysis.jl

  <<acet_test_0_s1>>
  <<acet_test_1_s1>>
  <<acet_test_2_s1>>
  <<acet_test_4_s1>>
  <<acet_test_fw_s1>>
  <<no_feed_ac_1>>
  <<no_feed_ac_2>>

  model_fit_table = Tables.table(vcat(reshape(model_acet_0, 1, 5), reshape(model_acet_1, 1, 5), reshape(model_acet_2, 1, 5), reshape(model_acet_4, 1, 5), reshape(model_acet_fw, 1, 5)), header = [:Sample_Name, :Production_Potential, :Production_Rate, :Lag_Time, :R_squared])
  CSV.write(datadir("exp_pro", "methane_from_acetate_kinetics_s1.csv"), model_fit_table)

  return("../data/exp_pro/methane_from_acetate_kinetics_s1.csv")
#+END_SRC

#+RESULTS: update_acetate_tests_s1
: "../data/exp_pro/methane_from_acetate_kinetics_s1.csv"

#+NAME: acet_kinetic_data_s1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<update_acetate_tests_s1()>> '(4))
#+END_SRC

#+CAPTION: Kinetic Models
| Sample_Name | Production_Potential | Production_Rate | Lag_Time | R_squared |
| Sample 0    |               46.633 |           7.664 |      0.0 |     0.971 |
| Sample 1    |                20.94 |           5.448 |      0.0 |      0.96 |
| Sample 2    |               29.389 |           6.234 |      0.0 |      0.99 |
| Sample 4    |               47.228 |            9.65 |      0.0 |     0.994 |
| Sample FW   |               27.014 |           4.901 |      0.0 |       0.9 |

#+NAME: sma_acet_s1
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_acetate_analysis.jl

  <<acet_test_0_s1>>
  <<acet_test_1_s1>>
  <<acet_test_2_s1>>
  <<acet_test_4_s1>>
  <<acet_test_fw_s1>>

  sma_table = Tables.table(vcat(reshape(sma_acet_0, 1, 5), reshape(sma_acet_1, 1, 5), reshape(sma_acet_2, 1, 5), reshape(sma_acet_4, 1, 5), reshape(sma_acet_fw, 1, 5)), header = [:Sample_Name, :Methane_Potential, :SMA, :Lag_Time, :R_sq])
  CSV.write(datadir("exp_pro", "sma_from_acetate_s1.csv"), sma_table)

  return("../data/exp_pro/sma_from_acetate_s1.csv")
#+END_SRC

#+RESULTS: sma_acet_s1
: "../data/exp_pro/sma_from_acetate_s1.csv"

#+NAME: acet_sma_data_s1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<sma_acet_s1()>> '(4))
#+END_SRC

| Sample_Name | Methane_Potential |   SMA | Lag_Time |  R_sq |
| Sample 0    |            30.086 | 4.944 |      0.0 | 0.971 |
| Sample 1    |             13.51 | 3.515 |      0.0 |  0.96 |
| Sample 2    |            18.991 | 3.942 |      0.0 | 0.988 |
| Sample 4    |            30.469 | 6.226 |      0.0 | 0.994 |
| Sample FW   |            17.428 | 3.163 |      0.0 |   0.9 |

** Γενικά σχόλια για αυτόν τον κύκλο πειραμάτων
Ο πρώτος αυτός κύκλος πειραμάτων ήταν για την δοκιμή προσθήκης οξικού οξέος, του ιδανικού υποστρώματος της μεθανογένεσης, για να δούμε πως θα αντιδράσει σε αυτό το σύστημα. Δεν έχει τόσο συγκριτικό χαρακτήρα μεταξύ των πειραμάτων (παρόλο που ένα σχόλιο που μπορεί να γίνει είναι πως τα πειράματα τα οποία ήταν ίδια πρακτικά στην αρχή, είχαν αρκετά διαφορετική απόκριση στην προσθήκη οξικού), αλλά τον χαρακτήρα της βέλτιστης δυνατής μεθανογένεσης από κάποιο υπόστρωμα. Από την μελέτη αυτή, προέκυψαν αρκετά συμπεράσματα.

Ένα ενδιαφέρον σχόλιο είναι πως το σύστημα ανταποκρίνεται στην προσθήκη του οξικού πολύ γρήγορα (μετά από μερικά δευτερόλεπτα κιόλας βλέπουμε παραγωγή μεθανίου) και στο μοντέλο αυτό μεταφράζεται ως μηδενικό lag-phase.

Το δείγμα 4 είχε αναπάντεχα υψηλό ρυθμό παραγωγής μεθανίου, το οποίο φάνηκε από το γεγονός ότι παράχθηκε την μέγιστη ποσότητα οξικού που περιμέναμε σε περίπου 7 λεπτά ενώ τα υπόλοιπα χρειάστηκαν τουλάχιστον 15 λεπτά. Αυτό φάνηκε και στο μοντέλο, όπου το δείγμα αυτό είχε πολύ υψηλό ειδικό ρυθμό παραγωγής μεθανίου. Το δείγμα Ac ήταν αυτό που παρήγαγε αέριο χωρίς κάποιο υπόστρωμα. Μόλις προστέθηκε οξικό, αντέδρασε σε αυτό και ο ρυθμός του αυξήθηκε, αλλά επιβράδυνε πολύ γρήγορα, με αποτέλεσμα να έχει πολύ αργό ρυθμό παραγωγής μεθανίο και το χαμηλότερο δυναμικό παραγωγής μεθανίου. Μπορεί η αλλαγή αυτή να ευθύνεται σε αυτήν την απόκριση. Τα δείγματα 0 και 4 είχαν πολύ μεγαλύτερη παραγωγικότητα από τα άλλα 3, χωρίς να υπάρχει κάποια εύκολη εξήγηση για αυτό.

\pagebreak

* FW Hydrolysate S1_R1 Processing
Στο section αυτό θα αναλυθούν τα αποτελεσματα του πρώτου πειράματος που χρησιμοποιήσε FW hydrolysate ως υπόστρωμα (συμβολίζεται ως S1_R1 επειδή είναι το πρώτο run με την πρώτη λάσπη). Σκοπός είναι να γίνει μία σύγκριση αυτού με το οξικό για κάθε δοχείο για να προκύψουν αποτελέσματα για το κάθε πείραμα. Οι 5 δοκιμές που έγιναν ήταν στα δείγματα 0, 1, 2 και 4 (τα οποία πλέον έχουν νόημα επειδή εκφράζουν την ποσότητα mix που προστέθηκε κατά την υδρόλυση) αλλά επίσης έγινε και ένα πείραμα για να μετρηθεί η απόδοση σε μεθάνιο του δείγματος μόνο με FW.

Αξίζει να αναφερθεί πως παρατηρήθηκε μία απότομη μεταβολή της στάθμης του αερίου στην αρχή κάθε πειράματος εκτός από το FW. Αυτή αγνοήθηκε καθώς υποτέθηκε πως έγινε λόγω διαφοράς πίεσης κατά την διαδικασία της τροφοδοσίας. Αυτό μπορεί να οδηγεί σε κάποιο σφάλμα, αλλά αν δεν αγνοηθεί οδηγεί σε πολύ προβληματικά αποτελέσματα.

** Sample 0
Το δείγμα αυτό είναι labelled ως δείγμα 0 καθώς είναι το δείγμα το οποίο τροφοδοτήθηκε με treated FW, όμως χωρίς προσθήκη του μιξ ενζύμων και μικροοργανισμών. Όπως έχουμε δεί, όλες οι αντιδράσεις που γίνονται κατά την υδρόλυση και ζύμωση μπορούν να γίνουν και χωρίς το μιξ. Όμως, γινόντουσαν πιο αποτελεσματικά με την προσθήκη αυτού. Οπότε, ελπίζουμε πως το δείγμα αυτό θα έχει χειρότερα αποτελέσματα από τα άλλα, το οποίο θα μας οδηγήσει στην υπόθεση ότι το μιξ βελτιώνει όχι μόνο τα κριτήρια υδρόλυσης και οξεογένεσης αλλά και αυτό της μεθανογένεσης.

*hydrolysate_0_s1_r1*
#+NAME: hydrolysate_0_s1_r1
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Hydrolysate with 0 ml ###

  <<date_saving_fw_s1_r1>>

  inds = 2:49
  exp_meth_vol = [0, 0.2, 0.02, 0.02, 0.01, 0.2, 0.2, 0.5, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.1, 0.1, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.05, 0.05, 0.05, 0, 0, 0, 0, 0, 0]
  meth_vol_hydro_0 = cumsum(exp_meth_vol)[end]

  exp_name = "hydrolysate_0_s1_r1"
  source = "Hydrolyzed FW"
  sample = "Sample 0"
  sludge = "Sludge 1"
  run_num = "Run 1"
  input_vs = 1.55

  <<bmp_data_processing>>

  # The same model is fit either with min or hour
  p0 = [6.0, 0.01, 1.0]
  <<bmp_curve_fitting_min>>
  model_hydro_0_min = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [6.0, 0.2, 1.0]
  <<bmp_curve_fitting_hour>>
  model_hydro_0_hour = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [6.0, 10.0, 1.0]
  <<sma_curve_fitting_hour>>
  sma_hydro_0 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: hydrolysate_0_s1_r1
: "../data/exp_pro/hydrolysate_0_s1_r1.csv"

*** Results
Παρακάτω φαίνονται τα αποτελέσματα του σχετικού πειράματος.

#+NAME: hydrolysate_data_0_s1_r1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<hydrolysate_0_s1_r1()>> '(4))
#+END_SRC

| Timestamp   |   Minutes |   Hours | Methane_Volume | Cumulative_Methane_Volume |
| 01/04_11:09 |       0.0 |     0.0 |            0.0 |                       0.0 |
| 01/04_11:11 |    2.0003 |  0.0333 |            0.2 |                       0.2 |
| 01/04_11:12 |    3.0004 |    0.05 |           0.02 |                      0.22 |
| 01/04_11:13 |     3.829 |  0.0638 |           0.02 |                      0.24 |
| 01/04_11:14 |    4.8289 |  0.0805 |           0.01 |                      0.25 |
| 01/04_11:15 |    5.8291 |  0.0972 |            0.2 |                      0.45 |
| 01/04_11:21 |   12.2677 |  0.2045 |            0.2 |                      0.65 |
| 01/04_11:52 |   42.5938 |  0.7099 |            0.5 |                      1.15 |
| 01/04_12:22 |   72.5938 |  1.2099 |            0.2 |                      1.35 |
| 01/04_13:52 |   162.594 |  2.7099 |            0.2 |                      1.55 |
| 01/04_15:52 |  282.5941 |  4.7099 |            0.2 |                      1.75 |
| 01/04_16:52 |  342.5944 |  5.7099 |            0.2 |                      1.95 |
| 01/04_18:52 |  462.5925 |  7.7099 |            0.2 |                      2.15 |
| 01/04_20:52 |  582.5924 |  9.7099 |            0.2 |                      2.35 |
| 01/04_22:52 |  702.5958 | 11.7099 |            0.2 |                      2.55 |
| 02/04_00:52 |  822.6108 | 13.7102 |            0.2 |                      2.75 |
| 02/04_02:52 |  942.6075 | 15.7101 |            0.2 |                      2.95 |
| 02/04_04:52 |  1062.607 | 17.7101 |            0.1 |                      3.05 |
| 02/04_06:52 | 1182.6302 | 19.7105 |            0.1 |                      3.15 |
| 02/04_08:52 | 1302.5852 | 21.7098 |            0.1 |                      3.25 |
| 02/04_10:54 | 1424.4052 | 23.7401 |           0.05 |                       3.3 |
| 02/04_12:54 | 1544.4126 | 25.7402 |           0.05 |                      3.35 |
| 02/04_13:24 | 1574.4125 | 26.2402 |           0.05 |                       3.4 |
| 02/04_13:54 | 1604.4127 | 26.7402 |           0.05 |                      3.45 |
| 02/04_14:24 | 1634.4127 | 27.2402 |           0.05 |                       3.5 |
| 02/04_14:54 | 1664.4126 | 27.7402 |           0.05 |                      3.55 |
| 02/04_15:24 | 1694.4125 | 28.2402 |            0.1 |                      3.65 |
| 02/04_15:54 | 1724.4125 | 28.7402 |            0.1 |                      3.75 |
| 02/04_16:24 | 1754.4128 | 29.2402 |            0.1 |                      3.85 |
| 02/04_16:54 | 1784.4128 | 29.7402 |            0.1 |                      3.95 |
| 02/04_17:24 | 1814.4125 | 30.2402 |            0.1 |                      4.05 |
| 02/04_17:54 | 1844.4193 | 30.7403 |            0.1 |                      4.15 |
| 02/04_19:54 | 1964.4198 | 32.7403 |            0.1 |                      4.25 |
| 02/04_21:54 | 2084.4214 | 34.7404 |            0.1 |                      4.35 |
| 02/04_23:54 | 2204.4256 | 36.7404 |            0.1 |                      4.45 |
| 03/04_01:54 | 2324.4257 | 38.7404 |            0.1 |                      4.55 |
| 03/04_03:54 | 2444.4255 | 40.7404 |            0.1 |                      4.65 |
| 03/04_05:54 | 2564.4305 | 42.7405 |            0.1 |                      4.75 |
| 03/04_07:54 | 2684.4324 | 44.7405 |            0.1 |                      4.85 |
| 03/04_09:54 | 2804.4325 | 46.7405 |           0.05 |                       4.9 |
| 03/04_12:54 | 2984.4414 | 49.7407 |           0.05 |                      4.95 |
| 03/04_13:54 | 3044.4412 | 50.7407 |           0.05 |                       5.0 |
| 03/04_14:24 | 3074.4422 | 51.2407 |            0.0 |                       5.0 |
| 03/04_14:54 | 3105.2008 | 51.7533 |            0.0 |                       5.0 |
| 03/04_15:26 | 3137.2466 | 52.2874 |            0.0 |                       5.0 |
| 03/04_16:29 | 3199.5175 | 53.3253 |            0.0 |                       5.0 |
| 03/04_17:29 |  3259.522 | 54.3254 |            0.0 |                       5.0 |
| 03/04_18:29 |  3319.522 | 55.3254 |            0.0 |                       5.0 |

[[../plots/BMPs/Hydrolyzed FW/methane_kinetics_hydrolysate_0_s1_r1_hour.png]]

[[../plots/BMPs/Hydrolyzed FW/specific_methane_kinetics_hydrolysate_0_s1_r1_hour.png]]

** Sample 1
Το δείγμα αυτό τροφοδοτήθηκε με το υδρόλυμα το οποίο είχε προσθήκη 1 ml mix. Στο αρχικό κινητικό πείραμα, το δείγμα αυτό είχε αρκετά παρόμοια συμπεριφορά με το 0 και χειρότερη αυτής του 1. Από την μέτρηση του COD του, είχε αναπάντεχα υψηλό sCOD. Αυτό σημαίνει είτε πως έγινε κάποιο λάθος στην ανάλυση ή ότι απλώς έγινε πολύ καλύτερη υδρόλυση από ότι περιμέναμε στο πείραμα αυτό. Με βάση το sCOD του, αναμένεται να έχει καλά αποτελέσματα. Με βάση την HPLC του αρχικού πειράματος, θα περιμέναμε να είναι λίγο καλύτερο από το 0.

*hydrolysate_1_s1_r1*
#+NAME: hydrolysate_1_s1_r1
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Hydrolysate with 1 ml ###

  <<date_saving_fw_s1_r1>>

  inds = 3:49
  exp_meth_vol = [0, 0.5, 0.5, 0.5, 0.5, 0.5, 0, 0.2, 0.2, 0.2, 0.2, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.3, 0.3, 0.3, 0.1, 0.5, 0.5, 0.5, 0.5, 0.5, 0.4, 0.6, 0.1, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.3, 0.2, 0.2, 0, 0, 0, 0, 0, 0]
  meth_vol_hydro_1 = cumsum(exp_meth_vol)[end]
  exp_name = "hydrolysate_1_s1_r1"
  source = "Hydrolyzed FW"
  sample = "Sample 1"
  sludge = "Sludge 1"
  run_num = "Run 1"
  input_vs = 1.55

  p0 = [13.0, 0.1, 1.0]
  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_hydro_1_min = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [13.0, 1.0, 1.0]
  <<bmp_curve_fitting_hour>>
  model_hydro_1_hour = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_hour>>
  sma_hydro_1 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: hydrolysate_1_s1_r1
: "../data/exp_pro/hydrolysate_1_s1_r1.csv"

*** Results
Το πείραμα αυτό παρήγαγε 10.95 ml μεθάνιο, το οποίο είναι το \( 50.93 \% \) του πειράματος με οξικό καθώς εκείνο το πείραμα είχε μία σχετικά χαμηλή παραγωγικότητα για οξικό.

Από άποψη προσαρμογής, το πείραμα αυτό έχει το πρόβλημα πως η παραγωγή μεθανίου φαίνεται να πηγαίνει με "σκαλοπατάκια". Για κάποια διαστήματα πηγαίνει πολύ γρήγορα, ενώ μετά πηγαίνει αργά. Αυτό συμβαίνει μερικές ώρες μετά την έναρξη, ξαναεπιταχύνει λίγο μετά το 24ωρο και λίγο πριν το τέλος της χώνευσης (στις 49 ώρες), ξαναεπιταχύνει για λίγο. Οπότε, η προσαρμογή του είναι αρκετά δύσκολη.

Με την διόρθωση των δεδομένων σταματάει να υπάρχει το φαινόμενο των 2 ρυθμών (ενός γρήγορου για τα δείγματα της 1ης μέρας και ενός αργού για μετά), αλλά η προσαρμογή ακόμη δεν είναι τέλεια (παρότι είναι πλέον αρκετά καλή)

#+NAME: hydrolysate_data_1_s1_r1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<hydrolysate_1_s1_r1()>> '(4))
#+END_SRC

| Timestamp   |   Minutes |   Hours | Methane_Volume | Cumulative_Methane_Volume |
| 01/04_11:11 |       0.0 |     0.0 |            0.0 |                       0.0 |
| 01/04_11:12 |    1.0002 |  0.0167 |            0.5 |                       0.5 |
| 01/04_11:13 |    1.8288 |  0.0305 |            0.5 |                       1.0 |
| 01/04_11:14 |    2.8286 |  0.0471 |            0.5 |                       1.5 |
| 01/04_11:15 |    3.8288 |  0.0638 |            0.5 |                       2.0 |
| 01/04_11:21 |   10.2674 |  0.1711 |            0.5 |                       2.5 |
| 01/04_11:52 |   40.5936 |  0.6766 |            0.0 |                       2.5 |
| 01/04_12:22 |   70.5935 |  1.1766 |            0.2 |                       2.7 |
| 01/04_13:52 |  160.5938 |  2.6766 |            0.2 |                       2.9 |
| 01/04_15:52 |  280.5938 |  4.6766 |            0.2 |                       3.1 |
| 01/04_16:52 |  340.5941 |  5.6766 |            0.2 |                       3.3 |
| 01/04_18:52 |  460.5922 |  7.6765 |           0.25 |                      3.55 |
| 01/04_20:52 |  580.5921 |  9.6765 |           0.25 |                       3.8 |
| 01/04_22:52 |  700.5956 | 11.6766 |           0.25 |                      4.05 |
| 02/04_00:52 |  820.6106 | 13.6768 |           0.25 |                       4.3 |
| 02/04_02:52 |  940.6072 | 15.6768 |           0.25 |                      4.55 |
| 02/04_04:52 | 1060.6068 | 17.6768 |           0.25 |                       4.8 |
| 02/04_06:52 | 1180.6299 | 19.6772 |           0.25 |                      5.05 |
| 02/04_08:52 |  1300.585 | 21.6764 |           0.25 |                       5.3 |
| 02/04_10:54 | 1422.4049 | 23.7067 |            0.3 |                       5.6 |
| 02/04_12:54 | 1542.4123 | 25.7069 |            0.3 |                       5.9 |
| 02/04_13:24 | 1572.4122 | 26.2069 |            0.3 |                       6.2 |
| 02/04_13:54 | 1602.4124 | 26.7069 |            0.1 |                       6.3 |
| 02/04_14:24 | 1632.4124 | 27.2069 |            0.5 |                       6.8 |
| 02/04_14:54 | 1662.4124 | 27.7069 |            0.5 |                       7.3 |
| 02/04_15:24 | 1692.4122 | 28.2069 |            0.5 |                       7.8 |
| 02/04_15:54 | 1722.4122 | 28.7069 |            0.5 |                       8.3 |
| 02/04_16:24 | 1752.4125 | 29.2069 |            0.5 |                       8.8 |
| 02/04_16:54 | 1782.4125 | 29.7069 |            0.4 |                       9.2 |
| 02/04_17:24 | 1812.4122 | 30.2069 |            0.6 |                       9.8 |
| 02/04_17:54 |  1842.419 |  30.707 |            0.1 |                       9.9 |
| 02/04_19:54 | 1962.4195 |  32.707 |           0.05 |                      9.95 |
| 02/04_21:54 | 2082.4211 |  34.707 |           0.05 |                      10.0 |
| 02/04_23:54 | 2202.4254 | 36.7071 |           0.05 |                     10.05 |
| 03/04_01:54 | 2322.4254 | 38.7071 |           0.05 |                      10.1 |
| 03/04_03:54 | 2442.4252 | 40.7071 |           0.05 |                     10.15 |
| 03/04_05:54 | 2562.4302 | 42.7072 |           0.05 |                      10.2 |
| 03/04_07:54 | 2682.4321 | 44.7072 |           0.05 |                     10.25 |
| 03/04_09:54 | 2802.4322 | 46.7072 |            0.3 |                     10.55 |
| 03/04_12:54 | 2982.4411 | 49.7074 |            0.2 |                     10.75 |
| 03/04_13:54 | 3042.4409 | 50.7073 |            0.2 |                     10.95 |
| 03/04_14:24 | 3072.4419 | 51.2074 |            0.0 |                     10.95 |
| 03/04_14:54 | 3103.2005 |   51.72 |            0.0 |                     10.95 |
| 03/04_15:26 | 3135.2464 | 52.2541 |            0.0 |                     10.95 |
| 03/04_16:29 | 3197.5173 |  53.292 |            0.0 |                     10.95 |
| 03/04_17:29 | 3257.5217 |  54.292 |            0.0 |                     10.95 |
| 03/04_18:29 | 3317.5217 |  55.292 |            0.0 |                     10.95 |

[[../plots/BMPs/Hydrolyzed FW/methane_kinetics_hydrolysate_1_s1_r1_hour.png]]

[[../plots/BMPs/Hydrolyzed FW/specific_methane_kinetics_hydrolysate_1_s1_r1_hour.png]]

** Sample 2
Το δείγμα το οποίο στην υδρόλυση είχε 2 ml από το μιξ. Με βάση το αρχικό πείραμα υδρόλυσης, αυτό και το 4 ml είχαν το καλύτερο performance και ελάχιστη διαφορά μεταξύ τους (κατά βάση στην συγκέντρωση γαλακτικού οξέος) οπότε θα αναμέναμε εδώ να παρατηρηθεί η καλύτερη μεθανογένεση.

*hydrolysate_2_s1_r1*
#+NAME: hydrolysate_2_s1_r1
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Hydrolysate with 2 ml ###

  <<date_saving_fw_s1_r1>>

  inds = 8:49
  exp_meth_vol = [0, 0.5, 0.1, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2, 0.2, 0, 0, 0, 0, 0, 0]
  meth_vol_hydro_2 = cumsum(exp_meth_vol)[end]
  exp_name = "hydrolysate_2_s1_r1"
  source = "Hydrolyzed FW"
  sample = "Sample 2"
  sludge = "Sludge 1"
  run_num = "Run 1"
  input_vs = 1.55

  <<bmp_data_processing>>

  p0 = [10.0, 0.01, 1.0]
  <<bmp_curve_fitting_min>>
  model_hydro_2_min = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [10.0, 0.2, 0.03]
  <<bmp_curve_fitting_hour>>
  model_hydro_2_hour = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_hour>>
  sma_hydro_2 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: hydrolysate_2_s1_r1
: "../data/exp_pro/hydrolysate_2_s1_r1.csv"

*** Results
Το παραγώμενο μεθάνιο είναι 5.1 ml, δηλαδή \( 17 \% \) του προβλεπόμενου μεθανίου με βάση το οξικό.

**** Διορθωμένα αποτελέσματα
Διορθώνοντας το μεγάλο κενό που υπήρξε στο τέλος της 01/04 και αφαιρόντας τα 6 ml που παράγονται το πρώτο λεπτό, το μοντελό αυτό διορθώνεται σε πολύ μεγάλο βαθμό. Το R^2 είναι πλέον 0.98 και φαίνεται πως η προσαρμογή είναι καλή.

#+NAME: hydrolysate_data_2_s1_r1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<hydrolysate_2_s1_r1()>> '(4))
#+END_SRC

| Timestamp   |   Minutes |   Hours | Methane_Volume | Cumulative_Methane_Volume |
| 01/04_11:21 |       0.0 |     0.0 |            0.0 |                       0.0 |
| 01/04_11:52 |   30.3261 |  0.5054 |            0.5 |                       0.5 |
| 01/04_12:22 |   60.3261 |  1.0054 |            0.1 |                       0.6 |
| 01/04_13:52 |  150.3263 |  2.5054 |            0.3 |                       0.9 |
| 01/04_15:52 |  270.3264 |  4.5054 |            0.3 |                       1.2 |
| 01/04_16:52 |  330.3267 |  5.5054 |            0.3 |                       1.5 |
| 01/04_18:52 |  450.3248 |  7.5054 |            0.3 |                       1.8 |
| 01/04_20:52 |  570.3247 |  9.5054 |            0.3 |                       2.1 |
| 01/04_22:52 |  690.3281 | 11.5055 |            0.3 |                       2.4 |
| 02/04_00:52 |  810.3431 | 13.5057 |            0.3 |                       2.7 |
| 02/04_02:52 |  930.3398 | 15.5057 |            0.3 |                       3.0 |
| 02/04_04:52 | 1050.3393 | 17.5057 |            0.3 |                       3.3 |
| 02/04_06:52 | 1170.3624 |  19.506 |            0.2 |                       3.5 |
| 02/04_08:52 | 1290.3175 | 21.5053 |            0.2 |                       3.7 |
| 02/04_10:54 | 1412.1374 | 23.5356 |            0.2 |                       3.9 |
| 02/04_12:54 | 1532.1448 | 25.5357 |            0.2 |                       4.1 |
| 02/04_13:24 | 1562.1448 | 26.0357 |            0.2 |                       4.3 |
| 02/04_13:54 |  1592.145 | 26.5357 |            0.2 |                       4.5 |
| 02/04_14:24 |  1622.145 | 27.0358 |            0.2 |                       4.7 |
| 02/04_14:54 | 1652.1449 | 27.5357 |            0.2 |                       4.9 |
| 02/04_15:24 | 1682.1448 | 28.0357 |            0.2 |                       5.1 |
| 02/04_15:54 | 1712.1448 | 28.5357 |            0.2 |                       5.3 |
| 02/04_16:24 |  1742.145 | 29.0358 |            0.1 |                       5.4 |
| 02/04_16:54 |  1772.145 | 29.5358 |            0.1 |                       5.5 |
| 02/04_17:24 | 1802.1448 | 30.0357 |            0.1 |                       5.6 |
| 02/04_17:54 | 1832.1516 | 30.5359 |            0.1 |                       5.7 |
| 02/04_19:54 | 1952.1521 | 32.5359 |            0.1 |                       5.8 |
| 02/04_21:54 | 2072.1537 | 34.5359 |            0.1 |                       5.9 |
| 02/04_23:54 | 2192.1579 |  36.536 |            0.1 |                       6.0 |
| 03/04_01:54 |  2312.158 |  38.536 |            0.1 |                       6.1 |
| 03/04_03:54 | 2432.1578 |  40.536 |            0.1 |                       6.2 |
| 03/04_05:54 | 2552.1628 |  42.536 |            0.1 |                       6.3 |
| 03/04_07:54 | 2672.1647 | 44.5361 |            0.1 |                       6.4 |
| 03/04_09:54 | 2792.1648 | 46.5361 |            0.1 |                       6.5 |
| 03/04_12:54 | 2972.1736 | 49.5362 |            0.2 |                       6.7 |
| 03/04_13:54 | 3032.1734 | 50.5362 |            0.2 |                       6.9 |
| 03/04_14:24 | 3062.1744 | 51.0362 |            0.0 |                       6.9 |
| 03/04_14:54 | 3092.9331 | 51.5489 |            0.0 |                       6.9 |
| 03/04_15:26 | 3124.9789 |  52.083 |            0.0 |                       6.9 |
| 03/04_16:29 | 3187.2498 | 53.1208 |            0.0 |                       6.9 |
| 03/04_17:29 | 3247.2543 | 54.1209 |            0.0 |                       6.9 |
| 03/04_18:29 | 3307.2542 | 55.1209 |            0.0 |                       6.9 |


[[../plots/BMPs/Hydrolyzed FW/methane_kinetics_hydrolysate_2_s1_r1_hour.png]]

[[../plots/BMPs/Hydrolyzed FW/specific_methane_kinetics_hydrolysate_2_s1_r1_hour.png]]

** Sample 4
Το δείγμα 4 ήταν αυτό με τα 4 ml mix στην υδρόλυση. Είναι η μέγιστη ποσότητα που χρησιμοποιήθηκε για τα πειράματα χώνευσης καθώς το 8 ml δεν είχε ιδιαίτερα μεγάλη διαφορά και είναι πολύ πιο ακριβό. Όπως προαναφέρθηκε, αναμένουμε να έχει παρόμοια ποιότητα με το 2 ml καθώς με εξαίρεση μίας ποσότητας γαλακτικού είναι σχεδόν ίδια.

*hydrolysate_4_s1_r1*
#+NAME: hydrolysate_4_s1_r1
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Hydrolysate with 4 ml ###

  <<date_saving_fw_s1_r1>>

  inds = 6:49
  exp_meth_vol = [0, 0.1, 0.3, 0.2, 0.3, 0.3, 0.3, 0.3, 0.3, 0.2, 0.2, 0.2, 0.2, 0.1, 0.2, 0.2, 0.4, 0.3, 0.3, 0.3, 0.2, 0.1, 0.0, 0.0, 0.0, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.2, 0.3, 0.2, 0.1, 0, 0, 0, 0, 0, 0]
  meth_vol_hydro_4 = cumsum(exp_meth_vol)[end]
  exp_name = "hydrolysate_4_s1_r1"
  source = "Hydrolyzed FW"
  sample = "Sample 4"
  sludge = "Sludge 1"
  run_num = "Run 1"

  input_vs = 1.55

  <<bmp_data_processing>>

  p0 = [17.0, 0.01, 1.0]
  <<bmp_curve_fitting_min>>
  model_hydro_4_min = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [17.0, 0.8, 0.1]
  <<bmp_curve_fitting_hour>>
  model_hydro_4_hour = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_hour>>
  sma_hydro_4 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: hydrolysate_4_s1_r1
: "../data/exp_pro/hydrolysate_4_s1_r1.csv"

*** Results

#+NAME: hydrolysate_data_4_s1_r1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<hydrolysate_4_s1_r1()>> '(4))
#+END_SRC

| Timestamp   |   Minutes |   Hours | Methane_Volume | Cumulative_Methane_Volume |
| 01/04_11:14 |       0.0 |     0.0 |            0.0 |                       0.0 |
| 01/04_11:15 |    1.0002 |  0.0167 |            0.1 |                       0.1 |
| 01/04_11:21 |    7.4388 |   0.124 |            0.3 |                       0.4 |
| 01/04_11:52 |   37.7649 |  0.6294 |            0.2 |                       0.6 |
| 01/04_12:22 |   67.7649 |  1.1294 |            0.3 |                       0.9 |
| 01/04_13:52 |  157.7651 |  2.6294 |            0.3 |                       1.2 |
| 01/04_15:52 |  277.7652 |  4.6294 |            0.3 |                       1.5 |
| 01/04_16:52 |  337.7655 |  5.6294 |            0.3 |                       1.8 |
| 01/04_18:52 |  457.7636 |  7.6294 |            0.3 |                       2.1 |
| 01/04_20:52 |  577.7635 |  9.6294 |            0.2 |                       2.3 |
| 01/04_22:52 |  697.7669 | 11.6294 |            0.2 |                       2.5 |
| 02/04_00:52 |  817.7819 | 13.6297 |            0.2 |                       2.7 |
| 02/04_02:52 |  937.7786 | 15.6296 |            0.2 |                       2.9 |
| 02/04_04:52 | 1057.7781 | 17.6296 |            0.1 |                       3.0 |
| 02/04_06:52 | 1177.8012 |   19.63 |            0.2 |                       3.2 |
| 02/04_08:52 | 1297.7563 | 21.6293 |            0.2 |                       3.4 |
| 02/04_10:54 | 1419.5762 | 23.6596 |            0.4 |                       3.8 |
| 02/04_12:54 | 1539.5836 | 25.6597 |            0.3 |                       4.1 |
| 02/04_13:24 | 1569.5836 | 26.1597 |            0.3 |                       4.4 |
| 02/04_13:54 | 1599.5838 | 26.6597 |            0.3 |                       4.7 |
| 02/04_14:24 | 1629.5838 | 27.1597 |            0.2 |                       4.9 |
| 02/04_14:54 | 1659.5837 | 27.6597 |            0.1 |                       5.0 |
| 02/04_15:24 | 1689.5836 | 28.1597 |            0.0 |                       5.0 |
| 02/04_15:54 | 1719.5836 | 28.6597 |            0.0 |                       5.0 |
| 02/04_16:24 | 1749.5838 | 29.1597 |            0.0 |                       5.0 |
| 02/04_16:54 | 1779.5838 | 29.6597 |           0.05 |                      5.05 |
| 02/04_17:24 | 1809.5836 | 30.1597 |           0.05 |                       5.1 |
| 02/04_17:54 | 1839.5904 | 30.6598 |           0.05 |                      5.15 |
| 02/04_19:54 | 1959.5909 | 32.6598 |           0.05 |                       5.2 |
| 02/04_21:54 | 2079.5925 | 34.6599 |           0.05 |                      5.25 |
| 02/04_23:54 | 2199.5967 | 36.6599 |           0.05 |                       5.3 |
| 03/04_01:54 | 2319.5968 | 38.6599 |           0.05 |                      5.35 |
| 03/04_03:54 | 2439.5966 | 40.6599 |           0.05 |                       5.4 |
| 03/04_05:54 | 2559.6016 |   42.66 |           0.05 |                      5.45 |
| 03/04_07:54 | 2679.6035 | 44.6601 |            0.2 |                      5.65 |
| 03/04_09:54 | 2799.6036 | 46.6601 |            0.3 |                      5.95 |
| 03/04_12:54 | 2979.6124 | 49.6602 |            0.2 |                      6.15 |
| 03/04_13:54 | 3039.6122 | 50.6602 |            0.1 |                      6.25 |
| 03/04_14:24 | 3069.6132 | 51.1602 |            0.0 |                      6.25 |
| 03/04_14:54 | 3100.3719 | 51.6729 |            0.0 |                      6.25 |
| 03/04_15:26 | 3132.4177 |  52.207 |            0.0 |                      6.25 |
| 03/04_16:29 | 3194.6886 | 53.2448 |            0.0 |                      6.25 |
| 03/04_17:29 | 3254.6931 | 54.2449 |            0.0 |                      6.25 |
| 03/04_18:29 |  3314.693 | 55.2449 |            0.0 |                      6.25 |

[[../plots/BMPs/Hydrolyzed FW/methane_kinetics_hydrolysate_4_s1_r1_hour.png]]

[[../plots/BMPs/Hydrolyzed FW/specific_methane_kinetics_hydrolysate_4_s1_r1_hour.png]]

** Untreated FW
Εκτός από τα παραπάνω, σε ένα από τα δοχεία προστέθηκε ανεπεξέργαστο FW. Αυτό έχει διαφορά από το δείγμα 0, καθώς εκείνο υπέστει ζύμωση κατά τις 72 ώρες που ήταν στους 40 \( ^oC \) ακόμη και χωρίς να προσθέσουμε κάποιο εμβόλιο, ενώ το δείγμα αυτό αναφέρεται σε food waste το οποίο δεν έχει υποστεί καμία επεξεργασία. Θα θέλαμε το δείγμα αυτό να έχει το χειρότερο performance (είτε πολύ αργή παραγωγή, ή μικρή τελική παραγωγή), το οποίο θα μας επιδείκνυε πως η επεξεργασία που έγινε βοηθάει πραγματικά στην χώνευση. Βέβαια, αξίζει να αναφερθεί πως το δοχείο αυτό είχε κάποιο προβλήματα με διαρροή στα αρχικά στάδια του πειράματος, οπότε ενδέχεται τα αποτελέσματα που θα προκύψουν να μην είναι έγκυρα. Παρακάτω φαίνεται ο κώδικας επεξεργασίας των αποτελεσμάτων του.

*untreated_fw_s1_r1*
#+NAME: untreated_fw_s1_r1
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Untreated FW ###

  <<date_saving_fw_s1_r1>>

  inds = 22:50
  exp_meth_vol = [0, 0.2, 0, 0.1, 0.1, 0, 0, 0, 0.1, 0.1, 0, 0.1, 0.2, 0.1, 0.1, 0.1, 0.0, 0.1, 0.2, 0.1, 0.2, 0.1, 0.1, 0, 0, 0, 0, 0, 0]
  meth_vol_hydro_fw = cumsum(exp_meth_vol)[end]
  exp_name = "untreated_fw_s1_r1"
  source = "Untreated FW"
  sample = "FW 1"
  sludge = "Sludge 1"
  run_num = "Run 1"

  input_vs = 1.55

  <<bmp_data_processing>>

  p0 = [2.0, 0.001, 1.0]
  <<bmp_curve_fitting_min>>
  model_hydro_fw_min = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [2.0, 0.1, 0.1]
  <<bmp_curve_fitting_hour>>
  model_hydro_fw_hour = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_hour>>
  sma_hydro_fw = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: untreated_fw_s1_r1
: "../data/exp_pro/untreated_fw_s1_r1.csv"

#+RESULTS: untreated_fw_1_ad
: "/home/vidianos/Documents/9o_εξάμηνο/Masters_Thesis/plots/BMPs/Untreated FW/methane_kinetics_untreated_fw_1_hour.png"

*** Results
Το δείγμα αυτό παρήγαγε μόνο το \( 7.1 \% \) του μεθανίου που είχε παράξει από οξικό και το έκανε αυτό σε έναν αργό σχετικά ρυθμό. Κρίνεται πιθανό να μην επιλύθηκαν τα προβλήματα διαρροής που είχε και η παραγωγή του αερίου να ήταν στην πραγματικότητα μεγαλύτερη. Όμως όπως και στο δείγμα με 0 ml ένζυμα το οποίο όμως υπέστει 3 μέρες υδρόλυση και ζύμωση, μας "βολεύει" τα ποσοστά αυτά να είναι πολύ χαμηλά επειδή σημαίνει πως η επεξεργασία που κάναμε όντως συνείσφερε στην παραγωγή μεθανίου.

Από άποψη προσαρμογής, το μοντέλο Gompertz μπορεί να προσαρμοστεί πολύ καλά σε τέτοια δεδομένα όπου η παραγωγή μεθανίου γίνεται σε παρόμοιο ρυθμό για όλη την διεργασία. Το μοντέλο που θα αντιστοιχήσει θα είναι ένα μοντέλο χαμηλού ρυθμού (με βάση την παραπάνω διάκριση), το οποίο όμως είναι το μόνο που μπορεί να ισχύει καθώς στην αρχή δεν υπάρχει μία απότομη παραγωγή αερίου ταχύτατα για να μπορεί να προσαρμοστεί κάτι διαφορετικό. Τα μοντέλα σε λεπτά και ώρες δεν προσαρμόζονται με τον ακριβώς ίδιο τρόπο, αλλά οι διαφορές τους είναι μικρές. Ο ειδικός ρυθμός ανάπτυξης είναι της τάξης του \( 0.0137 \frac{ml}{g ~ sCOD \min} \text{ ή } 0.823 \frac{ml}{g ~ sCOD ~ hour} \). Τα άλλα μοντέλα που προσαρμόστηκαν με αργό ρυθμό ανάπτυξης είχαν κινητικές της τάξης του 0.03-0.05 \( \frac{ml}{g ~ sCOD \min } \) οπότε αυτό είναι πιο αργό αλλά συγκρίσιμο με εκείνα.

#+NAME: untreated_fw_data_s1_r1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<untreated_fw_s1_r1()>> '(4))
#+END_SRC

| Timestamp   |   Minutes |   Hours | Methane_Volume | Cumulative_Methane_Volume |
| 02/04_10:54 |       0.0 |     0.0 |            0.0 |                       0.0 |
| 02/04_12:54 |  120.0074 |  2.0001 |            0.2 |                       0.2 |
| 02/04_13:24 |  150.0073 |  2.5001 |            0.0 |                       0.2 |
| 02/04_13:54 |  180.0076 |  3.0001 |            0.1 |                       0.3 |
| 02/04_14:24 |  210.0076 |  3.5001 |            0.1 |                       0.4 |
| 02/04_14:54 |  240.0075 |  4.0001 |            0.0 |                       0.4 |
| 02/04_15:24 |  270.0074 |  4.5001 |            0.0 |                       0.4 |
| 02/04_15:54 |  300.0073 |  5.0001 |            0.0 |                       0.4 |
| 02/04_16:24 |  330.0076 |  5.5001 |            0.1 |                       0.5 |
| 02/04_16:54 |  360.0076 |  6.0001 |            0.1 |                       0.6 |
| 02/04_17:24 |  390.0073 |  6.5001 |            0.0 |                       0.6 |
| 02/04_17:54 |  420.0141 |  7.0002 |            0.1 |                       0.7 |
| 02/04_19:54 |  540.0146 |  9.0002 |            0.2 |                       0.9 |
| 02/04_21:54 |  660.0162 | 11.0003 |            0.1 |                       1.0 |
| 02/04_23:54 |  780.0205 | 13.0003 |            0.1 |                       1.1 |
| 03/04_01:54 |  900.0205 | 15.0003 |            0.1 |                       1.2 |
| 03/04_03:54 | 1020.0203 | 17.0003 |            0.0 |                       1.2 |
| 03/04_05:54 | 1140.0253 | 19.0004 |            0.1 |                       1.3 |
| 03/04_07:54 | 1260.0272 | 21.0005 |            0.2 |                       1.5 |
| 03/04_09:54 | 1380.0273 | 23.0005 |            0.1 |                       1.6 |
| 03/04_12:54 | 1560.0362 | 26.0006 |            0.2 |                       1.8 |
| 03/04_13:54 |  1620.036 | 27.0006 |            0.1 |                       1.9 |
| 03/04_14:24 |  1650.037 | 27.5006 |            0.1 |                       2.0 |
| 03/04_14:54 | 1680.7956 | 28.0133 |            0.0 |                       2.0 |
| 03/04_15:26 | 1712.8415 | 28.5474 |            0.0 |                       2.0 |
| 03/04_16:29 | 1775.1124 | 29.5852 |            0.0 |                       2.0 |
| 03/04_17:29 | 1835.1168 | 30.5853 |            0.0 |                       2.0 |
| 03/04_18:29 | 1895.1168 | 31.5853 |            0.0 |                       2.0 |
| 03/04_20:29 | 2015.1168 | 33.5853 |            0.0 |                       2.0 |

[[../plots/BMPs/Untreated FW/methane_kinetics_untreated_fw_s1_r1_min.png]]

[[../plots/BMPs/Untreated FW/methane_kinetics_untreated_fw_s1_r1_hour.png]]

[[../plots/BMPs/Untreated FW/specific_methane_kinetics_untreated_fw_s1_r1_hour.png]]

** Update all
Όπως και παραπάνω για τα πειράματα στο οξικό, θα υπάρχει και ένα code block το οποίο θα κάνει update όλα τα code blocks, θα τα κάνει tangle σε ένα script file και θα αποθηκεύει ένα CSV με όλα τα κινητικά αποτελέσματα.

*update_hydrolysate_tests_s1_r1*
#+NAME: update_hydrolysate_tests_s1_r1
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_fw_hydrolysate_s1_r1_analysis.jl

  <<hydrolysate_0_s1_r1>>
  <<hydrolysate_1_s1_r1>>
  <<hydrolysate_2_s1_r1>>
  <<hydrolysate_4_s1_r1>>
  <<untreated_fw_s1_r1>>

  model_fit_table_min = Tables.table(vcat(reshape(model_hydro_0_min, 1, 5), reshape(model_hydro_1_min, 1, 5), reshape(model_hydro_2_min, 1, 5), reshape(model_hydro_4_min, 1, 5), reshape(model_hydro_fw_min, 1, 5)), header = [:Sample_Name, :Production_Potential, :Production_Rate, :Lag_Time, :R_squared])
  CSV.write(datadir("exp_pro", "methane_from_hydrolysate_kinetics_min_s1_r1.csv"), model_fit_table_min)

  model_fit_table_hour = Tables.table(vcat(reshape(model_hydro_0_hour, 1, 5), reshape(model_hydro_1_hour, 1, 5), reshape(model_hydro_2_hour, 1, 5), reshape(model_hydro_4_hour, 1, 5), reshape(model_hydro_fw_hour, 1, 5)), header = [:Sample_Name, :Production_Potential, :Production_Rate, :Lag_Time, :R_squared])
  CSV.write(datadir("exp_pro", "methane_from_hydrolysate_kinetics_hour_s1_r1.csv"), model_fit_table_hour)
  return("../data/exp_pro/methane_from_hydrolysate_kinetics_min_s1_r1.csv")
#+END_SRC

#+RESULTS: update_hydrolysate_tests_s1_r1
: "../data/exp_pro/methane_from_hydrolysate_kinetics_min_s1_r1.csv"

#+NAME: hydrolysate_kinetic_name_hour_s1_r1
#+BEGIN_SRC julia

  return("../data/exp_pro/methane_from_hydrolysate_kinetics_hour_s1_r1.csv")
#+END_SRC

#+NAME: hydrolysate_kinetics_hour_s1_r1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<hydrolysate_kinetic_name_hour_s1_r1()>> '(4))
#+END_SRC

#+CAPTION: Kinetics with timescale in hours
| Sample_Name | Production_Potential | Production_Rate | Lag_Time | R_squared |
| Sample 0    |                5.129 |           0.148 |      0.0 |     0.928 |
| Sample 1    |               12.333 |            0.29 |      0.0 |     0.933 |
| Sample 2    |                7.414 |           0.187 |      0.0 |     0.988 |
| Sample 4    |                6.449 |           0.181 |      0.0 |     0.976 |
| FW 1        |                2.296 |           0.081 |      0.0 |     0.984 |

#+NAME: hydrolysate_kinetics_minute_s1_r1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<update_hydrolysate_tests_s1_r1()>> '(4))
#+END_SRC

#+CAPTION: Kinetics with timescale in minutes
| Sample_Name | Production_Potential | Production_Rate | Lag_Time | R_squared |
| Sample 0    |                5.129 |           0.002 |      0.0 |     0.928 |
| Sample 1    |               12.334 |           0.005 |      0.0 |     0.933 |
| Sample 2    |                7.471 |           0.003 |      0.0 |     0.986 |
| Sample 4    |                6.418 |           0.003 |      0.0 |     0.976 |
| FW 1        |                2.369 |           0.001 |      0.0 |     0.982 |

#+NAME: sma_hydro_s1_r1
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_fw_hydrolysate_s1_r1_analysis.jl

  <<hydrolysate_0_s1_r1>>
  <<hydrolysate_1_s1_r1>>
  <<hydrolysate_2_s1_r1>>
  <<hydrolysate_4_s1_r1>>
  <<untreated_fw_s1_r1>>

  sma_table = Tables.table(vcat(reshape(sma_hydro_0, 1, 5), reshape(sma_hydro_1, 1, 5), reshape(sma_hydro_2, 1, 5), reshape(sma_hydro_4, 1, 5), reshape(sma_hydro_fw, 1, 5)), header = [:Sample_Name, :Methane_Potential, :SMA, :Lag_Time, :R_sq])
  CSV.write(datadir("exp_pro", "sma_from_hydrolysate_s1_r1.csv"), sma_table)

  return("../data/exp_pro/sma_from_hydrolysate_s1_r1.csv")
#+END_SRC

#+RESULTS: sma_hydro_s1_r1
: "../data/exp_pro/sma_from_hydrolysate_s1_r1.csv"

#+NAME: acet_sma_data_s1_r1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<sma_hydro_s1_r1()>> '(4))
#+END_SRC

#+CAPTION: SMA Kinetics in hours
| Sample_Name | Methane_Potential |   SMA | Lag_Time |  R_sq |
| Sample 0    |             3.309 | 0.096 |      0.0 | 0.928 |
| Sample 1    |             8.256 | 0.163 |      0.0 | 0.905 |
| Sample 2    |             4.822 | 0.117 |      0.0 | 0.986 |
| Sample 4    |             4.255 | 0.105 |      0.0 | 0.956 |
| FW 1        |              1.48 | 0.052 |      0.0 | 0.984 |

** Plotting Methane Potential
Σε αυτό το section θα γίνει ένα plot το οποίο θα συγκρίνει μέγιστο μεθάνιο (παραγωγή από οξικό) με αυτό που παράχθηκε από το FW. Το plotting θα γίνει μέσω του ~CairoMakie.jl~ το οποίο είναι αρκετά featureful. Η διαδικασία είναι πως βάζουμε όλους τους όγκους παραγόμενου μεθανίου σε ένα vector και εκτός από την απόλυτη τιμή, υπολογίζουμε και το ποσοστό του μέγιστου που πετυχαίνει το υδρόλυμα. Όπως έχουν αποθηκευτεί, αυτό είναι διαίρεση του στοιχείου i+5 με το i. Έπειτα φτιάχνουμε ένα string των ποσοστών αυτών μαζί με τα labels που τους αντιστοιχούν. Αυτό θα προστεθεί στο plot που φτιάχνουμε.

Έχοντας κάνει το preprocessing αυτό, ξεκινάμε την δημιουργία διαγραμμάτων. Φτιάχνουμε ένα figure και έναν άξονα πάνω σε αυτό όπου θα κάνουμε τα bar plots που θέλουμε. Οι μεταβλητές ~xdata~ και ~grp~ είναι απαραίτητες για να φτιαχτεί το plot. Το xdata λέει σε ποιό σημείο του άξονα x θα πάει κάθε δεδομένο (όπως τα έχουμε ορίσει θα είναι από το 1 εώς το 5 δύο φορές) ενώ το grp λέει σε ποιό group θα ανήκει το κάθε πείραμα. Τα 5 πρώτα είναι στο group 1 (οξικό) ενώ τα άλλα στο 2 (υδρόλυμα). Ορίζουμε και το legend και το plot αυτό είναι έτοιμο. Από κάτω, κάνουμε insert το string με τα ποσοστά που υπολογίστηκε παραπάνω σε ένα text plot του Makie. Έπειτα, κάνουμε save το plot αυτό.

*BMP_comp_plot*
#+NAME: BMP_comp_plot
#+BEGIN_SRC julia

  using CairoMakie
  colors = Makie.wong_colors()

  meth_vol = [meth_vol_acet_0, meth_vol_acet_1, meth_vol_acet_2, meth_vol_acet_4, meth_vol_acet_fw, meth_vol_hydro_0, meth_vol_hydro_1, meth_vol_hydro_2, meth_vol_hydro_4, meth_vol_hydro_fw]

  percent_bmp = [meth_vol[i+5]/meth_vol[i] for i in 1:5]
  string_bmp = vcat(string.(round.(percent_bmp.*100, digits = 2)).*" %", ["0 ml", "1 ml", "2 ml", "4 ml", "Untreated \nFW"])

  fig = Figure(size = (600, 400))
  ax = Axis(fig[1,1], xticks = (1:5, ["0 ml", "1 ml", "2 ml", "4 ml", "Untreated FW"]),
	    title = "Acetate vs Hydrolysate BMP - "*sludge*run, ylabel = "Methane Produced (ml)")

  xdata = [1, 2, 3, 4, 5, 1, 2, 3, 4, 5]
  grp = [1, 1, 1, 1, 1, 2, 2, 2, 2, 2]

  barplot!(ax, xdata, meth_vol,
	  dodge = grp,
	  color = colors[grp])

  # Legend
  labels = ["Acetate", "FW Hydrolysate"]
  elements = [PolyElement(polycolor = colors[i]) for i in 1:length(labels)]
  title = "Source"
  Legend(fig[1,2], elements, labels, title)

  ax2 = Axis(fig[2, 1], xticks = (1:5, ["0 ml", "1 ml", "2 ml", "4 ml", "Untreated FW"]), yticks = ([1, 2], ["", ""]), title = "% of Acetate BMP in Hydrolysates")
  hidespines!(ax2)
  hidedecorations!(ax2)
  text!(xdata, repeat(1:1, 10), text = string_bmp, align = [(:left, :top), (:left, :top), (:center, :top), (:right, :top), (:right, :top), (:left, :bottom), (:left, :bottom), (:center, :bottom), (:right, :bottom), (:right, :bottom)])

  save(plotsdir("BMPs", "Hydrolyzed FW", "acet_vs_hydro_bmp_"*comp_name*".png"), fig)
#+END_SRC

#+RESULTS: BMP_comp_plot

Για να τρέξουμε αυτό το code block χωρίς προβλήματα, πρέπει να δώσουμε τιμή στο ~comp_name~ και να κάνουμε update τα tests ώστε να έχουμε τα σωστά.
#+NAME: BMP_data_collection_s1_r1
#+BEGIN_SRC julia :noweb no-export

  <<update_acetate_tests_s1>>
  <<update_hydrolysate_tests_s1_r1>>

  comp_name = "s1_r1"
  sludge = "Sludge 1 "
  run = "Run 1"
  <<BMP_comp_plot>>
#+END_SRC

#+RESULTS: BMP_data_collection_s1_r1
: CairoMakie.Screen{IMAGE}

#+ATTR_ORG: :width 900px
[[../plots/BMPs/Hydrolyzed FW/acet_vs_hydro_bmp_s1_r1.png]]

** Comparing Kinetic Constants
Έχοντας συγκρίνει το μέγιστο παραγώμενο βιομεθάνιο μεταξύ οξικού και των υδρολυμάτων, αξίζει να συγκρίνουμε και τους ρυθμούς παραγωγής μεθανίου σε κάθε περίπτωση για να δούμε ποιό πείραμα είναι το καλύτερο. Πάλι δεν θα συγκρίνουμε τους ρυθμούς μεταξύ τους, αλλά θα τους συγκρίνουμε με βάση το οξικό τους. Επειδή αρκετά έχουν διαφορετικές μονάδες, θα κάνουμε read τα CSVs τους και θα κάνουμε τα απαραίτητα conversions. Για το πείραμα αυτό που υπάρχουν δυο ρυθμοί, θα πάρουμε τον αργό ρυθμό, καθώς ο γρήγορος είναι μάλλον έντονα επηρεασμένος από το οξικό. 

#+NAME: ad_kinetics_comparison
#+BEGIN_SRC julia

  acet_kinetics = CSV.read(datadir("exp_pro", "methane_from_acetate_kinetics_"*sludge*".csv"), DataFrame)
  hydro_kinetics = CSV.read(datadir("exp_pro", "methane_from_hydrolysate_kinetics_"*timescale*"_"*sludge*"_"*run*".csv"), DataFrame)

  # Acetate rates are in minutes while hydrolysate in hours
  acet_rates = acet_kinetics.Production_Rate
  hydro_rates = hydro_kinetics.Production_Rate

  # Convert Acetate rates to hours
  acet_rates_hour = acet_rates.*60

  # Find what percentage of acetate each hydrolysate is
  acet_percent_hydro = round.((hydro_rates./acet_rates_hour).*100, digits = 4)

  # Create a new table with the 2 rates and their ratio
  kinetic_comp = Tables.table(hcat(acet_kinetics.Sample_Name, acet_rates_hour, hydro_rates, acet_percent_hydro), header = [:Sample_Name, :Acetate, :Hydrolysate, :Ratio])
  CSV.write(datadir("exp_pro", "kinetics_comparison_"*sludge*"_"*run*".csv"), kinetic_comp)

  # We can also do this for SMA
  acet_sma_kinetics = CSV.read(datadir("exp_pro", "sma_from_acetate_"*sludge*".csv"), DataFrame)
  hydro_sma_kinetics = CSV.read(datadir("exp_pro", "sma_from_hydrolysate_"*sludge*"_"*run*".csv"), DataFrame)

  # Acetate rates are in minutes while hydrolysate in hours
  acet_sma = acet_sma_kinetics.SMA
  hydro_sma = hydro_sma_kinetics.SMA

  # SMA is commonly expressed per day so convert to days
  acet_sma_day = round.(acet_sma.*(60*24), digits = 3)
  hydro_sma_day = round.(hydro_sma.*24, digits = 3)

  # Find what percentage of acetate each hydrolysate is
  acet_percent_hydro_sma = round.((hydro_sma_day./acet_sma_day).*100, digits = 4)

  # Create a new table with the 2 rates and their ratio
  sma_comp = Tables.table(hcat(acet_sma_kinetics.Sample_Name, acet_sma_day, hydro_sma_day, acet_percent_hydro_sma), header = [:Sample_Name, :Acetate, :Hydrolysate, :Ratio])
  CSV.write(datadir("exp_pro", "kinetics_comparison_sma_"*sludge*"_"*run*".csv"), sma_comp)

#+END_SRC

#+RESULTS: ad_kinetics_comparison
: "/home/vidianos/Documents/9o_εξάμηνο/Masters_Thesis/data/exp_pro/kinetics_comparison_sma_s1_r1.csv"

#+NAME: kinetics_comp_s1_r1
#+BEGIN_SRC julia :noweb no-export

  <<update_acetate_tests_s1>>
  <<update_hydrolysate_tests_s1_r1>>

  sludge = "s1"
  run = "r1"
  timescale = "hour"

  <<ad_kinetics_comparison>>
  return("../data/exp_pro/kinetics_comparison_s1_r1.csv")
#+END_SRC

#+RESULTS: kinetics_comp_s1_r1
: "../data/exp_pro/kinetics_comparison_s1_r1.csv"

#+NAME: sma_comp_s1_r1
#+BEGIN_SRC julia
  return("../data/exp_pro/kinetics_comparison_sma_s1_r1.csv")
#+END_SRC

#+NAME: kinetic_data_s1_r1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<kinetics_comp_s1_r1()>> '(4))
#+END_SRC

#+CAPTION: Kinetic Comparison with timescale in hours
| Sample_Name | Acetate | Hydrolysate |  Ratio |
| Sample 0    |  459.84 |       0.148 | 0.0322 |
| Sample 1    |  326.88 |        0.29 | 0.0887 |
| Sample 2    |  374.04 |       0.187 |   0.05 |
| Sample 4    |   579.0 |       0.181 | 0.0313 |
| Sample FW   |  294.06 |       0.081 | 0.0275 |

#+NAME: kinetic_sma_data_s1_r1
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<sma_comp_s1_r1()>> '(4))
#+END_SRC

#+CAPTION: SMA Comparison with timescale in days
| Sample_Name | Acetate | Hydrolysate |  Ratio |
| Sample 0    | 7119.36 |       2.304 | 0.0324 |
| Sample 1    |  5061.6 |       3.912 | 0.0773 |
| Sample 2    | 5676.48 |       2.808 | 0.0495 |
| Sample 4    | 8965.44 |        2.52 | 0.0281 |
| Sample FW   | 4554.72 |       1.248 | 0.0274 |

** Συμπεράσματα του πειραματικού κύκλου αυτού
Το πείραμα αυτό ήταν το πρώτο πείραμα όπου τροφοδοτήσαμε με υδρολύματα από FW για να δούμε την απόκριση του συστήματος σε αυτά.

Ο κύκλος αυτός είχε κάποια προβλήματα στην ανάλυση δεδομένων, αλλά μετά από κάποια επεξεργασία, ήρθαν σε μία μορφή η οποία βγάζει νόημα και είναι συγκρίσιμη με την άλλη επανάληψη, η οποία φαίνεται παρακάτω.

Μία περίεργη παρατήρηση η οποία σίγουρα αξίζει να σημειωθεί είναι πως κανένα από τα μοντέλα δεν είχε lag time. Αυτό είχε παρατηρηθεί και στα πειράματα με το οξικό. Γενικά, το lag time είναι μία φυσική παράμετρος του συστήματος που εκφράζει πόσο γρήγορα αντιδρά το σύστημα με μία αλλαγή στο περιβάλλον του. Για την προσθήκη οξικού είναι λογικό το μηδενικό lag time καθώς είναι το ιδανικό υπόστρωμα του συστήματος. Για το υδρόλυμα, θα αναμενόταν πιθανόν κάποιο lag time, αλλά στο πείραμα αυτό δεν παρατηρήθηκε κάτι τέτοιο.

Ως προς το biomethane potential (BMP) του συστήματος, όπως θα αναμενόταν τα υδρολύματα παρήγαγαν λιγότερο μεθάνιο από το οξικό. Για την σύγκριση των πειράματων, έγινε έμμεσα συγκρίνοντας τι ποσοστό του αντίστοιχου οξικού ήταν το καθένα. Η χαμηλότερη παραγωγικότητα ήταν από το FW, το οποίο είναι καλό συμπέρασμα επειδή δείχνει την σημασία της προεπεξεργασίας. Υπήρχε μία υπόθεση ότι μπορεί να διέρρεε αέριο από το δοχείο αυτό, αλλά εν τέλει, με βάση τα πειράματα του 2ου κύκλου, έγινε overacidification το οποίο οδήγησε σε κατάρρευση του συστήματος.

Λόγω των προβλημάτων που παρουσιάστηκαν και για να επιβεβαιώσουμε αν είναι επαναλήψιμα αυτά, έγινε και ένα δεύτερο πείραμα με τις ίδιες συνθήκες για να δούμε τα αποτελέσματα του.

* FW Hydrolysate S1_R2 Processing
Στο section αυτό θα αναλυθούν τα αποτελεσματα του δεύτερου πειράματος που χρησιμοποιήσε FW hydrolysate ως υπόστρωμα (S1_R2 επειδή είναι το δεύτερο run με την πρώτη λάσπη). Βρίσκεται σε πλήρη αντιστοιχία με το προηγούμενο πείραμα και έγινε για επαναληψιμότητα. Οπότε, σκοπός είναι να εξετάσουμε αν είναι παρόμοιο με το προηγούμενο ή αν διαφέρει σημαντικά και στην περίπτωση του 2ου, να κρίνουμε ποιά από τις δύο περιπτώσεις είναι πραγματικά ο outlier. Τα σχόλια για το τι είναι κάθε δείγμα θα μείνουν ίδια με παραπάνω για υπενθύμιση.

** Sample 0
Το δείγμα αυτό είναι labelled ως δείγμα 0 καθώς είναι το δείγμα το οποίο τροφοδοτήθηκε με treated FW, όμως χωρίς προσθήκη του μιξ ενζύμων και μικροοργανισμών. Όπως έχουμε δεί, όλες οι αντιδράσεις που γίνονται κατά την υδρόλυση και ζύμωση μπορούν να γίνουν και χωρίς το μιξ. Όμως, γινόντουσαν πιο αποτελεσματικά με την προσθήκη αυτού. Οπότε, ελπίζουμε πως το δείγμα αυτό θα έχει χειρότερα αποτελέσματα από τα άλλα, το οποίο θα μας οδηγήσει στην υπόθεση ότι το μιξ βελτιώνει όχι μόνο τα κριτήρια υδρόλυσης και οξεογένεσης αλλά και αυτό της μεθανογένεσης.

*hydrolysate_0_s1_r2*
#+NAME: hydrolysate_0_s1_r2
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Hydrolysate with 0 ml ###

  <<date_saving_fw_s1_r2>>

  inds = 1:69
  exp_meth_vol = [0, 0, 0, 0, 0, 0, 0, 0.1, 0.1, 0.1, 0.05, 0.1, 0.1, 0.05, 0.1, 0.1, 0.1, 0.1, 0.1, 0.05, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0, 0, 0, 0, 0, 0, 0, 0, 0.1, 0.1, 0.1, 0.1, 0.05, 0.05, 0.1, 0.05, 0, 0, 0.05, 0.05, 0.05, 0.1, 0.05, 0.05, 0.05, 0.05, 0.1, 0.1, 0.1, 0.05, 0.05, 0.05, 0.05, 0, 0.05, 0, 0.02, 0.02, 0.01, 0, 0, 0, 0]
  meth_vol_hydro_0 = cumsum(exp_meth_vol)[end]

  exp_name = "hydrolysate_0_s1_r2"
  source = "Hydrolyzed FW"
  sample = "Sample 0"
  sludge = "Sludge 1"
  run_num = "Run 2"
  input_vs = 1.55

  <<bmp_data_processing>>

  # The same model is fit either with min or hour
  p0 = [5.0, 0.04, 1.0]
  <<bmp_curve_fitting_min>>
  model_hydro_0_min = vcat(sample, round.(model_params, digits = 4), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [4.0, 0.1, 1.0]
  <<bmp_curve_fitting_hour>>
  model_hydro_0_hour = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_hour>>
  sma_hydro_0 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: hydrolysate_0_s1_r2
: "../data/exp_pro/hydrolysate_0_s1_r2.csv"

*** Results
Παρακάτω φαίνονται τα αποτελέσματα του σχετικού πειράματος.

#+NAME: hydrolysate_data_0_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<hydrolysate_0_s1_r2()>> '(4))
#+END_SRC

| Timestamp   |   Minutes |    Hours | Methane_Volume | Cumulative_Methane_Volume |
|-------------+-----------+----------+----------------+---------------------------|
| 03/04_14:37 |       0.0 |      0.0 |            0.0 |                       0.0 |
| 03/04_14:45 |    8.4249 |   0.1404 |            0.0 |                       0.0 |
| 03/04_14:51 |   14.5619 |   0.2427 |            0.0 |                       0.0 |
| 03/04_14:56 |   19.6074 |   0.3268 |            0.0 |                       0.0 |
| 03/04_15:29 |   51.8783 |   0.8646 |            0.0 |                       0.0 |
| 03/04_16:29 |  111.8786 |   1.8646 |            0.0 |                       0.0 |
| 03/04_17:29 |  171.8831 |   2.8647 |            0.0 |                       0.0 |
| 03/04_18:29 |   231.883 |   3.8647 |            0.1 |                       0.1 |
| 03/04_20:29 |  351.8831 |   5.8647 |            0.1 |                       0.2 |
| 03/04_22:29 |  471.8831 |   7.8647 |            0.1 |                       0.3 |
| 04/04_00:29 |  591.8898 |   9.8648 |           0.05 |                      0.35 |
| 04/04_02:29 |  711.8898 |  11.8648 |            0.1 |                      0.45 |
| 04/04_04:29 |  831.8898 |  13.8648 |            0.1 |                      0.55 |
| 04/04_06:29 |  951.8898 |  15.8648 |           0.05 |                       0.6 |
| 04/04_08:29 | 1071.8939 |  17.8649 |            0.1 |                       0.7 |
| 04/04_10:29 | 1191.8998 |   19.865 |            0.1 |                       0.8 |
| 04/04_12:29 | 1311.9002 |   21.865 |            0.1 |                       0.9 |
| 04/04_14:29 | 1431.9003 |   23.865 |            0.1 |                       1.0 |
| 04/04_16:29 | 1551.9002 |   25.865 |            0.1 |                       1.1 |
| 04/04_18:29 | 1671.9187 |  27.8653 |           0.05 |                      1.15 |
| 04/04_20:29 | 1791.9215 |  29.8654 |            0.1 |                      1.25 |
| 04/04_22:29 | 1911.9228 |  31.8654 |            0.1 |                      1.35 |
| 05/04_00:29 | 2031.9178 |  33.8653 |            0.1 |                      1.45 |
| 05/04_02:29 | 2151.9188 |  35.8653 |            0.1 |                      1.55 |
| 05/04_04:29 | 2271.9218 |  37.8654 |            0.1 |                      1.65 |
| 05/04_06:29 | 2391.9224 |  39.8654 |            0.1 |                      1.75 |
| 05/04_08:29 | 2511.9224 |  41.8654 |            0.0 |                      1.75 |
| 05/04_09:29 | 2571.9221 |  42.8654 |            0.0 |                      1.75 |
| 05/04_10:37 | 2640.1985 |  44.0033 |            0.0 |                      1.75 |
| 05/04_10:38 | 2641.1985 |    44.02 |            0.0 |                      1.75 |
| 05/04_10:39 | 2642.1984 |  44.0366 |            0.0 |                      1.75 |
| 05/04_10:40 | 2643.1753 |  44.0529 |            0.0 |                      1.75 |
| 05/04_11:40 | 2703.3506 |  45.0558 |            0.0 |                      1.75 |
| 05/04_12:40 | 2763.3564 |  46.0559 |            0.0 |                      1.75 |
| 05/04_14:40 | 2883.3563 |  48.0559 |            0.1 |                      1.85 |
| 05/04_16:40 | 3003.3568 |  50.0559 |            0.1 |                      1.95 |
| 05/04_18:40 | 3123.3627 |   52.056 |            0.1 |                      2.05 |
| 05/04_20:40 | 3243.3636 |  54.0561 |            0.1 |                      2.15 |
| 05/04_22:40 | 3363.3662 |  56.0561 |           0.05 |                       2.2 |
| 06/04_00:40 | 3483.3698 |  58.0562 |           0.05 |                      2.25 |
| 06/04_02:40 | 3603.3701 |  60.0562 |            0.1 |                      2.35 |
| 06/04_04:40 |   3723.37 |  62.0562 |           0.05 |                       2.4 |
| 06/04_06:40 | 3843.3753 |  64.0563 |            0.0 |                       2.4 |
| 06/04_08:40 | 3963.3773 |  66.0563 |            0.0 |                       2.4 |
| 06/04_10:40 | 4083.3773 |  68.0563 |           0.05 |                      2.45 |
| 06/04_12:40 | 4203.3853 |  70.0564 |           0.05 |                       2.5 |
| 06/04_14:40 | 4323.3855 |  72.0564 |           0.05 |                      2.55 |
| 06/04_16:40 | 4443.3882 |  74.0565 |            0.1 |                      2.65 |
| 06/04_18:40 | 4563.3888 |  76.0565 |           0.05 |                       2.7 |
| 06/04_20:40 | 4683.3889 |  78.0565 |           0.05 |                      2.75 |
| 06/04_22:40 |  4803.389 |  80.0565 |           0.05 |                       2.8 |
| 07/04_00:40 | 4923.3992 |  82.0567 |           0.05 |                      2.85 |
| 07/04_02:40 | 5043.3998 |  84.0567 |            0.1 |                      2.95 |
| 07/04_04:40 | 5163.3999 |  86.0567 |            0.1 |                      3.05 |
| 07/04_06:40 | 5283.3998 |  88.0567 |            0.1 |                      3.15 |
| 07/04_08:40 | 5403.4018 |  90.0567 |           0.05 |                       3.2 |
| 07/04_10:40 | 5523.4112 |  92.0569 |           0.05 |                      3.25 |
| 07/04_12:40 | 5643.4132 |  94.0569 |           0.05 |                       3.3 |
| 07/04_14:40 | 5763.4147 |  96.0569 |           0.05 |                      3.35 |
| 07/04_16:40 |  5883.416 |  98.0569 |            0.0 |                      3.35 |
| 07/04_18:40 | 6003.4222 |  100.057 |           0.05 |                       3.4 |
| 07/04_20:40 | 6123.4235 | 102.0571 |            0.0 |                       3.4 |
| 07/04_22:40 | 6243.4246 | 104.0571 |           0.02 |                      3.42 |
| 08/04_00:40 | 6363.4417 | 106.0574 |           0.02 |                      3.44 |
| 08/04_02:40 | 6483.4429 | 108.0574 |           0.01 |                      3.45 |
| 08/04_04:40 |  6603.434 | 110.0572 |            0.0 |                      3.45 |
| 08/04_06:40 | 6723.4333 | 112.0572 |            0.0 |                      3.45 |
| 08/04_08:40 | 6843.4332 | 114.0572 |            0.0 |                      3.45 |
| 08/04_10:40 | 6963.4332 | 116.0572 |            0.0 |                      3.45 |

[[../plots/BMPs/Hydrolyzed FW/methane_kinetics_hydrolysate_0_s1_r2_hour.png]]

[[../plots/BMPs/Hydrolyzed FW/specific_methane_kinetics_hydrolysate_0_s1_r2_hour.png]]

** Sample 1
Το δείγμα αυτό τροφοδοτήθηκε με το υδρόλυμα το οποίο είχε προσθήκη 1 ml mix. Στο αρχικό κινητικό πείραμα, το δείγμα αυτό είχε αρκετά παρόμοια συμπεριφορά με το 0 και χειρότερη αυτής του 1. Από την μέτρηση του COD του, είχε αναπάντεχα υψηλό sCOD. Αυτό σημαίνει είτε πως έγινε κάποιο λάθος στην ανάλυση ή ότι απλώς έγινε πολύ καλύτερη υδρόλυση από ότι περιμέναμε στο πείραμα αυτό. Με βάση το sCOD του, αναμένεται να έχει καλά αποτελέσματα. Με βάση την HPLC του αρχικού πειράματος, θα περιμέναμε να είναι λίγο καλύτερο από το 0.

*hydrolysate_1_s1_r2*
#+NAME: hydrolysate_1_s1_r2
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Hydrolysate with 1 ml ###

  <<date_saving_fw_s1_r2>>

  inds = 2:69
  exp_meth_vol = [0, 0, 0, 0, 0, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.05, 0.1, 0.2, 0.2, 0.2, 0.2, 0.1, 0.05, 0.1, 0, 0, 0, 0.1, 0.1, 0.2, 0.4, 0.5, 0.2, 0.1, 0.1, 0.2, 0, 0.1, 0.2, 0.2, 0.1, 0.3, 0.1, 0.1, 0, 0.1, 0.2, 0.2, 0.1, 0.2, 0.2, 0.1, 0.1, 0, 0.1, 0.2, 0, 0.1, 0.1, 0.2, 0.2, 0.1]
  meth_vol_hydro_1 = cumsum(exp_meth_vol)[end]
  exp_name = "hydrolysate_1_s1_r2"
  source = "Hydrolyzed FW"
  sample = "Sample 1"
  sludge = "Sludge 1"
  run_num = "Run 2"
  input_vs = 1.5

  p0 = [13.0, 1.0, 1.0]
  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_hydro_1_min = vcat(sample, round.(model_params, digits = 4), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [20.0, 0.5, 1.0]
  <<bmp_curve_fitting_hour>>
  model_hydro_1_hour = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_hour>>
  sma_hydro_1 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: hydrolysate_1_s1_r2
: "../data/exp_pro/hydrolysate_1_s1_r2.csv"

*** Results

#+NAME: hydrolysate_data_1_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<hydrolysate_1_s1_r2()>> '(4))
#+END_SRC

| Timestamp   |   Minutes |    Hours | Methane_Volume | Cumulative_Methane_Volume |
|-------------+-----------+----------+----------------+---------------------------|
| 03/04_14:45 |       0.0 |      0.0 |            0.0 |                       0.0 |
| 03/04_14:51 |     6.137 |   0.1023 |            0.0 |                       0.0 |
| 03/04_14:56 |   11.1825 |   0.1864 |            0.0 |                       0.0 |
| 03/04_15:29 |   43.4534 |   0.7242 |            0.0 |                       0.0 |
| 03/04_16:29 |  103.4538 |   1.7242 |            0.0 |                       0.0 |
| 03/04_17:29 |  163.4582 |   2.7243 |            0.2 |                       0.2 |
| 03/04_18:29 |  223.4582 |   3.7243 |            0.2 |                       0.4 |
| 03/04_20:29 |  343.4582 |   5.7243 |            0.2 |                       0.6 |
| 03/04_22:29 |  463.4582 |   7.7243 |            0.2 |                       0.8 |
| 04/04_00:29 |  583.4649 |   9.7244 |            0.2 |                       1.0 |
| 04/04_02:29 |  703.4649 |  11.7244 |            0.2 |                       1.2 |
| 04/04_04:29 |   823.465 |  13.7244 |            0.2 |                       1.4 |
| 04/04_06:29 |  943.4649 |  15.7244 |            0.2 |                       1.6 |
| 04/04_08:29 |  1063.469 |  17.7245 |            0.2 |                       1.8 |
| 04/04_10:29 | 1183.4749 |  19.7246 |            0.2 |                       2.0 |
| 04/04_12:29 | 1303.4754 |  21.7246 |            0.2 |                       2.2 |
| 04/04_14:29 | 1423.4755 |  23.7246 |            0.2 |                       2.4 |
| 04/04_16:29 | 1543.4754 |  25.7246 |            0.2 |                       2.6 |
| 04/04_18:29 | 1663.4938 |  27.7249 |            0.2 |                       2.8 |
| 04/04_20:29 | 1783.4966 |  29.7249 |            0.2 |                       3.0 |
| 04/04_22:29 | 1903.4979 |   31.725 |            0.2 |                       3.2 |
| 05/04_00:29 |  2023.493 |  33.7249 |           0.05 |                      3.25 |
| 05/04_02:29 | 2143.4939 |  35.7249 |            0.1 |                      3.35 |
| 05/04_04:29 | 2263.4969 |  37.7249 |            0.2 |                      3.55 |
| 05/04_06:29 | 2383.4976 |   39.725 |            0.2 |                      3.75 |
| 05/04_08:29 | 2503.4975 |   41.725 |            0.2 |                      3.95 |
| 05/04_09:29 | 2563.4972 |   42.725 |            0.2 |                      4.15 |
| 05/04_10:37 | 2631.7736 |  43.8629 |            0.1 |                      4.25 |
| 05/04_10:38 | 2632.7736 |  43.8796 |           0.05 |                       4.3 |
| 05/04_10:39 | 2633.7736 |  43.8962 |            0.1 |                       4.4 |
| 05/04_10:40 | 2634.7504 |  43.9125 |            0.0 |                       4.4 |
| 05/04_11:40 | 2694.9257 |  44.9154 |            0.0 |                       4.4 |
| 05/04_12:40 | 2754.9315 |  45.9155 |            0.0 |                       4.4 |
| 05/04_14:40 | 2874.9314 |  47.9155 |            0.1 |                       4.5 |
| 05/04_16:40 | 2994.9319 |  49.9155 |            0.1 |                       4.6 |
| 05/04_18:40 | 3114.9378 |  51.9156 |            0.2 |                       4.8 |
| 05/04_20:40 | 3234.9387 |  53.9156 |            0.4 |                       5.2 |
| 05/04_22:40 | 3354.9413 |  55.9157 |            0.5 |                       5.7 |
| 06/04_00:40 |  3474.945 |  57.9157 |            0.2 |                       5.9 |
| 06/04_02:40 | 3594.9452 |  59.9158 |            0.1 |                       6.0 |
| 06/04_04:40 | 3714.9451 |  61.9158 |            0.1 |                       6.1 |
| 06/04_06:40 | 3834.9504 |  63.9158 |            0.2 |                       6.3 |
| 06/04_08:40 | 3954.9524 |  65.9159 |            0.0 |                       6.3 |
| 06/04_10:40 | 4074.9524 |  67.9159 |            0.1 |                       6.4 |
| 06/04_12:40 | 4194.9604 |   69.916 |            0.2 |                       6.6 |
| 06/04_14:40 | 4314.9606 |   71.916 |            0.2 |                       6.8 |
| 06/04_16:40 | 4434.9633 |  73.9161 |            0.1 |                       6.9 |
| 06/04_18:40 |  4554.964 |  75.9161 |            0.3 |                       7.2 |
| 06/04_20:40 | 4674.9641 |  77.9161 |            0.1 |                       7.3 |
| 06/04_22:40 | 4794.9641 |  79.9161 |            0.1 |                       7.4 |
| 07/04_00:40 | 4914.9743 |  81.9162 |            0.0 |                       7.4 |
| 07/04_02:40 | 5034.9749 |  83.9162 |            0.1 |                       7.5 |
| 07/04_04:40 |  5154.975 |  85.9163 |            0.2 |                       7.7 |
| 07/04_06:40 | 5274.9749 |  87.9162 |            0.2 |                       7.9 |
| 07/04_08:40 | 5394.9769 |  89.9163 |            0.1 |                       8.0 |
| 07/04_10:40 | 5514.9863 |  91.9164 |            0.2 |                       8.2 |
| 07/04_12:40 | 5634.9883 |  93.9165 |            0.2 |                       8.4 |
| 07/04_14:40 | 5754.9898 |  95.9165 |            0.1 |                       8.5 |
| 07/04_16:40 | 5874.9911 |  97.9165 |            0.1 |                       8.6 |
| 07/04_18:40 | 5994.9974 |  99.9166 |            0.0 |                       8.6 |
| 07/04_20:40 | 6114.9986 | 101.9166 |            0.1 |                       8.7 |
| 07/04_22:40 | 6234.9998 | 103.9167 |            0.2 |                       8.9 |
| 08/04_00:40 | 6355.0168 | 105.9169 |            0.0 |                       8.9 |
| 08/04_02:40 |  6475.018 |  107.917 |            0.1 |                       9.0 |
| 08/04_04:40 | 6595.0092 | 109.9168 |            0.1 |                       9.1 |
| 08/04_06:40 | 6715.0084 | 111.9168 |            0.2 |                       9.3 |
| 08/04_08:40 | 6835.0084 | 113.9168 |            0.2 |                       9.5 |
| 08/04_10:40 | 6955.0083 | 115.9168 |            0.1 |                       9.6 |

[[../plots/BMPs/Hydrolyzed FW/methane_kinetics_hydrolysate_1_s1_r2_hour.png]]

[[../plots/BMPs/Hydrolyzed FW/specific_methane_kinetics_hydrolysate_1_s1_r2_hour.png]]

** Sample 2
Το δείγμα το οποίο στην υδρόλυση είχε 2 ml από το μιξ. Με βάση το αρχικό πείραμα υδρόλυσης, αυτό και το 4 ml είχαν το καλύτερο performance και ελάχιστη διαφορά μεταξύ τους (κατά βάση στην συγκέντρωση γαλακτικού οξέος) οπότε θα αναμέναμε εδώ να παρατηρηθεί η καλύτερη μεθανογένεση.

*hydrolysate_2_s1_r2*
#+NAME: hydrolysate_2_s1_r2
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Hydrolysate with 2 ml ###

  <<date_saving_fw_s1_r2>>

  inds = 4:69
  exp_meth_vol = [0, 0.1, 0.1, 1.3, 0, 0.2, 0.1, 0.4, 0.5, 0.2, 0.1, 0.5, 0, 0.1, 0.2, 0.2, 0.2, 0.1, 0.05, 0.05, 0.05, 0, 0.1, 0.1, 0, 0, 0, 0.1, 0.1, 0.2, 0.05, 0, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2, 0.2, 0.2, 0.2, 0.1, 0.05, 0.05, 0, 0.05, 0.1, 0.1, 0, 0.05, 0.1, 0.1, 0.2, 0.2, 0, 0.1, 0.1, 0, 0, 0, 0, 0, 0, 0.05, 0.05]
  meth_vol_hydro_2 = cumsum(exp_meth_vol)[end]
  exp_name = "hydrolysate_2_s1_r2"
  source = "Hydrolyzed FW"
  sample = "Sample 2"
  sludge = "Sludge 1"
  run_num = "Run 2"
  input_vs = 1.55

  <<bmp_data_processing>>

  p0 = [10.0, 1.50, 1.0]
  <<bmp_curve_fitting_min>>
  model_hydro_2_min = vcat(sample, round.(model_params, digits = 4), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [10.0, 0.1, 0.03]
  <<bmp_curve_fitting_hour>>
  model_hydro_2_hour = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_hour>>
  sma_hydro_2 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: hydrolysate_2_s1_r2
: "../data/exp_pro/hydrolysate_2_s1_r2.csv"

*** Results

#+NAME: hydrolysate_data_2_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<hydrolysate_2_s1_r2()>> '(4))
#+END_SRC

| Timestamp   |   Minutes |    Hours | Methane_Volume | Cumulative_Methane_Volume |
|-------------+-----------+----------+----------------+---------------------------|
| 03/04_14:56 |       0.0 |      0.0 |            0.0 |                       0.0 |
| 03/04_15:29 |   32.2709 |   0.5378 |            0.1 |                       0.1 |
| 03/04_16:29 |   92.2712 |   1.5379 |            0.1 |                       0.2 |
| 03/04_17:29 |  152.2757 |   2.5379 |            1.3 |                       1.5 |
| 03/04_18:29 |  212.2757 |   3.5379 |            0.0 |                       1.5 |
| 03/04_20:29 |  332.2757 |   5.5379 |            0.2 |                       1.7 |
| 03/04_22:29 |  452.2757 |   7.5379 |            0.1 |                       1.8 |
| 04/04_00:29 |  572.2824 |    9.538 |            0.4 |                       2.2 |
| 04/04_02:29 |  692.2824 |   11.538 |            0.5 |                       2.7 |
| 04/04_04:29 |  812.2825 |   13.538 |            0.2 |                       2.9 |
| 04/04_06:29 |  932.2824 |   15.538 |            0.1 |                       3.0 |
| 04/04_08:29 | 1052.2865 |  17.5381 |            0.5 |                       3.5 |
| 04/04_10:29 | 1172.2924 |  19.5382 |            0.0 |                       3.5 |
| 04/04_12:29 | 1292.2929 |  21.5382 |            0.1 |                       3.6 |
| 04/04_14:29 |  1412.293 |  23.5382 |            0.2 |                       3.8 |
| 04/04_16:29 | 1532.2929 |  25.5382 |            0.2 |                       4.0 |
| 04/04_18:29 | 1652.3113 |  27.5385 |            0.2 |                       4.2 |
| 04/04_20:29 | 1772.3141 |  29.5386 |            0.1 |                       4.3 |
| 04/04_22:29 | 1892.3154 |  31.5386 |           0.05 |                      4.35 |
| 05/04_00:29 | 2012.3105 |  33.5385 |           0.05 |                       4.4 |
| 05/04_02:29 | 2132.3114 |  35.5385 |           0.05 |                      4.45 |
| 05/04_04:29 | 2252.3144 |  37.5386 |            0.0 |                      4.45 |
| 05/04_06:29 | 2372.3151 |  39.5386 |            0.1 |                      4.55 |
| 05/04_08:29 |  2492.315 |  41.5386 |            0.1 |                      4.65 |
| 05/04_09:29 | 2552.3147 |  42.5386 |            0.0 |                      4.65 |
| 05/04_10:37 | 2620.5911 |  43.6765 |            0.0 |                      4.65 |
| 05/04_10:38 | 2621.5911 |  43.6932 |            0.0 |                      4.65 |
| 05/04_10:39 | 2622.5911 |  43.7099 |            0.1 |                      4.75 |
| 05/04_10:40 |  2623.568 |  43.7261 |            0.1 |                      4.85 |
| 05/04_11:40 | 2683.7432 |  44.7291 |            0.2 |                      5.05 |
| 05/04_12:40 |  2743.749 |  45.7292 |           0.05 |                       5.1 |
| 05/04_14:40 |  2863.749 |  47.7291 |            0.0 |                       5.1 |
| 05/04_16:40 | 2983.7494 |  49.7292 |            0.1 |                       5.2 |
| 05/04_18:40 | 3103.7554 |  51.7293 |            0.1 |                       5.3 |
| 05/04_20:40 | 3223.7562 |  53.7293 |            0.1 |                       5.4 |
| 05/04_22:40 | 3343.7588 |  55.7293 |            0.1 |                       5.5 |
| 06/04_00:40 | 3463.7624 |  57.7294 |            0.1 |                       5.6 |
| 06/04_02:40 | 3583.7627 |  59.7294 |            0.1 |                       5.7 |
| 06/04_04:40 | 3703.7626 |  61.7294 |            0.2 |                       5.9 |
| 06/04_06:40 |  3823.768 |  63.7295 |            0.2 |                       6.1 |
| 06/04_08:40 |   3943.77 |  65.7295 |            0.2 |                       6.3 |
| 06/04_10:40 | 4063.7699 |  67.7295 |            0.2 |                       6.5 |
| 06/04_12:40 | 4183.7779 |  69.7296 |            0.1 |                       6.6 |
| 06/04_14:40 | 4303.7782 |  71.7296 |           0.05 |                      6.65 |
| 06/04_16:40 | 4423.7808 |  73.7297 |           0.05 |                       6.7 |
| 06/04_18:40 | 4543.7815 |  75.7297 |            0.0 |                       6.7 |
| 06/04_20:40 | 4663.7816 |  77.7297 |           0.05 |                      6.75 |
| 06/04_22:40 | 4783.7816 |  79.7297 |            0.1 |                      6.85 |
| 07/04_00:40 | 4903.7918 |  81.7299 |            0.1 |                      6.95 |
| 07/04_02:40 | 5023.7924 |  83.7299 |            0.0 |                      6.95 |
| 07/04_04:40 | 5143.7925 |  85.7299 |           0.05 |                       7.0 |
| 07/04_06:40 | 5263.7924 |  87.7299 |            0.1 |                       7.1 |
| 07/04_08:40 | 5383.7944 |  89.7299 |            0.1 |                       7.2 |
| 07/04_10:40 | 5503.8038 |  91.7301 |            0.2 |                       7.4 |
| 07/04_12:40 | 5623.8058 |  93.7301 |            0.2 |                       7.6 |
| 07/04_14:40 | 5743.8073 |  95.7301 |            0.0 |                       7.6 |
| 07/04_16:40 | 5863.8086 |  97.7301 |            0.1 |                       7.7 |
| 07/04_18:40 | 5983.8149 |  99.7302 |            0.1 |                       7.8 |
| 07/04_20:40 | 6103.8161 | 101.7303 |            0.0 |                       7.8 |
| 07/04_22:40 | 6223.8172 | 103.7303 |            0.0 |                       7.8 |
| 08/04_00:40 | 6343.8343 | 105.7306 |            0.0 |                       7.8 |
| 08/04_02:40 | 6463.8355 | 107.7306 |            0.0 |                       7.8 |
| 08/04_04:40 | 6583.8267 | 109.7304 |            0.0 |                       7.8 |
| 08/04_06:40 |  6703.826 | 111.7304 |            0.0 |                       7.8 |
| 08/04_08:40 | 6823.8259 | 113.7304 |           0.05 |                      7.85 |
| 08/04_10:40 | 6943.8258 | 115.7304 |           0.05 |                       7.9 |


[[../plots/BMPs/Hydrolyzed FW/methane_kinetics_hydrolysate_2_s1_r2_hour.png]]

[[../plots/BMPs/Hydrolyzed FW/specific_methane_kinetics_hydrolysate_2_s1_r2_hour.png]]

** Sample 4
Το δείγμα 4 ήταν αυτό με τα 4 ml mix στην υδρόλυση. Είναι η μέγιστη ποσότητα που χρησιμοποιήθηκε για τα πειράματα χώνευσης καθώς το 8 ml δεν είχε ιδιαίτερα μεγάλη διαφορά και είναι πολύ πιο ακριβό. Όπως προαναφέρθηκε, αναμένουμε να έχει παρόμοια ποιότητα με το 2 ml καθώς με εξαίρεση μίας ποσότητας γαλακτικού είναι σχεδόν ίδια.

*hydrolysate_4_s1_r2*
#+NAME: hydrolysate_4_s1_r2
#+BEGIN_SRC julia :noweb no-export

   ### Data Analysis on Hydrolysate with 4 ml ###

   <<date_saving_fw_s1_r2>>

   inds = 3:69
   exp_meth_vol = [0, 0, 0, 0, 0.05, 0.1, 0.1, 0.3, 0.3, 0.3, 0.3, 0.3, 0.1, 0.2, 0.1, 0.1, 0.2, 0.1, 0.1, 0.05, 0.1, 0.2, 0.2, 0.1, 0.05, 0.1, 0.1, 0, 0, 0, 0, 0.1, 0.1, 0.2, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2, 0.1, 0.1, 0.2, 0.1, 0.2, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2, 0.1, 0.1, 0.1, 0.1, 0.1, 0.2, 0.2, 0.1, 0, 0, 0.05, 0.05, 0, 0.05, 0.1]
   meth_vol_hydro_4 = cumsum(exp_meth_vol)[end]
   exp_name = "hydrolysate_4_s1_r2"
   source = "Hydrolyzed FW"
   sample = "Sample 4"
   sludge = "Sludge 1"
   run_num = "Run 2"

   input_vs = 1.55

   <<bmp_data_processing>>

   p0 = [17.0, 15.0, 1.0]
   <<bmp_curve_fitting_min>>
   model_hydro_4_min = vcat(sample, round.(model_params, digits = 4), round(r_squared, digits = 3))
   <<bmp_data_plotting>>

   p0 = [17.0, 100.0, 0.1]
   <<bmp_curve_fitting_hour>>
   model_hydro_4_hour = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
   <<bmp_data_plotting>>

  <<sma_curve_fitting_hour>>
   sma_hydro_4 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
   <<bmp_data_plotting>>

   return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: hydrolysate_4_s1_r2
: "../data/exp_pro/hydrolysate_4_s1_r2.csv"

*** Results

#+NAME: hydrolysate_data_4_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<hydrolysate_4_s1_r2()>> '(4))
#+END_SRC

| Timestamp   |   Minutes |    Hours | Methane_Volume | Cumulative_Methane_Volume |
| 03/04_14:51 |       0.0 |      0.0 |            0.0 |                       0.0 |
| 03/04_14:56 |    5.0455 |   0.0841 |            0.0 |                       0.0 |
| 03/04_15:29 |   37.3164 |   0.6219 |            0.0 |                       0.0 |
| 03/04_16:29 |   97.3168 |   1.6219 |            0.0 |                       0.0 |
| 03/04_17:29 |  157.3212 |    2.622 |           0.05 |                      0.05 |
| 03/04_18:29 |  217.3212 |    3.622 |            0.1 |                      0.15 |
| 03/04_20:29 |  337.3212 |    5.622 |            0.1 |                      0.25 |
| 03/04_22:29 |  457.3212 |    7.622 |            0.3 |                      0.55 |
| 04/04_00:29 |  577.3279 |   9.6221 |            0.3 |                      0.85 |
| 04/04_02:29 |  697.3279 |  11.6221 |            0.3 |                      1.15 |
| 04/04_04:29 |   817.328 |  13.6221 |            0.3 |                      1.45 |
| 04/04_06:29 |  937.3279 |  15.6221 |            0.3 |                      1.75 |
| 04/04_08:29 |  1057.332 |  17.6222 |            0.1 |                      1.85 |
| 04/04_10:29 | 1177.3379 |  19.6223 |            0.2 |                      2.05 |
| 04/04_12:29 | 1297.3384 |  21.6223 |            0.1 |                      2.15 |
| 04/04_14:29 | 1417.3385 |  23.6223 |            0.1 |                      2.25 |
| 04/04_16:29 | 1537.3384 |  25.6223 |            0.2 |                      2.45 |
| 04/04_18:29 | 1657.3568 |  27.6226 |            0.1 |                      2.55 |
| 04/04_20:29 | 1777.3596 |  29.6227 |            0.1 |                      2.65 |
| 04/04_22:29 | 1897.3609 |  31.6227 |           0.05 |                       2.7 |
| 05/04_00:29 |  2017.356 |  33.6226 |            0.1 |                       2.8 |
| 05/04_02:29 | 2137.3569 |  35.6226 |            0.2 |                       3.0 |
| 05/04_04:29 | 2257.3599 |  37.6227 |            0.2 |                       3.2 |
| 05/04_06:29 | 2377.3606 |  39.6227 |            0.1 |                       3.3 |
| 05/04_08:29 | 2497.3605 |  41.6227 |           0.05 |                      3.35 |
| 05/04_09:29 | 2557.3602 |  42.6227 |            0.1 |                      3.45 |
| 05/04_10:37 | 2625.6366 |  43.7606 |            0.1 |                      3.55 |
| 05/04_10:38 | 2626.6366 |  43.7773 |            0.0 |                      3.55 |
| 05/04_10:39 | 2627.6366 |  43.7939 |            0.0 |                      3.55 |
| 05/04_10:40 | 2628.6134 |  43.8102 |            0.0 |                      3.55 |
| 05/04_11:40 | 2688.7887 |  44.8131 |            0.0 |                      3.55 |
| 05/04_12:40 | 2748.7945 |  45.8132 |            0.1 |                      3.65 |
| 05/04_14:40 | 2868.7944 |  47.8132 |            0.1 |                      3.75 |
| 05/04_16:40 | 2988.7949 |  49.8132 |            0.2 |                      3.95 |
| 05/04_18:40 | 3108.8008 |  51.8133 |            0.1 |                      4.05 |
| 05/04_20:40 | 3228.8017 |  53.8134 |            0.1 |                      4.15 |
| 05/04_22:40 | 3348.8043 |  55.8134 |            0.1 |                      4.25 |
| 06/04_00:40 |  3468.808 |  57.8135 |            0.1 |                      4.35 |
| 06/04_02:40 | 3588.8082 |  59.8135 |            0.1 |                      4.45 |
| 06/04_04:40 | 3708.8081 |  61.8135 |            0.1 |                      4.55 |
| 06/04_06:40 | 3828.8134 |  63.8136 |            0.2 |                      4.75 |
| 06/04_08:40 | 3948.8154 |  65.8136 |            0.1 |                      4.85 |
| 06/04_10:40 | 4068.8154 |  67.8136 |            0.1 |                      4.95 |
| 06/04_12:40 | 4188.8234 |  69.8137 |            0.2 |                      5.15 |
| 06/04_14:40 | 4308.8236 |  71.8137 |            0.1 |                      5.25 |
| 06/04_16:40 | 4428.8263 |  73.8138 |            0.2 |                      5.45 |
| 06/04_18:40 |  4548.827 |  75.8138 |            0.1 |                      5.55 |
| 06/04_20:40 | 4668.8271 |  77.8138 |            0.1 |                      5.65 |
| 06/04_22:40 | 4788.8271 |  79.8138 |            0.1 |                      5.75 |
| 07/04_00:40 | 4908.8373 |   81.814 |            0.1 |                      5.85 |
| 07/04_02:40 | 5028.8379 |   83.814 |            0.1 |                      5.95 |
| 07/04_04:40 |  5148.838 |   85.814 |            0.2 |                      6.15 |
| 07/04_06:40 | 5268.8379 |   87.814 |            0.1 |                      6.25 |
| 07/04_08:40 | 5388.8399 |   89.814 |            0.1 |                      6.35 |
| 07/04_10:40 | 5508.8493 |  91.8142 |            0.1 |                      6.45 |
| 07/04_12:40 | 5628.8513 |  93.8142 |            0.1 |                      6.55 |
| 07/04_14:40 | 5748.8528 |  95.8142 |            0.1 |                      6.65 |
| 07/04_16:40 | 5868.8541 |  97.8142 |            0.2 |                      6.85 |
| 07/04_18:40 | 5988.8604 |  99.8143 |            0.2 |                      7.05 |
| 07/04_20:40 | 6108.8616 | 101.8144 |            0.1 |                      7.15 |
| 07/04_22:40 | 6228.8628 | 103.8144 |            0.0 |                      7.15 |
| 08/04_00:40 | 6348.8798 | 105.8147 |            0.0 |                      7.15 |
| 08/04_02:40 |  6468.881 | 107.8147 |           0.05 |                       7.2 |
| 08/04_04:40 | 6588.8722 | 109.8145 |           0.05 |                      7.25 |
| 08/04_06:40 | 6708.8714 | 111.8145 |            0.0 |                      7.25 |
| 08/04_08:40 | 6828.8714 | 113.8145 |           0.05 |                       7.3 |
| 08/04_10:40 | 6948.8713 | 115.8145 |            0.1 |                       7.4 |


[[../plots/BMPs/Hydrolyzed FW/methane_kinetics_hydrolysate_4_s1_r2_hour.png]]

[[../plots/BMPs/Hydrolyzed FW/specific_methane_kinetics_hydrolysate_4_s1_r2_hour.png]]

** Untreated FW
Εκτός από τα παραπάνω, σε ένα από τα δοχεία προστέθηκε ανεπεξέργαστο FW. Αυτό έχει διαφορά από το δείγμα 0, καθώς εκείνο υπέστει ζύμωση κατά τις 72 ώρες που ήταν στους 40 \( ^oC \) ακόμη και χωρίς να προσθέσουμε κάποιο εμβόλιο, ενώ το δείγμα αυτό αναφέρεται σε food waste το οποίο δεν έχει υποστεί καμία επεξεργασία. Θα θέλαμε το δείγμα αυτό να έχει το χειρότερο performance (είτε πολύ αργή παραγωγή, ή μικρή τελική παραγωγή), το οποίο θα μας επιδείκνυε πως η επεξεργασία που έγινε βοηθάει πραγματικά στην χώνευση. Βέβαια, αξίζει να αναφερθεί πως το δοχείο αυτό είχε κάποιο προβλήματα με διαρροή στα αρχικά στάδια του πειράματος, οπότε ενδέχεται τα αποτελέσματα που θα προκύψουν να μην είναι έγκυρα. Παρακάτω φαίνεται ο κώδικας επεξεργασίας των αποτελεσμάτων του.

*untreated_fw_s1_r2*
#+NAME: untreated_fw_s1_r2
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Untreated FW ###
  <<date_saving_fw_s1_r2>>

  inds = 33:62
  exp_meth_vol = [0, 0.1, 0.2, 0.2, 0.1, 0.1, 0.1, 0.1, 0.1, 0.05, 0.05, 0, 0, 0.2, 0.2, 0.1, 0.1, 0.1, 0, 0.1, 0.1, 0.1, 0.1, 0, 0.1, 0.05, 0, 0, 0, 0]
  meth_vol_hydro_fw = cumsum(exp_meth_vol)[end]
  exp_name = "untreated_fw_s1_r2"
  source = "Untreated FW"
  sample = "FW"
  sludge = "Sludge 1"
  run_num = "Run 2"

  input_vs = 1.55

  <<bmp_data_processing>>

  p0 = [2.5, 0.05, 1.0]
  <<bmp_curve_fitting_min>>
  model_hydro_fw_min = vcat(sample, round.(model_params, digits = 4), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [2.5, 9e-3, 0.1]
  <<bmp_curve_fitting_hour>>
  model_hydro_fw_hour = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_hour>>
  sma_hydro_fw = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")

#+END_SRC

#+RESULTS: untreated_fw_s1_r2
: "../data/exp_pro/untreated_fw_s1_r2.csv"

*** Results

#+NAME: untreated_fw_data_0_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 3 <<untreated_fw_s1_r2()>> '(4))
#+END_SRC

| Timestamp   |   Minutes |   Hours | Methane_Volume | Cumulative_Methane_Volume |
| 05/04_11:40 |       0.0 |     0.0 |            0.0 |                       0.0 |
| 05/04_12:40 |   60.0058 |  1.0001 |            0.1 |                       0.1 |
| 05/04_14:40 |  180.0058 |  3.0001 |            0.2 |                       0.3 |
| 05/04_16:40 |  300.0062 |  5.0001 |            0.2 |                       0.5 |
| 05/04_18:40 |  420.0122 |  7.0002 |            0.1 |                       0.6 |
| 05/04_20:40 |   540.013 |  9.0002 |            0.1 |                       0.7 |
| 05/04_22:40 |  660.0156 | 11.0003 |            0.1 |                       0.8 |
| 06/04_00:40 |  780.0193 | 13.0003 |            0.1 |                       0.9 |
| 06/04_02:40 |  900.0195 | 15.0003 |            0.1 |                       1.0 |
| 06/04_04:40 | 1020.0194 | 17.0003 |           0.05 |                      1.05 |
| 06/04_06:40 | 1140.0248 | 19.0004 |           0.05 |                       1.1 |
| 06/04_08:40 | 1260.0268 | 21.0004 |            0.0 |                       1.1 |
| 06/04_10:40 | 1380.0267 | 23.0004 |            0.0 |                       1.1 |
| 06/04_12:40 | 1500.0347 | 25.0006 |            0.2 |                       1.3 |
| 06/04_14:40 |  1620.035 | 27.0006 |            0.2 |                       1.5 |
| 06/04_16:40 | 1740.0376 | 29.0006 |            0.1 |                       1.6 |
| 06/04_18:40 | 1860.0382 | 31.0006 |            0.1 |                       1.7 |
| 06/04_20:40 | 1980.0384 | 33.0006 |            0.1 |                       1.8 |
| 06/04_22:40 | 2100.0384 | 35.0006 |            0.0 |                       1.8 |
| 07/04_00:40 | 2220.0486 | 37.0008 |            0.1 |                       1.9 |
| 07/04_02:40 | 2340.0492 | 39.0008 |            0.1 |                       2.0 |
| 07/04_04:40 | 2460.0493 | 41.0008 |            0.1 |                       2.1 |
| 07/04_06:40 | 2580.0492 | 43.0008 |            0.1 |                       2.2 |
| 07/04_08:40 | 2700.0512 | 45.0009 |            0.0 |                       2.2 |
| 07/04_10:40 | 2820.0606 |  47.001 |            0.1 |                       2.3 |
| 07/04_12:40 | 2940.0626 |  49.001 |           0.05 |                      2.35 |
| 07/04_14:40 | 3060.0641 | 51.0011 |            0.0 |                      2.35 |
| 07/04_16:40 | 3180.0654 | 53.0011 |            0.0 |                      2.35 |
| 07/04_18:40 | 3300.0717 | 55.0012 |            0.0 |                      2.35 |
| 07/04_20:40 | 3420.0729 | 57.0012 |            0.0 |                      2.35 |


[[../plots/BMPs/Untreated FW/methane_kinetics_untreated_fw_s1_r2_hour.png]]

[[../plots/BMPs/Untreated FW/specific_methane_kinetics_untreated_fw_s1_r2_hour.png]]

** Update all
Όπως και για τα προηγούμενα, θα υπάρχει και ένα code block το οποίο θα κάνει update όλα τα code blocks, θα τα κάνει tangle σε ένα script file και θα αποθηκεύει ένα CSV με όλα τα κινητικά αποτελέσματα.

*update_hydrolysate_tests_s1_r2*
#+NAME: update_hydrolysate_tests_s1_r2
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_fw_hydrolysate_s1_r2_analysis.jl

  <<hydrolysate_0_s1_r2>>
  <<hydrolysate_1_s1_r2>>
  <<hydrolysate_2_s1_r2>>
  <<hydrolysate_4_s1_r2>>
  <<untreated_fw_s1_r2>>

  model_fit_table_min = Tables.table(vcat(reshape(model_hydro_0_min, 1, 5), reshape(model_hydro_1_min, 1, 5), reshape(model_hydro_2_min, 1, 5), reshape(model_hydro_4_min, 1, 5), reshape(model_hydro_fw_min, 1, 5)), header = [:Sample_Name, :Production_Potential, :Production_Rate, :Lag_Time, :R_squared])
  CSV.write(datadir("exp_pro", "methane_from_hydrolysate_kinetics_min_s1_r2.csv"), model_fit_table_min)

  model_fit_table_hour = Tables.table(vcat(reshape(model_hydro_0_hour, 1, 5), reshape(model_hydro_1_hour, 1, 5), reshape(model_hydro_2_hour, 1, 5), reshape(model_hydro_4_hour, 1, 5), reshape(model_hydro_fw_hour, 1, 5)), header = [:Sample_Name, :Production_Potential, :Production_Rate, :Lag_Time, :R_squared])
  CSV.write(datadir("exp_pro", "methane_from_hydrolysate_kinetics_hour_s1_r2.csv"), model_fit_table_hour)
  return("../data/exp_pro/methane_from_hydrolysate_kinetics_min_s1_r2.csv")
#+END_SRC

#+RESULTS: update_hydrolysate_tests_s1_r2
: "../data/exp_pro/methane_from_hydrolysate_kinetics_min_s1_r2.csv"

#+NAME: hydrolysate_kinetic_name_hour_s1_r2
#+BEGIN_SRC julia
  return("../data/exp_pro/methane_from_hydrolysate_kinetics_hour_s1_r2.csv")
#+END_SRC

#+NAME: hydrolysate_kinetics_hour_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<hydrolysate_kinetic_name_hour_s1_r2()>> '(4))
#+END_SRC

#+CAPTION: Kinetics with timescale in hours
| Sample_Name | Production_Potential | Production_Rate | Lag_Time | R_squared |
| Sample 0    |                3.758 |           0.043 |    3.763 |     0.991 |
| Sample 1    |               10.428 |           0.108 |    4.507 |     0.995 |
| Sample 2    |                7.846 |           0.114 |      0.0 |     0.927 |
| Sample 4    |                8.367 |            0.08 |    0.265 |     0.986 |
| FW          |                2.746 |           0.054 |      0.0 |     0.977 |

#+NAME: hydrolysate_kinetics_min_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<update_hydrolysate_tests_s1_r2()>> '(4))
#+END_SRC

#+CAPTION: Kinetics with timescale in minutes
| Sample_Name | Production_Potential | Production_Rate | Lag_Time | R_squared |
| Sample 0    |               3.7583 |          0.0007 | 225.8032 |     0.991 |
| Sample 1    |               10.428 |          0.0018 |  270.399 |     0.995 |
| Sample 2    |               7.6924 |          0.0021 |      0.0 |     0.933 |
| Sample 4    |               8.3675 |          0.0013 |  15.9101 |     0.986 |
| FW          |                2.691 |          0.0009 |      0.0 |     0.982 |

#+NAME: sma_hydro_s1_r2
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_fw_hydrolysate_s1_r2_analysis.jl

  <<hydrolysate_0_s1_r2>>
  <<hydrolysate_1_s1_r2>>
  <<hydrolysate_2_s1_r2>>
  <<hydrolysate_4_s1_r2>>
  <<untreated_fw_s1_r2>>

  sma_table = Tables.table(vcat(reshape(sma_hydro_0, 1, 5), reshape(sma_hydro_1, 1, 5), reshape(sma_hydro_2, 1, 5), reshape(sma_hydro_4, 1, 5), reshape(sma_hydro_fw, 1, 5)), header = [:Sample_Name, :Methane_Potential, :SMA, :Lag_Time, :R_sq])
  CSV.write(datadir("exp_pro", "sma_from_hydrolysate_s1_r2.csv"), sma_table)

  return("../data/exp_pro/sma_from_hydrolysate_s1_r2.csv")
#+END_SRC

#+RESULTS: sma_hydro_s1_r2
: "../data/exp_pro/sma_from_hydrolysate_s1_r2.csv"

#+NAME: acet_sma_data_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<sma_hydro_s1_r2()>> '(4))
#+END_SRC

#+CAPTION: SMA Kinetics in hours
| Sample_Name | Methane_Potential |   SMA | Lag_Time |  R_sq |
| Sample 0    |             2.425 | 0.028 |    3.763 | 0.991 |
| Sample 1    |             6.952 | 0.072 |    4.507 | 0.995 |
| Sample 2    |             5.062 | 0.074 |      0.0 | 0.927 |
| Sample 4    |             5.398 | 0.051 |    0.265 | 0.986 |
| FW          |             1.772 | 0.035 |      0.0 | 0.977 |

*** Σύγκριση με το προηγούμενο πείραμα
Γενικά, το 2ο πείραμα αυτό είναι συγκρίσιμο με το προηγούμενο, παρότι όχι ίδιο. Το πρώτο πείραμα έχει γενικά πιο γρήγορους ρυθμούς (κοντά σε 1.5 με 2 φορές αυτά). Επίσης, το πρώτο πείραμα έχει μηδενικό lag time σε όλα τα πειράματα, ενώ σε αυτό το πείραμα, 3 από τα 5 δείγματα είχαν κάποιο lag time και 2 από αυτά ήταν μάλιστα αρκετά σημαντικά.

Από άποψη παραγωγής μεθανίου, δεν υπάρχει κάποια ξεκάθαρη τάση. Σε κάποια δείγματα το ένα πείραμα παρήγαγε λίγο περισσότερο, σε κάποιες το άλλο. Αλλά, είναι γενικά κοντά, το οποίο είναι καλό.

** Plotting Methane Potential
Σε αυτό το section θα γίνει ένα plot το οποίο θα συγκρίνει μέγιστο μεθάνιο (παραγωγή από οξικό) με αυτό που παράχθηκε από το FW. Θα γίνει με την ίδια λογική που έγινε και παραπάνω για το πρώτο run.

#+NAME: BMP_data_collection_s1_r2
#+BEGIN_SRC julia :noweb no-export

  <<update_acetate_tests_s1>>
  <<update_hydrolysate_tests_s1_r2>>

  comp_name = "s1_r2"
  sludge = "Sludge 1 "
  run = "Run 2"
  <<BMP_comp_plot>>
#+END_SRC

#+RESULTS: BMP_data_collection_s1_r2
: CairoMakie.Screen{IMAGE}

#+ATTR_ORG: :width 900px
[[../plots/BMPs/Hydrolyzed FW/acet_vs_hydro_bmp_s1_r2.png]]

*** Σύγκριση με τον προηγούμενο κύκλο
Παρατηρούμε πως τα αποτελέσματα του πειράματος αυτού είναι αρκετά κοντά σε αυτά του προηγούμενου που δείχνει πως υπάρχει μία επαναληψιμότητα. Ακολουθείται η ίδια ακριβώς τάση 1 > 2 > 4 στα 3 πρώτα, ενώ το FW με το 0 έχουν εναλλαγεί στο πείραμα αυτό (βέβαια, έχουν και τα δύο πολύ χαμηλά αποτελέσματα οπότε μεταξύ τους σύγκριση δεν μας πειράζει). Βλέπουμε πως με μία εξαίρεση, οι αποκλίσεις είναι της τάξης του \(  3 \% \) και ακόμη και εκείνη είναι \( 6 \% \) το οποίο είναι σχετικά καλό. 

** Kinetic Comparison
#+NAME: kinetics_comp_s1_r2
#+BEGIN_SRC julia :noweb no-export

  <<update_acetate_tests_s1>>
  <<update_hydrolysate_tests_s1_r2>>

  sludge = "s1"
  run = "r2"
  timescale = "hour"

  <<ad_kinetics_comparison>>
  return("../data/exp_pro/kinetics_comparison_s1_r2.csv")
#+END_SRC

#+RESULTS: kinetics_comp_s1_r2
: "../data/exp_pro/kinetics_comparison_s1_r2.csv"

#+NAME: sma_comp_s1_r2
#+BEGIN_SRC julia
  return("../data/exp_pro/kinetics_comparison_sma_s1_r2.csv")
#+END_SRC

#+NAME: kinetic_data_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<kinetics_comp_s1_r2()>> '(4))
#+END_SRC

#+CAPTION: Kinetic Comparison with timescale in hours
| Sample_Name | Acetate | Hydrolysate |  Ratio |
| Sample 0    |  459.84 |       0.043 | 0.0094 |
| Sample 1    |  326.88 |       0.108 |  0.033 |
| Sample 2    |  374.04 |       0.114 | 0.0305 |
| Sample 4    |   579.0 |        0.08 | 0.0138 |
| Sample FW   |  294.06 |       0.054 | 0.0184 |

#+NAME: kinetic_sma_data_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<sma_comp_s1_r2()>> '(4))
#+END_SRC

#+CAPTION: SMA Comparison with timescale in days
| Sample_Name | Acetate | Hydrolysate |  Ratio |
| Sample 0    | 7119.36 |       0.672 | 0.0094 |
| Sample 1    |  5061.6 |       1.728 | 0.0341 |
| Sample 2    | 5676.48 |       1.776 | 0.0313 |
| Sample 4    | 8965.44 |       1.224 | 0.0137 |
| Sample FW   | 4554.72 |        0.84 | 0.0184 |

** Συμπεράσματα από τον κύκλο πειραμάτων αυτών
Ο κύκλος αυτός ήταν αρκετά χρήσιμος επειδή μας έδειξε πως τα προηγούμενα αποτελέσματα έχουν σχετικά καλή επαναληψιμότητα καθώς και στους ρυθμούς αλλά και στην τελική παραγωγή μεθανίου, οι δύο κύκλοι είχαν παρόμοια αποτελέσματα. Το πείραμα δεν είναι τέλεια επαναλήψιμο, αλλά υπάρχουν αρκετές ομοιότητες.

Το μοντέλο Gompertz μπορεί να χρησιμοποιηθεί αποτελεσματικά για την κινητική ανάλυση της αναερόβιας χώνευσης καθώς έχει πολύ καλή προσαρμογή στα πειράματα και προβλέπει όλες τις φάσεις της μικροβιακής ανάπτυξης. Βέβαια, σε πολλές περιπτώσεις, παρόλο που το μοντέλο μπορεί να προβλέψει μία στάσιμη φάση, η διάρκεια της βγάινει ίση με 0, το οποίο σημαίνει πως η λάσπη αντιδρά πολύ γρήγορα στην προσθήκη του υποστρώματος αυτού. Πιθανή αιτία είναι πως όλα τα υποστρώματα έχουν κάποια ποσότητα οξικού οξέος, το οποίο ως η ιδανική τροφή της λάσπης καταναλώνεται αμέσως.

Από την άποψη των BMPs, η σειρά είναι 0 > FW > 4 > 2 > 1 (ίδια σειρά με πριν με εξαίρεση την αλλαγή του FW με το 0). Το FW και το 0 είναι πάλι και τα 2 πολύ χαμηλά, το οποίο κάνει ξανά validate ότι η προεπεξεργασία που επιλέχθηκε είναι αρκετά αποτελεσματική Το δείγμα 1 έχει και πάλι την περισσότερη ποσότητα μεθανίου. Αυτό δεν μπορεί να αιτιολογηθεί εύκολα από τα αποτελέσματα του αρχικού πειράματος υδρόλυσης σε αυτές τις συνθήκες, αλλά η αναπάντεχα μεγάλη συγκέντρωση sCOD του, οδηγεί στο συμπέρασμα της καλύτερης διαλυτοποίησης σε αυτό το πείραμα και πιθανόν αυτό να ευθύνεται για την αυξημένη παραγωγή μεθανίου.

* Acetate Experiment Processing S2
Παρακάτω αναφέρονται οι δοκιμές που έγιναν με 100 μL οξικό σε κάθε δείγμα και θα χρησιμοποιηθούν συγκριτικά σε σχέση με τα FW. Μετά από τα code blocks που τρέχουν τον κώδικα θα υπάρχουν και κάποια από τα corresponding αποτελέσματα. Συγκεκριμένα, ο πίνακας με τα κινητικά δεδομένα και το διάγραμμα παραγωγής μεθανίου το οποίο έχει το curve fitting. Υπάρχουν και κάποια άλλα χρήσιμα διαγράμματα, τα οποία είναι αποθηκευμένα, αλλά εδώ παρατίθενται κάποια για καλύτερη ανάγνωση του αρχείου.

Το section αυτό αφορά την χρήση της 2ης λάσπης.

** Acetate Test FW
Το section αυτό αναφέρεται στη δοκιμή με 100 μL οξικό στο δείγμα labelled ως FW (στο οποίο θα τροφοδοτηθούν untreated FW). Notably, δεν είχε διαρροή στις 27/03, αλλά για κάποιον λόγο, στην επαναδοκιμή στις 29/03 δεν παρήγαγε μεθάνιο (τουλάχιστον στην προχοίδα). Οπότε, θα χρησιμοποιηθεί αυτό της 27/03.

*acet_test_fw_s2*
#+NAME: acet_test_fw_s2
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Sample FW ###

  <<date_saving_acetate_s2>>

  inds = 1:16
  exp_meth_vol = [0, 1.0, 5.0, 3.0, 1.5, 2.0, 0.5, 1.0, 0.5, 0, 0, 0, 0, 0, 0, 0]
  meth_vol_acet_fw = cumsum(exp_meth_vol)[end]
  exp_name = "acet_test_fw_s2"
  source = "Acetate"
  sample = "Sample FW"
  sludge = "Sludge 2"
  input_vs = 4.2

  p0 = [25.0, 6.0, 1.0]
  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_acet_fw = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_min>>
  sma_acet_fw = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))  
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: acet_test_FW_s2
: "../data/exp_pro/acet_test_fw_s2.csv"

#+NAME: acet_data_fw_s2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<acet_test_fw_s2()>> '(4))
#+END_SRC

#+CAPTION: Κινητικά δεδομένα
| Timestamp   | Seconds | Minutes | Methane_Volume | Cumulative_Methane_Volume |
| 10/04_13:59 |     0.0 |     0.0 |            0.0 |                       0.0 |
| 10/04_14:00 |  53.787 |  0.8964 |            1.0 |                       1.0 |
| 10/04_14:01 | 113.801 |  1.8967 |            5.0 |                       6.0 |
| 10/04_14:02 | 151.446 |  2.5241 |            3.0 |                       9.0 |
| 10/04_14:03 | 211.446 |  3.5241 |            1.5 |                      10.5 |
| 10/04_14:04 | 259.738 |   4.329 |            2.0 |                      12.5 |
| 10/04_14:05 | 317.119 |  5.2853 |            0.5 |                      13.0 |
| 10/04_14:06 | 377.141 |  6.2857 |            1.0 |                      14.0 |
| 10/04_14:07 | 437.131 |  7.2855 |            0.5 |                      14.5 |
| 10/04_14:07 |  455.72 |  7.5953 |            0.0 |                      14.5 |
| 10/04_14:08 | 515.711 |  8.5952 |            0.0 |                      14.5 |
| 10/04_14:08 | 543.733 |  9.0622 |            0.0 |                      14.5 |
| 10/04_14:09 | 603.728 | 10.0621 |            0.0 |                      14.5 |
| 10/04_14:10 | 663.726 | 11.0621 |            0.0 |                      14.5 |
| 10/04_14:11 | 723.748 | 12.0625 |            0.0 |                      14.5 |
| 10/04_14:12 | 783.759 | 13.0626 |            0.0 |                      14.5 |

[[../plots/BMPs/Acetate/methane_kinetics_acet_test_fw_s2_min.png]]

[[../plots/BMPs/Acetate/specific_methane_kinetics_acet_test_fw_s2.png]]

** Acetate Test 0
Το section αυτό αναφέρεται στη δοκιμή με 100 μL οξικό στο δείγμα (0).

*acet_test_0_s2*
#+NAME: acet_test_0_s2
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Sample 0 ###

  <<date_saving_acetate_s2>>

  inds = 12:21
  exp_meth_vol = [0, 10.5, 1.0, 0.5, 0, 0, 0, 0, 0, 0]
  meth_vol_acet_0 = cumsum(exp_meth_vol)[end]
  exp_name = "acet_test_0_s2"
  source = "Acetate"
  sample = "Sample 0"
  sludge = "Sludge 2"
  input_cod = 4.2
  p0 = [40.0, 8.0, 1.0]

  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_acet_0 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_min>>
  sma_acet_0 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))  
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: acet_test_0_s2
: "../data/exp_pro/acet_test_0_s2.csv"

#+NAME: acet_data_0_s2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<acet_test_0_s2()>> '(4))
#+END_SRC

#+CAPTION: Κινητικά δεδομένα
| Timestamp   | Seconds | Minutes | Methane_Volume | Cumulative_Methane_Volume |
| 10/04_14:08 |     0.0 |     0.0 |            0.0 |                       0.0 |
| 10/04_14:09 |  59.995 |  0.9999 |           10.5 |                      10.5 |
| 10/04_14:10 | 119.993 |  1.9999 |            1.0 |                      11.5 |
| 10/04_14:11 | 180.015 |  3.0002 |            0.5 |                      12.0 |
| 10/04_14:12 | 240.026 |  4.0004 |            0.0 |                      12.0 |
| 10/04_14:13 | 300.038 |  5.0006 |            0.0 |                      12.0 |
| 10/04_14:14 | 360.043 |  6.0007 |            0.0 |                      12.0 |
| 10/04_14:15 | 420.041 |  7.0007 |            0.0 |                      12.0 |
| 10/04_14:16 | 480.031 |  8.0005 |            0.0 |                      12.0 |
| 10/04_14:17 | 540.042 |  9.0007 |            0.0 |                      12.0 |

[[../plots/BMPs/Acetate/methane_kinetics_acet_test_0_s2_min.png]]

[[../plots/BMPs/Acetate/specific_methane_kinetics_acet_test_0_s2.png]]

** Acetate Test 1
Το section αυτό αναφέρεται στη δοκιμή με 100 μL οξικό στο δείγμα (1). Aξίζει να αναφερθεί πως την πρώτη πειραματική ημέρα (27/03), παρήγαγε αέριο χωρίς να τροφοδοτηθεί με κάποιο υπόστρωμα. Η κινητική αυτής της παραγωγής (η οποία δεν ξέρουμε σε τι ευθύνεται) θα αναλυθεί παρακάτω. Βέβαια, μόλις τροφοδοτήθηκε με οξικό και η παραγωγή του τελείωσε, σταμάτησε και εκείνη η παραγωγή. Βέβαια, είχε την χαμηλότερη παραγωγή βιοαερίου μόλις τροφοδοτήθηκε με οξικό, οπότε ενδέχεται αυτή η μέτρηση να ήταν προβληματική.

*acet_test_1_s2*
#+NAME: acet_test_1_s2
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Sample 1 ###

  <<date_saving_acetate_s2>>

  inds = 7:21
  exp_meth_vol = [0, 7, 2, 0.2, 0.8, 0.2, 1.5, 0, 0, 0, 0, 0, 0, 0, 0]
  meth_vol_acet_1 = cumsum(exp_meth_vol)[end]
  exp_name = "acet_test_1_s2"
  source = "Acetate"
  sample = "Sample 1"
  sludge = "Sludge 2"
  input_vs = 4.2
  p0 = [20.0, 4.0, 1.0]

  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_acet_1 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_min>>
  sma_acet_1 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))  
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: acet_test_1_s2
: "../data/exp_pro/acet_test_1_s2.csv"

#+NAME: acet_data_1_s2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<acet_test_1_s2()>> '(4))
#+END_SRC

#+CAPTION: Κινητικά δεδομένα
| Timestamp   | Seconds | Minutes | Methane_Volume | Cumulative_Methane_Volume |
| 10/04_14:05 |     0.0 |     0.0 |            0.0 |                       0.0 |
| 10/04_14:06 |  60.022 |  1.0004 |            7.0 |                       7.0 |
| 10/04_14:07 | 120.012 |  2.0002 |            2.0 |                       9.0 |
| 10/04_14:07 | 138.601 |    2.31 |            0.2 |                       9.2 |
| 10/04_14:08 | 198.592 |  3.3099 |            0.8 |                      10.0 |
| 10/04_14:08 | 226.614 |  3.7769 |            0.2 |                      10.2 |
| 10/04_14:09 | 286.609 |  4.7768 |            1.5 |                      11.7 |
| 10/04_14:10 | 346.607 |  5.7768 |            0.0 |                      11.7 |
| 10/04_14:11 | 406.629 |  6.7772 |            0.0 |                      11.7 |
| 10/04_14:12 |  466.64 |  7.7773 |            0.0 |                      11.7 |
| 10/04_14:13 | 526.652 |  8.7775 |            0.0 |                      11.7 |
| 10/04_14:14 | 586.657 |  9.7776 |            0.0 |                      11.7 |
| 10/04_14:15 | 646.655 | 10.7776 |            0.0 |                      11.7 |
| 10/04_14:16 | 706.645 | 11.7774 |            0.0 |                      11.7 |
| 10/04_14:17 | 766.656 | 12.7776 |            0.0 |                      11.7 |

[[../plots/BMPs/Acetate/methane_kinetics_acet_test_1_s2_min.png]]

[[../plots/BMPs/Acetate/specific_methane_kinetics_acet_test_1_s2.png]]

** Acetate Test 2
Το section αυτό αναφέρεται στη δοκιμή με 100 μL οξικό στο δείγμα (2).

*acet_test_2_s2*
#+NAME: acet_test_2_s2
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Sample 2 ###

  <<date_saving_acetate_s2>>

  inds = 4:21
  exp_meth_vol = [0, 3.5, 3, 1, 1, 1, 0.2, 0.4, 0.4, 2, 0, 0, 0, 0, 0, 0, 0, 0]
  meth_vol_acet_2 = cumsum(exp_meth_vol)[end]
  exp_name = "acet_test_2_s2"
  source = "Acetate"
  sample = "Sample 2"
  sludge = "Sludge 2"
  input_cod = 4.2
  p0 = [30.0, 6.0, 1.0]

  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_acet_2 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  p0 = [7.1, 1.43, 1.0]
  <<sma_curve_fitting_min>>
  sma_acet_2 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))  
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: acet_test_2_s2
: "../data/exp_pro/acet_test_2_s2.csv"

#+NAME: acet_data_2_s2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<acet_test_2_s2()>> '(4))
#+END_SRC

#+CAPTION: Κινητικά Δεδομένα
| Timestamp   | Seconds | Minutes | Methane_Volume | Cumulative_Methane_Volume |
| 10/04_14:02 |     0.0 |     0.0 |            0.0 |                       0.0 |
| 10/04_14:03 |    60.0 |     1.0 |            3.5 |                       3.5 |
| 10/04_14:04 | 108.292 |  1.8049 |            3.0 |                       6.5 |
| 10/04_14:05 | 165.673 |  2.7612 |            1.0 |                       7.5 |
| 10/04_14:06 | 225.695 |  3.7616 |            1.0 |                       8.5 |
| 10/04_14:07 | 285.685 |  4.7614 |            1.0 |                       9.5 |
| 10/04_14:07 | 304.274 |  5.0712 |            0.2 |                       9.7 |
| 10/04_14:08 | 364.265 |  6.0711 |            0.4 |                      10.1 |
| 10/04_14:08 | 392.287 |  6.5381 |            0.4 |                      10.5 |
| 10/04_14:09 | 452.282 |   7.538 |            2.0 |                      12.5 |
| 10/04_14:10 |  512.28 |   8.538 |            0.0 |                      12.5 |
| 10/04_14:11 | 572.302 |  9.5384 |            0.0 |                      12.5 |
| 10/04_14:12 | 632.313 | 10.5386 |            0.0 |                      12.5 |
| 10/04_14:13 | 692.325 | 11.5388 |            0.0 |                      12.5 |
| 10/04_14:14 |  752.33 | 12.5388 |            0.0 |                      12.5 |
| 10/04_14:15 | 812.328 | 13.5388 |            0.0 |                      12.5 |
| 10/04_14:16 | 872.318 | 14.5386 |            0.0 |                      12.5 |
| 10/04_14:17 | 932.329 | 15.5388 |            0.0 |                      12.5 |

[[../plots/BMPs/Acetate/methane_kinetics_acet_test_2_s2_min.png]]

[[../plots/BMPs/Acetate/specific_methane_kinetics_acet_test_2_s2.png]]

** Acetate Test 4
Το section αυτό αναφέρεται στη δοκιμή με 100 μL οξικό στο δείγμα (4).

*acet_test_4_s2*
#+NAME: acet_test_4_s2
#+BEGIN_SRC julia :noweb no-export

  ### Data Analysis on Sample 4 ###

  <<date_saving_acetate_s2>>

  inds = 10:21
  exp_meth_vol = [0, 5.5, 2.0, 1.5, 0.5, 0, 0, 0, 0, 0, 0, 0]
  meth_vol_acet_4 = cumsum(exp_meth_vol)[end]
  exp_name = "acet_test_4_s2"
  source = "Acetate"
  sample = "Sample 4"
  sludge = "Sludge 2"
  input_vs = 4.2
  p0 = [40.0, 10.0, 1.0]

  <<bmp_data_processing>>
  <<bmp_curve_fitting_min>>
  model_acet_4 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))
  <<bmp_data_plotting>>

  <<sma_curve_fitting_min>>
  sma_acet_4 = vcat(sample, round.(model_params, digits = 3), round(r_squared, digits = 3))  
  <<bmp_data_plotting>>

  return("../data/exp_pro/"*exp_name*".csv")
#+END_SRC

#+RESULTS: acet_test_4_s2
: "../data/exp_pro/acet_test_4_s2.csv"

#+NAME: acet_data_4_s2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<acet_test_4_s2()>> '(4))
#+END_SRC

#+CAPTION: Κινητικά δεδομένα
| Timestamp   | Seconds | Minutes | Methane_Volume | Cumulative_Methane_Volume |
| 10/04_14:07 |     0.0 |     0.0 |            0.0 |                       0.0 |
| 10/04_14:08 |  59.991 |  0.9998 |            5.5 |                       5.5 |
| 10/04_14:08 |  88.013 |  1.4669 |            2.0 |                       7.5 |
| 10/04_14:09 | 148.008 |  2.4668 |            1.5 |                       9.0 |
| 10/04_14:10 | 208.006 |  3.4668 |            0.5 |                       9.5 |
| 10/04_14:11 | 268.028 |  4.4671 |            0.0 |                       9.5 |
| 10/04_14:12 | 328.039 |  5.4673 |            0.0 |                       9.5 |
| 10/04_14:13 | 388.051 |  6.4675 |            0.0 |                       9.5 |
| 10/04_14:14 | 448.056 |  7.4676 |            0.0 |                       9.5 |
| 10/04_14:15 | 508.054 |  8.4676 |            0.0 |                       9.5 |
| 10/04_14:16 | 568.044 |  9.4674 |            0.0 |                       9.5 |
| 10/04_14:17 | 628.055 | 10.4676 |            0.0 |                       9.5 |

[[../plots/BMPs/Acetate/methane_kinetics_acet_test_4_s2_min.png]]

[[../plots/BMPs/Acetate/specific_methane_kinetics_acet_test_4_s2.png]]

** Update all helper
Σε αυτό το section θα υπάρχει ένα helper code block που θα κάνει evaluate όλα τα παραπάνω. Έτσι, αν αλλάξει κάτι το οποίο επηρεάζει περισσότερα από ένα code blocks, θα μπορούν να γίνουν updated ταυτόχρονα πιο εύκολα. Επίσης, μία επιπλέον χρησιμότητα του code block αυτού είναι ότι αποθηκεύει ένα CSV που συγκεντρώνει όλα τα δεδομένα των κινητικών παραμέτρων από την προσαρμογή που έγινε παραπάνω, το οποίο είναι χρήσιμο για συγκρίσεις, παρόλο που τα συγκεκριμένα πειράματα δεν είναι τόσο σημαντικό να συγκριθούν.
*update_acetate_tests_s2*
#+NAME: update_acetate_tests_s2
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_acetate_analysis.jl

  <<acet_test_0_s2>>
  <<acet_test_1_s2>>
  <<acet_test_2_s2>>
  <<acet_test_4_s2>>
  <<acet_test_fw_s2>>

  model_fit_table = Tables.table(vcat(reshape(model_acet_0, 1, 5), reshape(model_acet_1, 1, 5), reshape(model_acet_2, 1, 5), reshape(model_acet_4, 1, 5), reshape(model_acet_fw, 1, 5)), header = [:Sample_Name, :Production_Potential, :Production_Rate, :Lag_Time, :R_squared])
  CSV.write(datadir("exp_pro", "methane_from_acetate_kinetics_s2.csv"), model_fit_table)
  return("../data/exp_pro/methane_from_acetate_kinetics_s2.csv")
#+END_SRC

#+RESULTS: update_acetate_tests_s2

#+NAME: acet_kinetic_data_s2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<update_acetate_tests_s2()>> '(4))
#+END_SRC

#+CAPTION: Kinetic Models
| Sample_Name | Production_Potential | Production_Rate | Lag_Time | R_squared |
| Sample 0    |               11.945 |          16.355 |    0.185 |     0.998 |
| Sample 1    |               11.663 |           3.444 |      0.0 |     0.843 |
| Sample 2    |               12.599 |           2.038 |      0.0 |     0.921 |
| Sample 4    |                9.484 |           6.821 |    0.194 |     0.999 |
| Sample FW   |               14.451 |           4.298 |    0.586 |     0.993 |

#+NAME: sma_acet_s2
#+BEGIN_SRC julia :noweb no-export :tangle ../scripts/ad_acetate_analysis.jl

  <<acet_test_0_s2>>
  <<acet_test_1_s2>>
  <<acet_test_2_s2>>
  <<acet_test_4_s2>>
  <<acet_test_fw_s2>>

  sma_table = Tables.table(vcat(reshape(sma_acet_0, 1, 5), reshape(sma_acet_1, 1, 5), reshape(sma_acet_2, 1, 5), reshape(sma_acet_4, 1, 5), reshape(sma_acet_fw, 1, 5)), header = [:Sample_Name, :Methane_Potential, :SMA, :Lag_Time, :R_sq])
  CSV.write(datadir("exp_pro", "sma_from_acet_s2.csv"), sma_table)

  return("../data/exp_pro/sma_from_acet_s2.csv")
#+END_SRC

#+RESULTS: sma_acet_s2
: "../data/exp_pro/sma_from_acet_s2.csv"

#+NAME: acet_sma_data_s1_r2
#+BEGIN_SRC elisp :results table :noweb no-export
  (org-table-import-after-n-lines 4 <<sma_acet_s2()>> '(4))
#+END_SRC

#+CAPTION: SMA Kinetics in Minutes
| Sample_Name | Methane_Potential |   SMA | Lag_Time |  R_sq |
| Sample 0    |             2.844 | 3.894 |    0.185 | 0.998 |
| Sample 1    |             2.777 |  0.82 |      0.0 | 0.843 |
| Sample 2    |               3.0 | 0.485 |      0.0 | 0.921 |
| Sample 4    |             2.258 | 1.624 |    0.194 | 0.999 |
| Sample FW   |             3.441 | 1.023 |    0.586 | 0.993 |

** Γενικά σχόλια για αυτόν τον κύκλο πειραμάτων
Αυτά τα πειράματα έχουν ως σκοπό την σύγκριση με την προηγούμενη λάσπη και μία προσπάθεια επαλήθευσης των αποτελεσμάτων του προηγούμενου κύκλου χρησιμοποιώντας διαφορετική λάσπη (το οποίο θα μας επιτρέψει να επιβεβαιώσουμε πως λειτουργούν και οι 2 όπως θα αναμέναμε).

Με βάση τα αποτελέσματα του κύκλου αυτού, παρατηρούμε πως η λάσπη αυτή παράγει πολύ λιγότερο μεθάνιο. Βέβαια, μπορεί να παίζει ρόλο πως έχει προστεθεί αρκετά περισσότερη λάσπη στον αντιδραστήρα (250 g που αντιστοιχούν σε 4 g VS αντί για 125 g που αντιστοιχούσαν σε 1.5 g VS στο προηγούμενο πείραμα) οπότε ο λόγος τροφής προς μικροοργανισμούς (F/M) είναι πολύ μικρότερος.

Επίσης, παρατηρείται πως ο ρυθμός παραγωγής μεθανίου είναι μικρότερος (παρότι της ίδιας τάξης μεγέθους) από το προηγούμενο πείραμα, με εξαίρεση μόνο το δείγμα 0, όπου η λάσπη παρήγαγε πάρα πολύ γρήγορα αέριο.

Ως συμπέρασμα, βλέπουμε πως μία πιθανή αιτία για την μεγάλη διαφορά των δύο λασπών μπορεί να είναι η διαφορετική ποσότητα λάσπης (και άρα να πρέπει αυτή να ληφθεί υπόψην στις κινητικές) πέρα από το γεγονός ότι μπορεί να έχουν απλώς πολύ διαφορετική δραστικότητα.
